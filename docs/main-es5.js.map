{"version":3,"sources":["webpack:///$_lazy_route_resource lazy namespace object","webpack:///src/app/algorithm-page/algorithm-navbar/algorithm-navbar.component.ts","webpack:///src/app/algorithm-page/algorithm-page.component.html","webpack:///src/app/algorithm-page/algorithm-page.component.ts","webpack:///src/app/algorithm-page/algorithms/abstract-classes/EgsOneToMany.ts","webpack:///src/app/algorithm-page/algorithms/abstract-classes/ExtendedGaleShapley.ts","webpack:///src/app/algorithm-page/algorithms/abstract-classes/GaleShapley.ts","webpack:///src/app/algorithm-page/algorithms/abstract-classes/MatchingAlgorithm.ts","webpack:///src/app/algorithm-page/algorithms/abstract-classes/StableRoomMates.ts","webpack:///src/app/algorithm-page/algorithms/algorithm-services/hr-hospital-egs/hr-hospital-egs.service.ts","webpack:///src/app/algorithm-page/algorithms/algorithm-services/hr-resident-egs/hr-resident-egs.service.ts","webpack:///src/app/algorithm-page/algorithms/algorithm-services/smp-man-egs/egs-stable-marriage.service.ts","webpack:///src/app/algorithm-page/algorithms/algorithm-services/smp-man-gs/gs-stable-marriage.service.ts","webpack:///src/app/algorithm-page/algorithms/algorithm-services/smp-room-irv/stable-room-irv.service.ts","webpack:///src/app/algorithm-page/animation-container/agent-titles/agent-titles.component.ts","webpack:///src/app/algorithm-page/animation-container/agent-titles/agent-titles.component.html","webpack:///src/app/algorithm-page/animation-container/animation-container.component.ts","webpack:///src/app/algorithm-page/animation-container/canvas-display/canvas-display.component.ts","webpack:///src/app/algorithm-page/animation-guide-dialog/animation-guide-dialog.component.ts","webpack:///src/app/algorithm-page/animation-guide-dialog/animation-guide-dialog.component.html","webpack:///src/app/algorithm-page/animations/algorithm-animation.service.ts","webpack:///src/app/algorithm-page/code-display/code-display.component.ts","webpack:///src/app/algorithm-page/code-display/code-display.component.html","webpack:///src/app/algorithm-page/edit-preferences-dialog/edit-preferences-dialog/edit-preferences-dialog.component.ts","webpack:///src/app/algorithm-page/edit-preferences-dialog/edit-preferences-dialog/edit-preferences-dialog.component.html","webpack:///src/app/algorithm-page/mat-animated-icon/mat-animated-icon.component.ts","webpack:///src/app/algorithm-page/mat-animated-icon/mat-animated-icon.component.html","webpack:///src/app/algorithm-page/playback-controls/playback-controls.component.ts","webpack:///src/app/algorithm-page/playback-controls/playback-controls.component.html","webpack:///src/app/algorithm-page/services/canvas/canvas.service.ts","webpack:///src/app/algorithm-page/services/execution/execution.service.ts","webpack:///src/app/algorithm-page/services/playback/playback.service.ts","webpack:///src/app/algorithm-page/sidebar/alg-description/alg-description.component.ts","webpack:///src/app/algorithm-page/sidebar/alg-description/alg-description.component.html","webpack:///src/app/algorithm-page/sidebar/execution-log/execution-log.component.ts","webpack:///src/app/algorithm-page/sidebar/execution-log/execution-log.component.html","webpack:///src/app/algorithm-page/sidebar/free-agents/free-agents.component.ts","webpack:///src/app/algorithm-page/sidebar/free-agents/free-agents.component.html","webpack:///src/app/algorithm-page/sidebar/pseudocode/pseudocode.component.ts","webpack:///src/app/algorithm-page/sidebar/pseudocode/pseudocode.component.html","webpack:///src/app/algorithm-page/sidebar/sidebar.component.ts","webpack:///src/app/algorithm-page/sidebar/sidebar.component.html","webpack:///src/app/algorithm-retrieval.service.ts","webpack:///src/app/animations/fadeAnimation.ts","webpack:///src/app/app.component.ts","webpack:///src/app/app.component.html","webpack:///src/app/app.module.ts","webpack:///src/app/home-page/about-content/about-content.component.ts","webpack:///src/app/home-page/about-content/about-content.component.html","webpack:///src/app/home-page/algorithm-content/algorithm-card/algorithm-card.component.html","webpack:///src/app/home-page/algorithm-content/algorithm-card/algorithm-card.component.ts","webpack:///src/app/home-page/algorithm-content/algorithm-content.component.ts","webpack:///src/app/home-page/algorithm-content/algorithm-content.component.html","webpack:///src/app/home-page/feedback-banner/feedback-banner.component.ts","webpack:///src/app/home-page/feedback-banner/feedback-banner.component.html","webpack:///src/app/home-page/feedback-content/feedback-content.component.ts","webpack:///src/app/home-page/feedback-content/feedback-content.component.html","webpack:///src/app/home-page/home-content/home-content.component.ts","webpack:///src/app/home-page/home-content/home-content.component.html","webpack:///src/app/home-page/home-page.component.html","webpack:///src/app/home-page/home-page.component.ts","webpack:///src/app/home-page/icon-banner/icon-banner.component.ts","webpack:///src/app/home-page/icon-banner/icon-banner.component.html","webpack:///src/app/home-page/navbar/navbar.component.ts","webpack:///src/app/home-page/navbar/navbar.component.html","webpack:///src/app/routing/algorithm-guard.ts","webpack:///src/app/routing/app-routing.module.ts","webpack:///src/app/utils/utils.service.ts","webpack:///src/environments/environment.ts","webpack:///src/main.ts"],"names":["webpackEmptyAsyncContext","req","Promise","resolve","then","e","Error","code","keys","module","exports","id","AlgorithmNavbarComponent","selector","templateUrl","styleUrls","AlgorithmPageComponent","playback","algorithmService","drawService","animation","utils","dialog","router","showCode","dialogOpen","duringAnimation","firstSelection","algorithm","SRstable","SRstableText","canvas","ctx","nativeElement","getContext","initialise","setAlgorithm","currentAlgorithm","numberOfGroup1Agents","numberOfGroup2Agents","$","popover","tutorialStep","loadPage","event","key","pause","stepCounter","numCommands","forwardStep","backStep","toggle","generateNewPreferences","openEditPreferencesDialog","dialogRef","open","afterClosed","subscribe","result","goHome","delay","navigateByUrl","command","commandList","previousStepCounter","a","document","getElementById","style","backgroundColor","color","fadeCanvasOut","i","console","log","name","fadeCanvasIn","mainContent","hideSidebar","hideMainContent","position","showMainContent","showSidebar","toggleSidebar","startTutorial","sidebarTutorial","mainContentTutorial","stopTutorial","$event","stopImmediatePropagation","EgsOneToMany","currentAgent","potentialProposee","update","match","length","matchPosition","findPositionInMatches","ranking","filter","agent","freeAgentsOfGroup1","includes","push","removeArrayFromArray","currentLines","getLastCharacter","changePreferenceStyle","group1CurrentPreferences","originalGroup1CurrentPreferences","get","findIndex","woman","group2CurrentPreferences","splice","agentLastChar","proposeeLastChar","greenLine","currentAgentPosition","proposeeRankingClearCounter","proposeePosition","relevantPreferences","pop","ExtendedGaleShapley","group1Agents","getNextPotentialProposee","shift","breakAssignment","provisionallyAssign","removeRuledOutPreferences","shouldContinueMatching","currentlySelectedAgents","GaleShapley","MatchingAlgorithm","Map","group2Agents","algorithmData","commands","Array","descriptions","currentLine","originalGroup2CurrentPreferences","algorithmSpecificData","stable","numberOfAgents","group1AgentName","group1Name","set","currentLetter","group2AgentName","group2Name","String","fromCharCode","charCodeAt","from","values","agent1Rankings","shuffle","agent2Rankings","preferences","tempCopyList","preferenceAgent","array","j","Math","floor","random","agents","matches","preferenceList","slice","identifier","mapIn","mapCloned","forEach","str","mapObj","step","stepVariables","currentStep","lineNumber","freeAgents","Object","assign","clone","JSON","parse","stringify","agentName","matchList","agentToFind","originalPreferences","indexOf","b","arrayPositionCounter","subArray","checkArrayEquality","person","charAt","allMatches","stability","agentMatches","lastAgentPosition","getLastMatch","agentPreferences","findPositionInOriginalMatches","furthestIndex","matchAgent","generateAgents","populatePreferences","generatePreferences","getGroupRankings","checkStability","getMatches","undefined","StableRoomMates","data2","unstable4","unstable6_1","unstable6_2","unstable6_3","unstable8_1","unstable8_2","unstable8_3","count","nonStableSRInstacens6","nonStableSRInstacens8","instance","selfIndex","entries","size","HrHospitalEgsService","hospitalCapacity","freeAgentsOfGroup2","availableSpaces","getRandomInt","min","max","ceil","hospital","proposee","positionMap","resident","matchPosition_resident","matchPosition_hospital","matchPosition_resident_original","findPositionInOriginalMatchesGroup2","h","hospitalLastChar","currentHospitalCapacity","worstResident","getWorstResident","worstResidentPosition","hospitalRankingClearCounter","hospitalPosition","freeHospitals","hospitalCap","checkHospitalPreferanceList","counter_break","currentHospital","checkFreeHospitals","print_matches","providedIn","HrResidentEgsService","EgsStableMarriageService","GsStableMarriageService","lastProposed","man","substring","redLine","manName","StableRoomIrvService","personkey","assinged","person_free","removePersonFromArray","agent1","agent2","agent1index","agent2index","free_agents","agents_multiple_prefs","s","check_free_agents","x","p","last_person","last_pref","run","pref","check","assign_check","free","objs_toString","remove","delete_pair","check_pref_count","finished_people","rotation_pairs","starting_agent","second_pref","counter","deleted_pairs","pair","key_inner","person_inner","removeTargetFromArray","line","check_pref_list_empty","AgentTitlesComponent","AnimationContainerComponent","CanvasDisplayComponent","AnimationGuideDialogComponent","AlgorithmAnimationService","anime","targets","easing","translateY","duration","translateX","opacity","CodeDisplayComponent","algService","animate","EditPreferencesDialogComponent","playbackService","canvasService","_snackBar","group1Preferences","group2Preferences","equalGroups","required","valid","errors","generateAlgorithmPreferences","preferencesForm","generatePreferenceString","preferenceString","pluralMap","orientation","missingPreferences","setValue","value","numbersToAdd","lettersToAdd","Number","newPreferences","concat","join","currentPreferences","preference","formString","split","checkIfPreference","checkValidity","replace","agentId","fill","close","re","test","isGroup1","isNaN","currentNumInPreference","added","MatAnimatedIconComponent","animateFromParent","PlaybackControlsComponent","round","val","speed","ms","setTimeout","CanvasService","sizes","baseSize","font","controlChars","spaceSize","tabSize","tabs","t","radiusOfCircles","yMargin","xMargin","fontSize","alwaysShowPreferences","lineSizes","firstRun","currentCommand","redrawCanvas","LHSHeightOffset","RHSHeightOffset","effectiveHeight","height","effectiveWidth","width","spaceBetweenCircles","canvasMiddle","centerX","centerY","positions","positionX","positionY","number","angle","PI","r","offset","cos","sin","beginPath","fillStyle","posX","posY","moveTo","arc","stroke","fillText","strokeStyle","lineWidth","xLen","yLen","halfX","halfY","atan","newX","newY","right","lineTo","group1PreferenceList","drawText","group2PreferenceList","num","hospitalCapacityMap","currentCapacity","circles","originalLineWidth","originalStrokeStyle","numFind","exec","getFontSize","measureText","context","text","y","len","subText","w","scale","xx","yy","state","setTransform","renderText","save","colour","translate","restore","c","cc","getNextTab","substr","parent","offsetWidth","offsetHeight","originalGroup1Preferences","originalGroup2Preferences","lineSize","setFont","drawLine1Group","calculateEqualDistance1Group","drawCircles1Group","drawLine","calculateEqualDistance","drawLHSCircles","drawRHSCircles","drawHospitalCapacity","drawRelevantPreferences","drawAllPreferences1Group","drawAllPreferences","selectCircles","ExecutionService","algorithmRetrieval","commandMap","mapOfAvailableAlgorithms","service","helpTextMap","generateDescriptions","generateMessage","commandNum","replacements","all","PlaybackService","exeService","description","getExecutionFlow","resetPlaybackData","updateCurrentCommand","milliseconds","uncolourCurrentLine","colourCurrentLine","play","sleep","msec","codeLineHTML","AlgDescriptionComponent","ExecutionLogComponent","FreeAgentsComponent","PseudocodeComponent","SidebarComponent","AlgorithmRetrievalService","gsStableMarriageService","egsStableMarriageService","simpleFadeAnimation","AppComponent","title","AppModule","declarations","imports","providers","bootstrap","AboutContentComponent","animations","MyErrorStateMatcher","control","form","isSubmitted","submitted","invalid","dirty","touched","AlgorithmCardComponent","pattern","skipLocationChange","AlgorithmContentComponent","FeedbackBannerComponent","FeedbackContentComponent","HomeContentComponent","vid","animationVid","muted","descriptionVid","HomePageComponent","IconBannerComponent","NavbarComponent","componentMap","url","page","fadeCurrentPage","AlgorithmGuard","_router","next","navigate","routes","path","component","children","data","canActivate","redirectTo","AppRoutingModule","forRoot","scrollPositionRestoration","UtilsService","environment","production","bootstrapModule","err","error"],"mappings":"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","file":"main-es5.js","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./$$_lazy_route_resource lazy recursive\";","import { Component, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'algorithm-navbar',\r\n  templateUrl: './algorithm-navbar.component.html',\r\n  styleUrls: ['./algorithm-navbar.component.scss']\r\n})\r\nexport class AlgorithmNavbarComponent implements OnInit {\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n}\r\n","<!-- semi-transparent panel to give illusion of modal on tutorial -->\r\n<div class=\"covering-panel\" *ngIf=\"this.tutorialStep != 0\"></div>\r\n\r\n\r\n<!-- navbar -->\r\n<nav class=\"navbar alg-navbar sticky-top navbar-light p-0 moveToTop shadow-lg\">\r\n\r\n\r\n  <div class=\"col-3 text-left align-middle\" style=\"height: 100%\">\r\n    <div class=\"align-middle\" style=\"display: inline-block; height: 100%\">\r\n      \r\n    </div>\r\n    <mat-icon class=\"navbarIconButton unselectable mr-4 navbarPopover\" data-toggle=\"popover\" data-placement=\"bottom\" title=\"Menu button\" data-content=\"Click this to hide or expand the sidebar underneath when not in this tutorial!\" data-trigger=\"manual\" (click)=\"this.toggleSidebar(); $event.stopImmediatePropagation()\" matTooltip=\"{{this.showCode ? 'Expand Panel' : 'Close Panel'}}\" [ngClass]=\"{'disabled': this.tutorialStep != 0 || this.duringAnimation}\">{{this.showCode ? \"menu\" : \"menu_open\"}}</mat-icon>\r\n    <a class=\"unselectable\" style=\"cursor: pointer;vertical-align: -2px\" [ngClass]=\"{'disabled': this.tutorialStep != 0 || this.duringAnimation}\" (click)=\"this.goHome()\" matTooltip=\"Go Home\"><span class=\"display-1\" style=\"font-size: 20px;\"><span id=\"alg\">alg</span><span id=\"match\">match</span></span></a>\r\n  </div>\r\n  <div class=\"col-6 text-center navbarPopover\" data-toggle=\"popover\" data-placement=\"bottom\" title=\"Tutorial\" data-content=\"This short tutorial will walk you through the sections of this page. Click the arrow in the top right to move to the next step of the tutorial! Or you can click the x, also in the top right of the screen, to stop the tutorial.\" data-trigger=\"manual\">\r\n    <span style=\"color: white; font-size: 0.98rem; font-weight: 350;\">{{ this.algorithmService.currentAlgorithm.name }} / {{ this.algorithmService.currentAlgorithm.algorithm }} / {{ this.algorithmService.currentAlgorithm.orientation[0] }}-Oriented</span>\r\n  </div>\r\n\r\n  \r\n\r\n  <div class=\"col-3 text-right\">\r\n\r\n    <div class=\"col\" *ngIf=\"this.algorithmService.currentAlgorithm.name == 'Stable Roommates Problem'\">\r\n      \r\n      <span style=\"color: white; font-size: 0.98rem; font-weight: 350;\">{{ this.SRstableText }}</span>\r\n    </div>\r\n\r\n    <mat-icon class=\"navbarIconButton unselectable mr-4\" matTooltip=\"New\" mat-button (click)=\"this.ChangeStableSR()\" [ngClass]=\"{'disabled': this.tutorialStep != 0}\">edit</mat-icon>\r\n\r\n    <mat-icon class=\"navbarIconButton unselectable mr-4\" matTooltip=\"Stop Tutorial\" *ngIf=\"this.tutorialStep != 0\" (click)=\"this.stopTutorial()\">cancel</mat-icon>\r\n    <mat-icon class=\"navbarIconButton unselectable mr-4\" matTooltip=\"Generate New Random Preferences\" (click)=\"this.generateNewPreferences()\" [ngClass]=\"{'disabled': this.tutorialStep != 0}\">refresh</mat-icon>\r\n    <mat-icon class=\"navbarIconButton unselectable mr-4\" matTooltip=\"Edit Preferences\" mat-button (click)=\"this.openEditPreferencesDialog()\" [ngClass]=\"{'disabled': this.tutorialStep != 0}\">edit</mat-icon>\r\n    <mat-icon class=\"navbarIconButton unselectable mr-4\" (click)=\"this.drawService.alwaysShowPreferences = !this.drawService.alwaysShowPreferences; this.drawService.redrawCanvas(); $event.stopImmediatePropagation()\" matTooltip=\"{{this.drawService.alwaysShowPreferences ? 'Show All Preferences' : 'Only Show Relevant Preferences'}}\" [ngClass]=\"{'disabled': this.tutorialStep != 0}\">{{this.drawService.alwaysShowPreferences ? \"visibility_off\" : \"visibility\"}}</mat-icon>\r\n    <mat-icon class=\"navbarIconButton unselectable mr-4\" matTooltip=\"Animation Guide\" (click)=\"this.openAnimationGuideDialog()\" [ngClass]=\"{'disabled': this.tutorialStep != 0}\">info</mat-icon>\r\n    <mat-icon class=\"navbarIconButton unselectable mr-2 navbarPopover\" data-toggle=\"popover\" data-placement=\"bottom\" title=\"Actions\" data-content=\"In order from left to right, you can: stop this tutorial, generate new preferences, edit preferences, toggle all preferences or only relevant preferences, see an animation guide, or advance the tutorial.\" data-trigger=\"manual\" matTooltip=\"{{this.tutorialStep == 0 ? 'Tutorial' : 'Advance Tutorial'}}\" (click)=\"this.nextTutorialStep()\" [ngClass]=\"{'disabled': this.duringAnimation}\">{{this.tutorialStep == 0 ? \"help_outline\" : \"arrow_forward_ios\"}}</mat-icon>\r\n    \r\n  </div>\r\n\r\n  \r\n\r\n</nav>\r\n\r\n\r\n<!-- main content -->\r\n<div class=\"container-fluid main\">\r\n\r\n  <!-- sidebar -->\r\n  <sidebar [(showCode)]=\"showCode\" [(tutorialStep)]=\"tutorialStep\"></sidebar>\r\n\r\n  <!-- <animation-container></animation-container> -->\r\n\r\n\r\n  <div class=\"grid-container-algorithm ml-sm-auto\" id=\"mainContent\" style=\"background-color: white; height: 100%; display: grid; grid-template-rows: 0.39fr 3.4fr 0.8fr; padding-left: 0px; padding-right: 0px\" [ngClass]=\"{'col-md-9': !this.showCode, 'col-md-12': this.showCode, 'moveContentToTop': this.tutorialStep == 3}\">\r\n\r\n    <agent-titles [(showCode)]=\"showCode\"></agent-titles>\r\n\r\n    <div class=\"mainContentPopover\" (resized)=\"this.drawService.redrawCanvas()\" id=\"parent\" style=\"min-height: 400px;\"  data-toggle=\"popover\" data-placement=\"left\" title=\"Algorithm Display\" data-content=\"This is where you can see the animation for the algorithm! Green lines mean there is a matching between 2 circles, and red lines mean there is a proposal currently being considered. If you want more information, click on the info button next to the tutorial button!\" data-trigger=\"manual\">\r\n      <canvas #canvas id=\"myCanvas\" style=\"min-height: 280px; max-width: 100%; height: 100%\"></canvas>\r\n    </div>\r\n\r\n    <playback-controls></playback-controls>\r\n\r\n  </div>\r\n\r\n</div>","import { Component, ElementRef, HostListener, OnInit, ViewChild } from '@angular/core';\r\nimport { FormControl } from '@angular/forms';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { Router } from '@angular/router';\r\nimport { AlgorithmRetrievalService } from '../algorithm-retrieval.service';\r\nimport { UtilsService } from '../utils/utils.service';\r\nimport { AnimationGuideDialogComponent } from './animation-guide-dialog/animation-guide-dialog.component';\r\nimport { AlgorithmAnimationService } from './animations/algorithm-animation.service';\r\nimport { CanvasService } from './services/canvas/canvas.service';\r\nimport { EditPreferencesDialogComponent } from './edit-preferences-dialog/edit-preferences-dialog/edit-preferences-dialog.component';\r\nimport { PlaybackService } from './services/playback/playback.service';\r\ndeclare var $: any;  // declaring jquery for use in this file\r\n\r\n\r\n// -------------------------------------------------- FILE DESCRIPTION\r\n\r\n/*\r\n\r\nalgorithm-page.component.ts\r\n\r\nThis is the Typescript file for the algorithm page (algorithm-page.component.html).\r\n\r\nPurpose:\r\n  - Acts as a \"main\" class for the algorithm page\r\n  - Mediates interaction between all other services\r\n\r\nFlow:\r\n  - When algorithm page is to be loaded, run the constructor, injecting all necessary services\r\n  - ngOnInit() is then run, linking the global canvas variable for the canvasService (having a canvasService allows us to make calls to draw elements from anywhere)\r\n  - Set listener functions for the following actions:\r\n    - keypress down:\r\n        handleKeyboardEvent(event: KeyboardEvent): void\r\n    - home link (algmatch) clicked:\r\n        async goHome(): Promise<void>\r\n    - generate new preferences button clicked:\r\n        async generateNewPreferences(): Promise<void>\r\n    - toggle sidebar button clicked:\r\n        async toggleSidebar(): Promise<void>\r\n\r\nFunctions in this file:\r\n  - ngOnInit(): void\r\n  - ngAfterViewInit(): void\r\n  - handleKeyboardEvent(event: KeyboardEvent): void\r\n\r\n  - openEditPreferencesDialog(): void\r\n  - openAnimationGuideDialog(): void\r\n\r\n  - async goHome(): Promise<void>\r\n  - async generateNewPreferences(): Promise<void>\r\n  - async toggleSidebar(): Promise<void>\r\n\r\n  - nextTutorialStep(): void\r\n  - startTutorial(): void\r\n  - sidebarTutorial(): void\r\n  - mainContentTutorial(): void\r\n  - stopTutorial(): void\r\n\r\n*/\r\n\r\n\r\n// -------------------------------------------------- CODE\r\n\r\n\r\n@Component({\r\n  selector: 'algorithm-page',\r\n  templateUrl: './algorithm-page.component.html',\r\n  styleUrls: ['./algorithm-page.component.scss']\r\n})\r\nexport class AlgorithmPageComponent implements OnInit {\r\n\r\n  // --------------------------------------------------------------------------------- | INSTANCE VARIABLES\r\n\r\n\r\n  // looks for the canvas element on the algorithm page and assigns it to the canvas variable\r\n  @ViewChild('canvas', {static: true})\r\n  canvas: ElementRef<HTMLCanvasElement>;\r\n\r\n  showCode: boolean = false;\r\n  dialogOpen: boolean = false;\r\n\r\n  tutorialStep: number;\r\n\r\n  duringAnimation: boolean = false;\r\n\r\n  firstSelection: boolean = true\r\n  algorithm = new FormControl('');\r\n  numPeople: number;\r\n\r\n  // where SR is going to generate a stable matching or a unstable matching\r\n  SRstable: boolean = true;\r\n  SRstableText: string = \"Generating Stable Matchings\"\r\n\r\n\r\n  // --------------------------------------------------------------------------------- | INIT FUNCTIONS\r\n\r\n\r\n  constructor(\r\n    public playback: PlaybackService,  // injecting the playback service\r\n    public algorithmService: AlgorithmRetrievalService,  // injecting the algorithm service\r\n    public drawService: CanvasService,  // injecting the canvas service\r\n    public animation: AlgorithmAnimationService,\r\n    public utils: UtilsService,\r\n    public dialog: MatDialog,  // injecting the dialog component\r\n    public router: Router  // injecting the router service (for programmatic route navigation)\r\n  ) { }\r\n\r\n\r\n  // function that runs when page is created\r\n  ngOnInit(): void {\r\n\r\n    // set the global canvas element (in the canvasService) to the canvas on this page\r\n    this.drawService.canvas = this.canvas;\r\n    this.drawService.ctx = this.canvas.nativeElement.getContext('2d');\r\n\r\n    // debugging: use the following lines (113-121) to test individual algorithms\r\n    // you can use this in conjunction with changing the routing in order to direct to the animation page (so you don't have to keep selecting an algorithm through the main page, etc.)\r\n    // let group1 = 5;\r\n    // let group2 = 5;\r\n    // // let alg: string = \"smp-man-gs\";\r\n    // let alg: string = \"hr-resident-egs\";\r\n\r\n    // this.algorithmService.numberOfGroup1Agents = group1;\r\n    // this.algorithmService.numberOfGroup2Agents = group2;\r\n\r\n    // this.algorithmService.currentAlgorithm = this.algorithmService.mapOfAvailableAlgorithms.get(alg);\r\n    // this.playback.setAlgorithm(alg, group1, group2);\r\n\r\n\r\n    this.drawService.initialise();\r\n\r\n    // (un)comment the line below to (disable)/enable working algorithm selection\r\n    this.playback.setAlgorithm(this.algorithmService.currentAlgorithm.id, this.algorithmService.numberOfGroup1Agents, this.algorithmService.numberOfGroup2Agents);\r\n\r\n\r\n    // initialise all of the popovers for the tutorial (they won't appear without this function)\r\n    $(function () {\r\n      $('[data-toggle=\"popover\"]').popover()\r\n    })\r\n\r\n    // initialise the tutorial to the beginning\r\n    this.tutorialStep = 0;\r\n\r\n  }\r\n\r\n  // function that runs when page is visible to user\r\n  ngAfterViewInit(): void {\r\n    this.animation.loadPage();\r\n  }\r\n\r\n\r\n  // creating a listener function for keydown events\r\n  // Key:\r\n    // (< arrow) or (a) == backstep in algorithm\r\n    // (> arrow) or (d) == forward step in algorithm\r\n    // (r) or (#) == generate new preferences\r\n    // (e) or (]) == open edit preferences dialog\r\n  @HostListener('document:keydown', ['$event'])\r\n  handleKeyboardEvent(event: KeyboardEvent): void {\r\n    if (!this.dialogOpen && this.tutorialStep == 0) {  // disable events on tutorial or edit preferences open\r\n      if (event.key == \"ArrowRight\" || event.key == \"d\") {\r\n        if (!(!this.playback.pause || this.playback.stepCounter >= this.playback.numCommands)) {\r\n          this.playback.forwardStep();\r\n        }\r\n      } else if (event.key == \"ArrowLeft\" || event.key == \"a\") {\r\n        if (!(!this.playback.pause || this.playback.stepCounter == 0)) {\r\n          this.playback.backStep();\r\n        }\r\n      } else if (event.key == \" \") {\r\n        if (!(this.playback.stepCounter >= this.playback.numCommands)) {\r\n          this.playback.toggle();\r\n        }\r\n      } else if (event.key == \"r\" || event.key == \"#\") {\r\n        this.generateNewPreferences()\r\n      } else if (event.key == \"e\" || event.key == \"]\") {\r\n        this.openEditPreferencesDialog()\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  // --------------------------------------------------------------------------------- | GENERAL FUNCTIONS\r\n\r\n\r\n  // open the edit preferences dialog with a callback function\r\n  openEditPreferencesDialog(): void {\r\n    const dialogRef = this.dialog.open(EditPreferencesDialogComponent);\r\n\r\n    this.dialogOpen = true;\r\n\r\n    dialogRef.afterClosed().subscribe(result => {\r\n      this.dialogOpen = false;\r\n    });\r\n\r\n  }\r\n\r\n  // open the animation guide dialog with a callback function\r\n  openAnimationGuideDialog(): void {\r\n    const dialogRef = this.dialog.open(AnimationGuideDialogComponent);\r\n\r\n    this.dialogOpen = true;\r\n\r\n    dialogRef.afterClosed().subscribe(result => {\r\n      this.dialogOpen = false;\r\n    });\r\n\r\n  }\r\n\r\n\r\n  // --------------------------------------------------------------------------------- | ON CLICK FUNCTIONS\r\n\r\n\r\n  // function run when home link clicked\r\n  // start animation for going home, delay 1000ms, then change route to home\r\n  async goHome(): Promise<void> {\r\n    this.animation.goHome();\r\n    await this.utils.delay(1000);\r\n    this.router.navigateByUrl(\"/\");\r\n  }\r\n\r\n\r\n  // function run when generate new preferences button clicked\r\n  async generateNewPreferences(): Promise<void> {\r\n    // clears any code highlighting\r\n    var command = this.playback.commandList[this.playback.previousStepCounter];\r\n    let a = document.getElementById(\"line\" + command[\"lineNumber\"]);\r\n    a.style.backgroundColor = \"\";\r\n    a.style.color = \"\";\r\n\r\n\r\n    // animates changing of preferences (fade in/out)\r\n    this.animation.fadeCanvasOut();\r\n    await this.utils.delay(300);\r\n    for (let i = 0; i < 1; i++) {\r\n      // let agent1Count: number = Math.floor(Math.random() * (9 - 2) + 2);\r\n      // let agent2Count: number = Math.floor(Math.random() * (9 - 2) + 2);\r\n      // this.playback.setAlgorithm(this.algorithmService.currentAlgorithm.id, agent1Count, agent2Count);\r\n\r\n      console.log(this.algorithmService.currentAlgorithm.name)\r\n\r\n      if (this.algorithmService.currentAlgorithm.name == \"Stable Roommates Problem\") {\r\n        console.log(\"yes\", this.SRstable)\r\n        this.playback.setAlgorithm(this.algorithmService.currentAlgorithm.id, this.algorithmService.numberOfGroup1Agents, this.algorithmService.numberOfGroup2Agents, null, this.SRstable);\r\n\r\n      } else {\r\n        this.playback.setAlgorithm(this.algorithmService.currentAlgorithm.id, this.algorithmService.numberOfGroup1Agents, this.algorithmService.numberOfGroup2Agents);\r\n      }\r\n\r\n    }\r\n    this.animation.fadeCanvasIn();\r\n  }\r\n\r\n\r\n  // function run when toggle sidebar button clicked (top left)\r\n  async toggleSidebar(): Promise<void> {\r\n\r\n    this.duringAnimation = true;\r\n\r\n    let mainContent = document.getElementById(\"mainContent\");\r\n\r\n    if (!this.showCode) {\r\n\r\n      // hide sidebar and content\r\n      this.animation.hideSidebar();\r\n      this.animation.hideMainContent();\r\n\r\n      await this.utils.delay(700);\r\n  \r\n      // show sidebar and content\r\n      mainContent.style.position = \"\";\r\n      this.animation.showMainContent();\r\n      this.showCode = !this.showCode\r\n\r\n    } else {\r\n\r\n      // hide content\r\n      this.animation.hideMainContent();\r\n\r\n      await this.utils.delay(400);\r\n\r\n      // show sidebar\r\n      this.showCode = !this.showCode\r\n      this.animation.showSidebar();\r\n\r\n      await this.utils.delay(200);\r\n\r\n      // show content\r\n      this.animation.showMainContent();\r\n\r\n    }\r\n\r\n    await this.utils.delay(200);\r\n\r\n    this.duringAnimation = false;\r\n\r\n  }\r\n\r\n  ChangeStableSR(): void {\r\n    \r\n    if (this.SRstable == true) {\r\n      this.SRstable = false\r\n      this.SRstableText = \"Generating Unstable Matchings\"\r\n    } else {\r\n      this.SRstable = true\r\n      this.SRstableText = \"Generating Stable Matchings\"\r\n\r\n    }\r\n\r\n    console.log(\"New SR setting\", this.SRstable)\r\n  }\r\n\r\n\r\n  // --------------------------------------------------------------------------------- | TUTORIAL FUNCTIONS\r\n  \r\n\r\n  // function run when \">\" arrow clicked in tutorial\r\n  // progresses to next stage of tutorial\r\n  nextTutorialStep(): void {\r\n    // step 1 (shows sidebar so tutorial doesn't break)\r\n    if (this.tutorialStep == 0) {\r\n      if (this.showCode) {\r\n        this.toggleSidebar();\r\n      }\r\n      this.startTutorial();\r\n    \r\n    // step 2\r\n    } else if (this.tutorialStep == 1) {\r\n      this.sidebarTutorial();\r\n\r\n    // step 3\r\n    } else if (this.tutorialStep == 2) {\r\n      this.mainContentTutorial();\r\n      \r\n    // step 4\r\n    } else if (this.tutorialStep == 3) {\r\n      this.stopTutorial();\r\n    }\r\n  }\r\n\r\n\r\n  // functions to hide/show appropriate popovers for tutorial steps\r\n  startTutorial(): void {\r\n    this.tutorialStep += 1;\r\n    $('.navbarPopover').popover('show');\r\n  }\r\n\r\n  sidebarTutorial(): void {\r\n    this.tutorialStep += 1;\r\n    $('.navbarPopover').popover('hide');\r\n    $('.sidebarPopover').popover('show');\r\n  }\r\n\r\n  mainContentTutorial(): void {\r\n    this.tutorialStep += 1;\r\n    $('.sidebarPopover').popover('hide');\r\n    $('.mainContentPopover').popover('show');\r\n  }\r\n\r\n  stopTutorial(): void {\r\n    this.tutorialStep = 0;\r\n    $('.navbarPopover').popover('hide');\r\n    $('.sidebarPopover').popover('hide');\r\n    $('.mainContentPopover').popover('hide');\r\n  }\r\n\r\n\r\n}\r\n","\r\nimport { Agent } from \"../interfaces/Agent\";\r\nimport { ExtendedGaleShapley } from \"./ExtendedGaleShapley\";\r\n\r\n// this file is the implementation for SM - EGS\r\n\r\nexport abstract class EgsOneToMany extends ExtendedGaleShapley {\r\n  \r\n\r\n    breakAssignment(currentAgent: Agent, potentialProposee: Agent) {\r\n        // if w is currently assigned to someone {\r\n        this.update(4, {\"%woman%\": potentialProposee.name});\r\n        if (potentialProposee.match.length >= 1) {\r\n            // break the provisional assignment of r to h'\r\n            // let matchPosition: number = potentialProposee.match[0].match.findIndex((agent: { name: string }) => agent.name == potentialProposee.name);\r\n\r\n            let matchPosition: number = this.findPositionInMatches(potentialProposee, potentialProposee.match[0]);\r\n\r\n            if (potentialProposee.match[0].ranking.filter(agent => agent.match[0] != currentAgent).length > 0 && !this.freeAgentsOfGroup1.includes(potentialProposee.match[0].name) && potentialProposee.match[0].ranking.length > 0) {\r\n                this.freeAgentsOfGroup1.push(potentialProposee.match[0].name);\r\n            }\r\n\r\n\r\n            this.removeArrayFromArray(this.currentLines, [this.getLastCharacter(potentialProposee.match[0].name), this.getLastCharacter(potentialProposee.name), \"green\"]);\r\n\r\n            this.changePreferenceStyle(this.group1CurrentPreferences, this.getLastCharacter(potentialProposee.match[0].name), this.originalGroup1CurrentPreferences.get(this.getLastCharacter(potentialProposee.match[0].name)).findIndex(woman => woman == this.getLastCharacter(potentialProposee.name)), \"grey\");\r\n            this.changePreferenceStyle(this.group2CurrentPreferences, this.getLastCharacter(potentialProposee.name), matchPosition, \"grey\");\r\n            \r\n            this.update(5, {\"%woman%\": potentialProposee.name, \"%currentPartner%\": potentialProposee.match[0].name});\r\n\r\n            potentialProposee.ranking.splice(matchPosition, 1);\r\n            potentialProposee.match[0].ranking.splice(this.findPositionInMatches(potentialProposee.match[0], potentialProposee), 1);\r\n        } else {\r\n            // } (r is not currently assigned)\r\n            this.update(6, {\"%woman%\": potentialProposee.name});\r\n        }\r\n    }\r\n\r\n    provisionallyAssign(currentAgent: Agent, potentialProposee: Agent) {\r\n        // provisionally assign r to h;\r\n\r\n        let agentLastChar = this.getLastCharacter(currentAgent.name);\r\n        let proposeeLastChar = this.getLastCharacter(potentialProposee.name);\r\n        this.removeArrayFromArray(this.currentLines, [agentLastChar, proposeeLastChar, \"red\"]);\r\n\r\n        let greenLine = [agentLastChar, proposeeLastChar, \"green\"];\r\n        this.currentLines.push(greenLine);\r\n\r\n        // this.findPositionInMatches(currentAgent, potentialProposee));\r\n\r\n        this.changePreferenceStyle(this.group1CurrentPreferences, agentLastChar, this.originalGroup1CurrentPreferences.get(agentLastChar).findIndex(woman => woman == this.getLastCharacter(potentialProposee.name)), \"green\");\r\n        this.changePreferenceStyle(this.group2CurrentPreferences, proposeeLastChar, this.findPositionInMatches(potentialProposee, currentAgent), \"green\");\r\n\r\n        this.update(7, {\"%man%\": currentAgent.name, \"%woman%\": potentialProposee.name});\r\n        potentialProposee.match[0] = currentAgent;\r\n        currentAgent.match.push(potentialProposee);\r\n    }\r\n\r\n    removeRuledOutPreferences(currentAgent: Agent, potentialProposee: Agent) {\r\n        let currentAgentPosition: number = potentialProposee.ranking.findIndex((agent: { name: string }) => agent.name == currentAgent.name);\r\n        \r\n        let proposeeRankingClearCounter: number = currentAgentPosition + 1;\r\n\r\n        // for each successor h' of h on r's list {\r\n        this.update(8, {\"%man%\": currentAgent.name, \"%woman%\": potentialProposee.name});\r\n        for (let i = currentAgentPosition + 1; i < potentialProposee.ranking.length; i++) {\r\n\r\n            // \"Woman: \" + potentialProposee.name);\r\n\r\n            let proposeePosition: number = this.findPositionInMatches(potentialProposee.ranking[i], potentialProposee);\r\n            this.relevantPreferences.push(this.getLastCharacter(potentialProposee.ranking[i].name));\r\n\r\n            // potentialProposee.ranking[i].name);\r\n            // potentialProposee.ranking[i].ranking[proposeePosition]);\r\n\r\n            // remove h' and r from each other's lists\r\n            this.update(9, {\"%nextWorstMan%\": potentialProposee.ranking[i].name, \"%woman%\": potentialProposee.name});\r\n\r\n            this.changePreferenceStyle(this.group1CurrentPreferences, this.getLastCharacter(potentialProposee.ranking[i].name), this.originalGroup1CurrentPreferences.get(this.getLastCharacter(potentialProposee.ranking[i].name)).findIndex(woman => woman == this.getLastCharacter(potentialProposee.name)), \"grey\");\r\n\r\n            this.changePreferenceStyle(this.group2CurrentPreferences, this.getLastCharacter(potentialProposee.name), proposeeRankingClearCounter, \"grey\");\r\n\r\n            this.update(10, {\"%nextWorstMan%\": potentialProposee.ranking[i].name, \"%woman%\": potentialProposee.name});\r\n\r\n            // potentialProposee.ranking[i].name);\r\n            // potentialProposee.name);\r\n            \r\n            potentialProposee.ranking[i].ranking.splice(proposeePosition, 1);\r\n            potentialProposee.ranking.splice(i, 1);\r\n            i -= 1;\r\n\r\n            proposeeRankingClearCounter++;\r\n\r\n            this.relevantPreferences.pop();\r\n\r\n        }\r\n        this.update(11, {\"%man%\": currentAgent.name, \"%woman%\": potentialProposee.name});\r\n    }\r\n\r\n}","import { Agent } from \"../interfaces/Agent\";\r\nimport { AlgorithmData } from \"../interfaces/AlgorithmData\";\r\nimport { MatchingAlgorithm } from \"./MatchingAlgorithm\";\r\n\r\n\r\nexport abstract class ExtendedGaleShapley extends MatchingAlgorithm {\r\n\r\n    match(): AlgorithmData {\r\n\r\n        // assign each resident to be free;\r\n        this.update(1);\r\n\r\n        while (this.freeAgentsOfGroup1.length > 0) {\r\n\r\n            // this.currentlySelectedAgents = [];\r\n            // this.relevantPreferences = [];\r\n\r\n            // while (some hospital h is undersubscribed) and (h's preference list contains a resident r not provisionally assigned to h) {\r\n            let currentAgent = this.group1Agents.get(this.freeAgentsOfGroup1[0]);\r\n            // this.currentlySelectedAgents.push(this.getLastCharacter(currentAgent.name));\r\n            // this.relevantPreferences.push(this.getLastCharacter(currentAgent.name));\r\n\r\n\r\n            // if all potential proposees are gone, remove \r\n            if (currentAgent.ranking.length <= 0 || !this.getNextPotentialProposee(currentAgent)) {\r\n                this.freeAgentsOfGroup1.shift();\r\n            } else {\r\n\r\n                this.update(2, {\"%currentAgent%\": currentAgent.name});\r\n\r\n                // r := first such resident on h's list;\r\n                let potentialProposee: Agent = this.getNextPotentialProposee(currentAgent);\r\n\r\n\r\n                // let agentLastChar = this.getLastCharacter(currentAgent.name);\r\n                // let proposeeLastChar = this.getLastCharacter(potentialProposee.name);\r\n\r\n                // this.currentlySelectedAgents.push(proposeeLastChar);\r\n                // this.relevantPreferences.push(proposeeLastChar);\r\n\r\n                // this.changePreferenceStyle(this.group1CurrentPreferences, agentLastChar, this.originalGroup1CurrentPreferences.get(agentLastChar).findIndex(woman => woman == this.getLastCharacter(potentialProposee.name)), \"red\");\r\n                // this.changePreferenceStyle(this.group2CurrentPreferences, proposeeLastChar, this.findPositionInMatches(potentialProposee, currentAgent), \"red\");\r\n\r\n                // let redLine = [agentLastChar, proposeeLastChar, \"red\"];\r\n                // this.currentLines.push(redLine);\r\n\r\n                this.update(3, {\"%currentAgent%\": currentAgent.name, \"%potentialProposee%\": potentialProposee.name});\r\n\r\n                // if h is fully subscribed, then break the assignment of the worst resident of that hospital\r\n                this.breakAssignment(currentAgent, potentialProposee);\r\n        \r\n                this.provisionallyAssign(currentAgent, potentialProposee);\r\n        \r\n                this.removeRuledOutPreferences(currentAgent, potentialProposee);\r\n        \r\n                if (this.shouldContinueMatching(currentAgent)) {\r\n                    this.freeAgentsOfGroup1.shift();\r\n                }  \r\n            }\r\n        }\r\n\r\n        this.currentlySelectedAgents = [];\r\n        this.relevantPreferences = [];\r\n        // a stable matching has been found\r\n        this.update(12);\r\n\r\n\r\n        return;\r\n    }\r\n\r\n    abstract getNextPotentialProposee(currentAgent: Agent): Agent;\r\n\r\n    abstract shouldContinueMatching(currentAgent: Agent): boolean;\r\n\r\n    abstract provisionallyAssign(currentAgent: Agent, potentialProposee: Agent): void;\r\n\r\n    abstract removeRuledOutPreferences(currentAgent: Agent, potentialProposee: Agent): void;\r\n\r\n    abstract breakAssignment(currentAgent: Agent, potentialProposee: Agent): void;\r\n\r\n}","import { AlgorithmData } from \"../interfaces/AlgorithmData\";\r\nimport { MatchingAlgorithm } from \"./MatchingAlgorithm\";\r\n\r\nexport abstract class GaleShapley extends MatchingAlgorithm {\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    abstract match(): AlgorithmData;\r\n\r\n}","import { Agent } from \"../interfaces/Agent\";\r\nimport { Person } from '../interfaces/Person';\r\nimport { AlgorithmData } from \"../interfaces/AlgorithmData\";\r\nimport { Step } from \"../interfaces/Step\";\r\n\r\nexport abstract class MatchingAlgorithm {\r\n\r\n    abstract group1Name: string;\r\n    abstract group2Name: string;\r\n\r\n    numberOfAgents: number;\r\n    numberOfGroup2Agents: number;\r\n\r\n    freeAgentsOfGroup1: Array<String>;\r\n\r\n    group1Agents: Map<String, Agent> = new Map();\r\n    group2Agents: Map<String, Agent> = new Map();\r\n\r\n    algorithmData: AlgorithmData = {\r\n        commands: new Array(),\r\n        descriptions: new Array()\r\n    };\r\n\r\n    SRstable: boolean = true\r\n\r\n    currentLine: Array<string> = [];\r\n\r\n    originalGroup1CurrentPreferences: Map<String, Array<String>> = new Map();\r\n    originalGroup2CurrentPreferences: Map<String, Array<String>> = new Map();\r\n\r\n    group1CurrentPreferences: Map<String, Array<String>> = new Map();\r\n    group2CurrentPreferences: Map<String, Array<String>> = new Map();\r\n    currentlySelectedAgents: Array<string> = [];\r\n    currentLines: Array<Array<string>> = [];\r\n\r\n    algorithmSpecificData: Object = {};\r\n\r\n    relevantPreferences: Array<string> = [];\r\n\r\n    stable: boolean = false;\r\n\r\n    constructor() { }\r\n\r\n    initialise(numberOfAgents: number, numberOfGroup2Agents: number = numberOfAgents) {\r\n        this.freeAgentsOfGroup1 = [];\r\n\r\n        this.group1Agents = new Map();\r\n        this.group2Agents = new Map();\r\n\r\n        this.algorithmData = {\r\n            commands: new Array(),\r\n            descriptions: new Array()\r\n        };\r\n    \r\n        this.currentLine = [];\r\n    \r\n        this.group1CurrentPreferences = new Map();\r\n        this.group2CurrentPreferences = new Map();\r\n        this.currentlySelectedAgents = [];\r\n        this.currentLines = [];\r\n    \r\n        this.algorithmSpecificData = {};\r\n    \r\n        this.relevantPreferences = [];\r\n\r\n        this.numberOfAgents = numberOfAgents;\r\n        this.numberOfGroup2Agents = numberOfGroup2Agents;\r\n\r\n        this.stable = false;\r\n\r\n        \r\n    }\r\n\r\n    generateAgents() {\r\n        for (let i = 1; i < this.numberOfAgents + 1; i++) {\r\n            let group1AgentName = this.group1Name + i;\r\n\r\n            this.group1Agents.set(group1AgentName, {\r\n                name: group1AgentName,\r\n                match: new Array(),\r\n                ranking: new Array()\r\n            });\r\n\r\n            this.freeAgentsOfGroup1.push(group1AgentName);\r\n\r\n        }\r\n\r\n        let currentLetter = 'A';\r\n\r\n        for (let i = 1; i < this.numberOfGroup2Agents + 1; i++) {\r\n            let group2AgentName = this.group2Name + currentLetter;\r\n\r\n            this.group2Agents.set(group2AgentName, {\r\n                name: group2AgentName,\r\n                match: new Array(),\r\n                ranking: new Array()\r\n            });\r\n\r\n            currentLetter = String.fromCharCode((((currentLetter.charCodeAt(0) + 1) - 65 ) % 26) + 65);\r\n\r\n        }\r\n    }\r\n\r\n\r\n    // generates rankings for all agents\r\n    // changes agent.ranking\r\n    generatePreferences(): void {\r\n        \r\n        for (let agent of Array.from(this.group1Agents.values())) {\r\n            let agent1Rankings = Array.from((new Map(this.group2Agents)).values());\r\n            this.shuffle(agent1Rankings);\r\n            this.group1Agents.get(agent.name).ranking = agent1Rankings;\r\n        }\r\n\r\n        for (let agent of Array.from(this.group2Agents.values())) {\r\n            let agent2Rankings = Array.from((new Map(this.group1Agents)).values());\r\n            this.shuffle(agent2Rankings);\r\n            this.group2Agents.get(agent.name).ranking = agent2Rankings;\r\n        }\r\n\r\n    }\r\n\r\n    populatePreferences(preferences: Map<String, Array<String>>): void {\r\n        // console.log(\"preferences\", preferences);\r\n        let tempCopyList: Agent[];\r\n\r\n        for (let agent of Array.from(this.group1Agents.keys())) {\r\n            tempCopyList = [];\r\n            // this.group1Agents.get(agent).ranking = preferences.get(this.getLastCharacter(String(agent)));\r\n            for (let preferenceAgent of preferences.get(this.getLastCharacter(String(agent)))) {\r\n                tempCopyList.push(this.group2Agents.get(this.group2Name + preferenceAgent));\r\n            }\r\n            this.group1Agents.get(agent).ranking = tempCopyList;\r\n        }\r\n\r\n        for (let agent of Array.from(this.group2Agents.keys())) {\r\n            tempCopyList = [];\r\n            // this.group1Agents.get(agent).ranking = preferences.get(this.getLastCharacter(String(agent)));\r\n            for (let preferenceAgent of preferences.get(this.getLastCharacter(String(agent)))) {\r\n                tempCopyList.push(this.group1Agents.get(this.group1Name + preferenceAgent));\r\n            }\r\n            this.group2Agents.get(agent).ranking = tempCopyList;\r\n        }\r\n    \r\n        console.log(this.group1Agents);\r\n        console.log(this.group2Agents);\r\n\r\n    }\r\n\r\n    // FROM: https://javascript.info/task/shuffle\r\n    shuffle(array: Array<Object>) {\r\n        for (let i = array.length - 1; i > 0; i--) {\r\n          let j = Math.floor(Math.random() * (i + 1)); // random index from 0 to i\r\n      \r\n          // swap elements array[i] and array[j]\r\n          // we use \"destructuring assignment\" syntax to achieve that\r\n          // you'll find more details about that syntax in later chapters\r\n          // same can be written as:\r\n          // let t = array[i]; array[i] = array[j]; array[j] = t\r\n          [array[i], array[j]] = [array[j], array[i]];\r\n        }\r\n    }\r\n\r\n\r\n    getGroupRankings(agents: Map<String, Agent>): Map<String, Array<String>> {\r\n\r\n        let matches: Map<String, Array<String>> = new Map();\r\n\r\n        for (let agent of Array.from(agents.values())) {\r\n            let preferenceList = [];\r\n            for (let match of agent.ranking) {\r\n                preferenceList.push(match.name.slice(match.name.length - 1));\r\n            }\r\n\r\n            let identifier: string = agent.name.slice(agent.name.length - 1);\r\n            // console.log()\r\n\r\n            matches.set(identifier, preferenceList);\r\n\r\n        }\r\n\r\n        return matches;\r\n\r\n    }\r\n\r\n\r\n    clone(mapIn: Map<String, Array<String>>): Map<String, Array<String>> {\r\n        let mapCloned: Map<String, Array<String>> = new Map<String, Array<String>>();\r\n    \r\n        mapIn.forEach((str: Array<String>, key: String, mapObj: Map<String, Array<String>>) => {\r\n          \r\n          //products.slice(0) clone array\r\n          mapCloned.set(key, str.slice(0));\r\n        });\r\n    \r\n        return mapCloned;\r\n    }\r\n\r\n\r\n    update(step: number, stepVariables?: Object): void {\r\n        let currentStep: Step = {\r\n            lineNumber: step,\r\n            freeAgents: Object.assign([], this.freeAgentsOfGroup1),\r\n            matches: new Map(),\r\n            stepVariables: stepVariables,\r\n            group1CurrentPreferences: this.clone(this.group1CurrentPreferences),\r\n            group2CurrentPreferences: this.clone(this.group2CurrentPreferences),\r\n            currentlySelectedAgents: JSON.parse(JSON.stringify(this.currentlySelectedAgents)),\r\n            currentLines: JSON.parse(JSON.stringify(this.currentLines)),\r\n            algorithmSpecificData: JSON.parse(JSON.stringify(this.algorithmSpecificData)),\r\n            relevantPreferences: JSON.parse(JSON.stringify(this.relevantPreferences)),\r\n        }\r\n\r\n        this.algorithmData.commands.push(currentStep);\r\n\r\n    }\r\n\r\n\r\n    getMatches(): Map<String, Array<String>> {\r\n        let matches: Map<String, Array<String>> = new Map();\r\n\r\n        for (let i = 1; i < this.numberOfGroup2Agents + 1; i++) {\r\n            let agentName: string = this.group2Name + String.fromCharCode(i + 64);\r\n            let agent: Agent = this.group2Agents.get(agentName);\r\n\r\n            let matchList: Array<String> = new Array();\r\n\r\n            for (let match of agent.match) {\r\n                matchList.push(match.name);\r\n            }\r\n\r\n            matches.set(agent.name, matchList);\r\n\r\n        }\r\n\r\n        return matches;\r\n\r\n    }\r\n\r\n\r\n    findPositionInMatches(currentAgent: Agent, agentToFind: Agent): number {\r\n        let position: number = currentAgent.ranking.findIndex((agent: { name: string; }) => agent.name == agentToFind.name);\r\n        return position;\r\n    }\r\n\r\n    findPositionInOriginalMatches(currentAgent: Agent, agentToFind: Agent) {\r\n        let originalPreferences = this.originalGroup1CurrentPreferences.get(currentAgent.name[currentAgent.name.length - 1]);\r\n        // console.log(\"Group1\", originalPreferences)\r\n        let position: number = originalPreferences.indexOf(agentToFind.name[agentToFind.name.length - 1]);\r\n        return position;\r\n    }\r\n\r\n    findPositionInOriginalMatchesGroup2(currentAgent: Agent, agentToFind: Agent) {\r\n        let originalPreferences = this.originalGroup2CurrentPreferences.get(currentAgent.name[currentAgent.name.length - 1]);\r\n        // console.log(\"Group2\", originalPreferences)\r\n        let position: number = originalPreferences.indexOf(agentToFind.name[agentToFind.name.length - 1]);\r\n        return position;\r\n    }\r\n\r\n    // findPositionInOriginalMatches(currentAgent: Agent, agentToFind: Agent) {\r\n    //     let originalPreferences = this.originalGroup1CurrentPreferences.get(currentAgent.name[currentAgent.name.length - 1]);\r\n    //     console.log(\"originalPreferences\", originalPreferences)\r\n    //     return 0\r\n    // }\r\n\r\n    getLastCharacter(name: string) {\r\n        return name.slice(name.length - 1);\r\n    }\r\n\r\n    checkArrayEquality(a: Array<string>, b: Array<string>) {\r\n        for (let i = 0; i < a.length; i++) {\r\n          if (a[i] !== b[i]) { return false; }\r\n        }\r\n        return true;\r\n      }\r\n\r\n\r\n    // used to remove elements from currentLines\r\n    removeArrayFromArray(a: Array<Array<string>>, b: Array<string>) {\r\n        let arrayPositionCounter: number = 0;\r\n        for (let subArray of a) {\r\n          if (this.checkArrayEquality(subArray, b)) {\r\n            a.splice(arrayPositionCounter, 1);\r\n          }\r\n          arrayPositionCounter++;\r\n        }\r\n      }\r\n\r\n      // remove all lines in array that start at person\r\n      removePersonFromArray(a: Array<Array<string>>, person: String) {\r\n        let arrayPositionCounter: number = 0;\r\n        for (let subArray of a) {\r\n            if (subArray[0] == person) {\r\n                a.splice(arrayPositionCounter, 1);\r\n            }\r\n            arrayPositionCounter++;\r\n        }\r\n      }\r\n\r\n      // remove all lines leeding to a person from the array\r\n      removeTargetFromArray(a: Array<Array<string>>, person: String) {\r\n        let arrayPositionCounter: number = 0;\r\n        for (let subArray of a) {\r\n            if (subArray[1] == person) {\r\n                a.splice(arrayPositionCounter, 1);\r\n            }\r\n            arrayPositionCounter++;\r\n        }\r\n      }\r\n\r\n\r\n    // #53D26F (green)\r\n    // #C4C4C4 (grey)\r\n    // changePreferenceStyle(preferenceList: Object, person: string, position: number, style: string) {\r\n    changePreferenceStyle(preferenceList: Map<String, Array<String>>, person: string, position: number, style: string) {\r\n\r\n        let currentAgent: string = \"\";\r\n\r\n        // console.log(\"inner\", preferenceList, preferenceList.get(person), preferenceList.get(person)[position], person, position, style)\r\n\r\n        if (preferenceList.get(person)[position].includes(\"#\")) {\r\n        currentAgent = preferenceList.get(person)[position].charAt(preferenceList.get(person)[position].length - 2);\r\n        } else {\r\n        currentAgent = preferenceList.get(person)[position].charAt(preferenceList.get(person)[position].length - 1);\r\n        }\r\n\r\n        if (style == \"green\") {\r\n        style = \"#53D26F\";\r\n        } else if (style == \"red\") {\r\n        style = \"#EB2A2A\";\r\n        } else if (style == \"grey\") {\r\n        style = \"#C4C4C4\";\r\n        } else if (style == \"black\") {\r\n        style = \"#000000\";\r\n        }\r\n\r\n        preferenceList.get(person)[position] = \"{\" + style + currentAgent + \"}\";\r\n\r\n    }\r\n\r\n\r\n    // check if no unmatched pair like each other more than their current partners\r\n    checkStability(allMatches: Map<String, Array<String>>): boolean {\r\n        let stability = true;\r\n\r\n        // for all women\r\n        for (let agent of allMatches.keys()) {\r\n            let agentMatches = allMatches.get(agent);\r\n\r\n            // if agent has matches\r\n            if (agentMatches.length > 0) {\r\n\r\n                // find the position of the last ranked match (for Stable Marriage this will be the only match)\r\n                let lastAgentPosition = this.getLastMatch(agent, agentMatches);\r\n                let agentPreferences: Array<Agent> = this.group2Agents.get(agent).ranking;\r\n\r\n                // for every agent, x, better than match, check:\r\n                //   - if x isn't one of the matches (for HR), then\r\n                //      - check if x likes currentAgent more than their match\r\n                //          - if yes, stability = false\r\n                //          - if no, stability = true\r\n                for (let i = lastAgentPosition - 1; i >= 0; i--) {\r\n                    if (!agentMatches.includes(agentPreferences[i].name)) {\r\n                        let matchPosition = this.findPositionInOriginalMatches(agentPreferences[i], agentPreferences[i].match[0]);\r\n                        let currentAgentPosition = this.findPositionInOriginalMatches(agentPreferences[i], this.group2Agents.get(agent));\r\n                        if (currentAgentPosition < matchPosition) {\r\n                            stability = false;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return stability;\r\n    }\r\n\r\n    getLastMatch(currentAgent: String, agentMatches: Array<String>): number {\r\n        let furthestIndex: number = 0;\r\n        for (let matchAgent of agentMatches) {\r\n            let matchPosition = this.findPositionInMatches(this.group2Agents.get(currentAgent), this.group1Agents.get(matchAgent));\r\n            if (matchPosition > furthestIndex) {\r\n                furthestIndex = matchPosition;\r\n            }\r\n        }\r\n        return furthestIndex;\r\n    }\r\n\r\n\r\n    abstract match(): AlgorithmData;\r\n\r\n    run(numberOfAgents: number, numberOfGroup2Agents: number = numberOfAgents, preferences: Map<String, Array<String>>, SRstable: boolean = true): AlgorithmData {\r\n        if (numberOfGroup2Agents != numberOfAgents) {\r\n            this.initialise(numberOfAgents, numberOfGroup2Agents);\r\n        } else {\r\n            this.initialise(numberOfAgents);\r\n        }\r\n\r\n        if (numberOfGroup2Agents == 0){\r\n            console.log(\"0 agents in group 2\");\r\n        }\r\n\r\n        console.log(\"run\", SRstable)\r\n        \r\n        if (SRstable) {\r\n            console.log(SRstable, \"true\")\r\n            this.SRstable = true\r\n        } else {\r\n            console.log(SRstable, \"false\")\r\n            this.SRstable = false\r\n        }\r\n\r\n        this.generateAgents();\r\n\r\n        if (preferences) {\r\n            this.populatePreferences(preferences);\r\n        } else {\r\n            this.generatePreferences();\r\n        }\r\n\r\n\r\n       \r\n\r\n        this.group1CurrentPreferences = this.getGroupRankings(this.group1Agents);\r\n        this.originalGroup1CurrentPreferences = this.getGroupRankings(this.group1Agents);\r\n\r\n        this.group2CurrentPreferences = this.getGroupRankings(this.group2Agents);\r\n        this.originalGroup2CurrentPreferences = this.getGroupRankings(this.group2Agents);\r\n\r\n        this.match();\r\n\r\n        this.stable = this.checkStability(this.getMatches());\r\n\r\n        if (!this.stable) {\r\n            console.log(\"Matching is not stable!\");\r\n            return undefined;\r\n        }\r\n\r\n        return this.algorithmData;\r\n\r\n    }\r\n\r\n    \r\n\r\n}","import { AlgorithmData } from \"../interfaces/AlgorithmData\";\r\nimport { MatchingAlgorithm } from \"./MatchingAlgorithm\";\r\nimport { Person } from '../interfaces/Person';\r\nimport { Agent } from \"../interfaces/Agent\";\r\n\r\n\r\nexport abstract class StableRoomMates extends MatchingAlgorithm {\r\n\r\n    constructor() {\r\n        super();\r\n        // console.log(\"StableRoomMates Class\");\r\n    }\r\n\r\n    generatePreferences(): void {\r\n\r\n        console.log(\"Gen Pref\", this.SRstable)\r\n        \r\n\r\n        let data2 = [[\"2\",\"4\",\"6\",\"3\",\"5\"],\r\n                    [\"4\",\"5\",\"6\",\"1\",\"3\"],\r\n                    [\"4\",\"5\",\"6\",\"1\",\"2\"],\r\n                    [\"6\",\"3\",\"1\",\"5\",\"2\"],\r\n                    [\"6\",\"3\",\"4\",\"2\",\"1\"],\r\n                    [\"1\",\"2\",\"4\",\"3\",\"5\"]];\r\n\r\n        \r\n\r\n        let unstable4 = [   [\"2\",\"3\",\"4\",],\r\n                            [\"3\",\"1\",\"4\",],\r\n                            [\"1\",\"2\",\"4\",],\r\n                            [\"1\",\"2\",\"3\",]]\r\n\r\n        let unstable6_1 = [ [\"4\", \"6\", \"5\", \"2\", \"3\"],\r\n                            [\"5\", \"4\", \"3\", \"6\", \"1\"],\r\n                            [\"4\", \"5\", \"2\", \"1\", \"6\"],\r\n                            [\"5\", \"3\", \"1\", \"6\", \"2\"],\r\n                            [\"6\", \"2\", \"1\", \"4\", \"3\"],\r\n                            [\"3\", \"2\", \"4\", \"5\", \"1\"]]\r\n\r\n        let unstable6_2 = [ ['5', '4', '3', '2', '6'],\r\n                            ['3', '5', '6', '1', '4'],\r\n                            ['5', '1', '4', '6', '2'],\r\n                            ['3', '2', '1', '6', '5'],\r\n                            ['2', '3', '6', '4', '1'],\r\n                            ['5', '1', '2', '4', '3']]\r\n\r\n        let unstable6_3 = [ ['5', '2', '6', '4', '3'],\r\n                            ['4', '1', '6', '3', '5'],\r\n                            ['5', '2', '6', '1', '4'],\r\n                            ['5', '2', '6', '1', '3'],\r\n                            ['6', '4', '1', '2', '3'],\r\n                            ['1', '5', '4', '2', '3']]\r\n\r\n      \r\n        let unstable8_1 = [ ['3', '8', '7', '4', '5', '6', '2'],\r\n                            ['5', '3', '4', '1', '6', '7', '8'],\r\n                            ['8', '6', '2', '7', '1', '4', '5'],\r\n                            ['2', '1', '5', '7', '8', '6', '3'],\r\n                            ['4', '1', '7', '2', '6', '8', '3'],\r\n                            ['8', '1', '2', '4', '3', '5', '7'],\r\n                            ['3', '6', '8', '4', '2', '1', '5'],\r\n                            ['7', '1', '5', '4', '6', '3', '2'],]\r\n\r\n        let unstable8_2 = [ ['2', '7', '4', '5', '3', '6', '8'],\r\n                            ['1', '4', '5', '7', '3', '8', '6'],\r\n                            ['1', '7', '8', '5', '2', '6', '4'],\r\n                            ['8', '5', '1', '6', '7', '3', '2'],\r\n                            ['2', '6', '1', '8', '4', '3', '7'],\r\n                            ['5', '3', '2', '7', '1', '4', '8'],\r\n                            ['5', '2', '8', '6', '3', '4', '1'],\r\n                            ['3', '1', '7', '5', '6', '4', '2'],]\r\n\r\n        let unstable8_3 = [ ['7', '6', '5', '3', '4', '2', '8'],\r\n                            ['5', '6', '4', '1', '8', '3', '7'],\r\n                            ['2', '7', '8', '6', '5', '1', '4'],\r\n                            ['8', '3', '6', '2', '5', '7', '1'],\r\n                            ['1', '7', '3', '8', '6', '2', '4'],\r\n                            ['1', '2', '8', '5', '7', '4', '3'],\r\n                            ['1', '2', '8', '6', '5', '3', '4'],\r\n                            ['7', '2', '3', '1', '5', '4', '6'],]\r\n\r\n\r\n        let count = 0;\r\n        let name = \"p\"\r\n\r\n        let nonStableSRInstacens6 = [unstable6_1, unstable6_2, unstable6_3]\r\n        let nonStableSRInstacens8 = [unstable8_1, unstable8_2, unstable8_3]\r\n        let random = 0\r\n        let instance = []\r\n\r\n       \r\n        // generate a random SR instance \r\n        if (this.SRstable) {\r\n            console.log(\"Generating Stable\")\r\n\r\n            for (let agent of Array.from(this.group1Agents.values())) {\r\n            let agent1Rankings = Array.from((new Map(this.group1Agents)).values());\r\n\r\n            let selfIndex = agent1Rankings.indexOf(agent)\r\n\r\n            agent1Rankings.splice(selfIndex, 1)\r\n\r\n            this.shuffle(agent1Rankings);\r\n            this.group1Agents.get(agent.name).ranking = agent1Rankings;\r\n\r\n            } \r\n\r\n        // pick a non-stable instance \r\n        } else {\r\n            console.log(\"Generating UnStable\")\r\n\r\n            if (this.numberOfAgents == 2){\r\n                this.SRstable = true\r\n            } else if (this.numberOfAgents == 4) {\r\n                instance = unstable4\r\n            } else if (this.numberOfAgents == 6) {\r\n                random = Math.floor(Math.random() * nonStableSRInstacens6.length);\r\n                instance = nonStableSRInstacens6[random]\r\n            } else if (this.numberOfAgents == 8) {\r\n                random = Math.floor(Math.random() * nonStableSRInstacens8.length);\r\n                instance = nonStableSRInstacens8[random]\r\n            } else {\r\n                instance = []\r\n            }\r\n\r\n            for (let [key, person] of this.group1Agents.entries()){   \r\n                for (let i = 0 ; i < this.group1Agents.size - 1 ; i++){\r\n\r\n                    person.ranking[i] = this.group1Agents.get(name + String(instance[count][i]));\r\n                }\r\n                count++;\r\n            }\r\n        }\r\n// for (let [key, person] of this.group1Agents.entries()){   \r\n        //     for (let i = 0 ; i < this.group1Agents.size - 1 ; i++){\r\n        //         //console.log(this.group1Agents.get(data2[count][i]), data2[count][i]);\r\n        //         person.ranking[i] = this.group1Agents.get(name + String(data4[count][i]));\r\n        //     }\r\n        //     count++;\r\n        // }\r\n\r\n\r\n    }\r\n\r\n    populatePreferences(preferences: Map<String, Array<String>>): void {\r\n        console.log(\"preferences\", preferences);\r\n        let tempCopyList: Agent[];\r\n\r\n        for (let agent of Array.from(this.group1Agents.keys())) {\r\n            tempCopyList = [];\r\n            // this.group1Agents.get(agent).ranking = preferences.get(this.getLastCharacter(String(agent)));\r\n            for (let preferenceAgent of preferences.get(this.getLastCharacter(String(agent)))) {\r\n                tempCopyList.push(this.group1Agents.get(this.group1Name + preferenceAgent));\r\n            }\r\n            this.group1Agents.get(agent).ranking = tempCopyList;\r\n        }\r\n\r\n        for (let agent of Array.from(this.group2Agents.keys())) {\r\n            tempCopyList = [];\r\n            // this.group1Agents.get(agent).ranking = preferences.get(this.getLastCharacter(String(agent)));\r\n            for (let preferenceAgent of preferences.get(this.getLastCharacter(String(agent)))) {\r\n                tempCopyList.push(this.group1Agents.get(this.group1Name + preferenceAgent));\r\n            }\r\n            this.group2Agents.get(agent).ranking = tempCopyList;\r\n        }\r\n    \r\n        console.log(this.group1Agents);\r\n        console.log(this.group2Agents);\r\n\r\n    }\r\n\r\n   \r\n\r\n    \r\n\r\n    abstract match(): AlgorithmData;\r\n\r\n}","import { Injectable } from '@angular/core';\r\nimport { CheckboxControlValueAccessor } from '@angular/forms';\r\nimport { ExtendedGaleShapley } from '../../abstract-classes/ExtendedGaleShapley';\r\nimport { GaleShapley } from '../../abstract-classes/GaleShapley';\r\nimport { Agent } from '../../interfaces/Agent';\r\nimport { AlgorithmData } from '../../interfaces/AlgorithmData';\r\nimport { Hospital } from '../../interfaces/Hospital';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class HrHospitalEgsService extends GaleShapley{\r\n\r\n  group1Name = \"resident\";\r\n  group2Name = \"hospital\";\r\n\r\n  group2Agents: Map<String, Hospital> = new Map();\r\n\r\n  hospitalCapacity: Map<string, number> = new Map();\r\n\r\n  freeAgentsOfGroup2: Array<String> = new Array();\r\n\r\n\r\n  generateAgents() {\r\n      for (let i = 1; i < this.numberOfAgents + 1; i++) {\r\n          let group1AgentName = this.group1Name + i;\r\n\r\n          this.group1Agents.set(group1AgentName, {\r\n              name: group1AgentName,\r\n              match: new Array(),\r\n              ranking: new Array(),\r\n          });\r\n\r\n          this.freeAgentsOfGroup1.push(group1AgentName);\r\n\r\n      }\r\n\r\n      let currentLetter = 'A';\r\n\r\n      for (let i = 1; i < this.numberOfGroup2Agents + 1; i++) {\r\n          let group2AgentName = this.group2Name + currentLetter;\r\n\r\n          let availableSpaces = this.getRandomInt(1, this.numberOfAgents-2);\r\n\r\n          this.group2Agents.set(group2AgentName, {\r\n              name: group2AgentName,\r\n              match: new Array(),\r\n              ranking: new Array(),\r\n              availableSpaces: availableSpaces\r\n          });\r\n\r\n\t\t//   console.log(group2AgentName)\r\n\t\t//   console.log(this.freeAgentsOfGroup2)\r\n\r\n\t\t  this.freeAgentsOfGroup2.push(group2AgentName);\r\n\r\n          this.hospitalCapacity[currentLetter] = availableSpaces;\r\n\r\n          currentLetter = String.fromCharCode((((currentLetter.charCodeAt(0) + 1) - 65 ) % 26) + 65);\r\n      }\r\n      this.algorithmSpecificData[\"hospitalCapacity\"] = this.hospitalCapacity;\r\n  }\r\n\r\n  getRandomInt(min: number, max: number): number {\r\n\tmin = Math.ceil(min);\r\n\tmax = Math.floor(max);\r\n\treturn Math.floor(Math.random() * (max - min + 1) + min)\r\n}\r\n\r\n\r\n// returns next possible resident for a hospital - null if none\r\n// one that is not assigned to the hospital and is on the hospitals preferance list\r\ngetNextPotentialProposee(hospital: Hospital){\r\n\r\n\t// for each resident in ranking \r\n\tfor (let i = 0 ; i < hospital.ranking.length ; i++){\r\n\t\tlet proposee = hospital.ranking[i]\r\n\r\n\t\t// if resident is not assigned to hospital - return\r\n\t\tif (proposee.match[0] != hospital) {\r\n\t\t\treturn proposee;\r\n\t\t}\r\n\t}\r\n\t// return null there are no un assigned residents \r\n\treturn null;\r\n}\r\n\r\ngetWorstResident(hospital: Hospital): Agent {\r\n\r\n\tlet positionMap: Map<number, Agent> = new Map();\r\n\r\n\tfor (let resident of hospital.match) {\r\n\t\tpositionMap.set(this.findPositionInMatches(hospital, resident), resident);\r\n\t}\r\n\r\n\t// use destructuring assingment to extract data from array into distinct variables\r\n\t// return the worst resident from the hospital's matches\r\n\treturn positionMap.get(Math.max(...Array.from(positionMap.keys())));\r\n}\r\n\r\nbreakAssignment(resident: Agent, hospital: Agent): void {\r\n\r\n\t// console.log(\"break Assignment\")\r\n\t// console.log(resident.name, resident.match[0].name, hospital.name)\r\n\r\n\t\r\n\r\n\t// get pos in each rankings lists to remove later \r\n\tlet matchPosition_resident = this.findPositionInMatches(hospital, resident);\r\n\tlet matchPosition_hospital = this.findPositionInMatches(resident, hospital);\r\n\r\n\tlet matchPosition_resident_original = this.findPositionInOriginalMatchesGroup2(hospital, resident);\r\n\r\n\t// console.log(matchPosition_resident, matchPosition_hospital)\r\n\t// console.log(hospital.ranking)\r\n\t\r\n\tthis.removeArrayFromArray(this.currentLines, [this.getLastCharacter(resident.name), this.getLastCharacter(hospital.name), \"green\"]);\r\n\r\n\tthis.changePreferenceStyle(this.group1CurrentPreferences, this.getLastCharacter(resident.name), this.originalGroup1CurrentPreferences.get(this.getLastCharacter(resident.name)).findIndex(h => h == this.getLastCharacter(hospital.name)), \"grey\");\r\n\tthis.changePreferenceStyle(this.group2CurrentPreferences, this.getLastCharacter(hospital.name), matchPosition_resident_original, \"red\");\r\n\r\n\t// unassign r and h'\r\n\tthis.update(5, {\"%oldHospital%\": resident.match[0].name, \"%resident%\": resident.name});\r\n\r\n\tthis.changePreferenceStyle(this.group2CurrentPreferences, this.getLastCharacter(hospital.name), matchPosition_resident_original, \"grey\");\r\n\r\n\r\n\tthis.update(1)\r\n\r\n\r\n\t// remove hospital from resident match \r\n\tresident.match.splice(0, 1);\r\n\t// remove resident from hospital match \r\n\thospital.match.splice(hospital.match.findIndex((agent: { name: string; }) => agent.name == resident.name), 1);\r\n\r\n\t// REMOVE EACH OTHER FROM RANKING LIST \r\n\thospital.ranking.splice(matchPosition_resident, 1); \t// HOSPITAL \r\n\tresident.ranking.splice(matchPosition_hospital, 1) \t\t//RESIDENT \r\n\r\n\tlet hospitalLastChar = this.getLastCharacter(hospital.name);\r\n\tlet currentHospitalCapacity: string = this.algorithmSpecificData[\"hospitalCapacity\"][hospitalLastChar];\r\n\r\n\tthis.algorithmSpecificData[\"hospitalCapacity\"][hospitalLastChar] = String(currentHospitalCapacity).charAt(currentHospitalCapacity.length);\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t// console.log(\"rankings after - h / r\")\r\n\t// console.log(hospital.ranking, resident.ranking)\r\n\r\n\r\n\r\n\r\n\t\r\n\r\n  }\r\n\r\n  provisionallyAssign(resident: Agent, hospital: Hospital) {\r\n\t// provisionally assign r to h;\r\n\r\n\tlet agentLastChar = this.getLastCharacter(resident.name);\r\n\tlet proposeeLastChar = this.getLastCharacter(hospital.name);\r\n\r\n\tthis.removeArrayFromArray(this.currentLines, [agentLastChar, proposeeLastChar, \"red\"]);\r\n\r\n\tlet greenLine = [agentLastChar, proposeeLastChar, \"green\"];\r\n\tthis.currentLines.push(greenLine);\r\n\r\n\tthis.changePreferenceStyle(this.group1CurrentPreferences, agentLastChar, this.originalGroup1CurrentPreferences.get(agentLastChar).findIndex(h => h == this.getLastCharacter(hospital.name)), \"green\");\r\n\tthis.changePreferenceStyle(this.group2CurrentPreferences, proposeeLastChar, this.findPositionInMatches(hospital, resident), \"green\");\r\n\r\n\tif (hospital.match.length >= hospital.availableSpaces - 1) {\r\n\t  this.algorithmSpecificData[\"hospitalCapacity\"][proposeeLastChar] = \"{#53D26F\" + this.algorithmSpecificData[\"hospitalCapacity\"][proposeeLastChar] + \"}\";\r\n\t}\r\n\r\n\r\n\tresident.match[0] = hospital;\r\n\thospital.match.push(resident);\r\n}\r\n\r\nremoveRuledOutPreferences(resident: Agent, hospital: Hospital): void {\r\n\r\n    \r\n \r\n      if (hospital.match.length >= hospital.availableSpaces) {\r\n          let worstResident: Agent = this.getWorstResident(hospital);\r\n          let worstResidentPosition: number = this.findPositionInMatches(hospital, worstResident);\r\n\r\n\r\n          let hospitalRankingClearCounter: number = worstResidentPosition + 1;\r\n\r\n     \t // for each successor h' of h on r's list \r\n\t\tthis.update(7, {\"%resident%\" : resident.name, \"%hospital%\" : hospital.name});\r\n\t\t\r\n          for (let i = worstResidentPosition + 1; i < hospital.ranking.length; i++) {\r\n\r\n              let hospitalPosition: number = this.findPositionInMatches(hospital.ranking[i], hospital);\r\n              this.relevantPreferences.push(this.getLastCharacter(hospital.ranking[i].name));\r\n\r\n              this.changePreferenceStyle(this.group1CurrentPreferences, this.getLastCharacter(hospital.ranking[i].name), this.originalGroup1CurrentPreferences.get(this.getLastCharacter(hospital.ranking[i].name)).findIndex(h => h == this.getLastCharacter(hospital.name)), \"grey\");\r\n              this.changePreferenceStyle(this.group2CurrentPreferences, this.getLastCharacter(hospital.name), hospitalRankingClearCounter, \"grey\");\r\n              \r\n\t\t\t  // remove r' and h from each others preferance list\r\n              this.update(8, {\"%hospital%\": hospital.name, \"%resident%\": hospital.ranking[i].name});\r\n\r\n\t\t\t  hospital.ranking[i].ranking.splice(hospitalPosition, 1);\r\n  \r\n\r\n              hospital.ranking.splice(i, 1);\r\n              i -= 1;\r\n              \r\n              hospitalRankingClearCounter++;\r\n\r\n              this.relevantPreferences.pop();\r\n\r\n          }\r\n\r\n      }\r\n\r\n  }\r\n\r\n  print_matches(){\r\n\r\n\tfor (let [key, resident] of this.group1Agents.entries()){\r\n\t\t// console.log(key, resident.match)\r\n\t}\r\n\r\n\tfor (let [key, hospital] of this.group2Agents.entries()){\r\n\t\t// console.log(key, hospital.match)\r\n\r\n\t}\r\n\r\n\r\n\r\n\r\n  }\r\n\r\n  shouldContinueMatching(hospital: Hospital): boolean {\r\n\treturn true;\r\n}\r\n\r\n// returns true if there is a resident on the list that is not matched with that hospital \r\ncheckHospitalPreferanceList(hospital: Hospital) {\r\n\r\n\tfor (let resident of hospital.ranking){\r\n\t\t// if they are not matched to the hospital \r\n\t\tif (resident.match[0] != hospital){\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n// returns all the hospitals that should be looked at \r\n// they are undersubbed and there is someone not assigned to them that the hospital wants \r\ncheckFreeHospitals(){\r\n\r\n\tlet freeHospitals = []\r\n\tfor (let [key, hospital] of this.group2Agents.entries()){\r\n\r\n\t\tlet hospitalCap = this.algorithmSpecificData[\"hospitalCapacity\"][this.getLastCharacter(hospital.name)]\r\n\r\n\t\t// if hospital in undersubbed and there is someone on the list that is not assigned to them \r\n\t\tif (hospital.match.length < hospitalCap && this.checkHospitalPreferanceList(hospital)){\r\n\t\t\tfreeHospitals.push(hospital.name)\r\n\t\t}\r\n\t}\r\n\r\n\treturn freeHospitals\r\n}\r\n\r\n\r\n\r\n  match(): AlgorithmData {\r\n\t  \r\n\r\n\t// this.group1Agents - residents \r\n\t// this.group2Agents - hospitals\r\n\r\n\t// console.log(\"groups\")\r\n\t// console.log(this.group1Agents, this.group1Agents)\r\n\r\n\t// \"Set each hospital and resident to be completely free\",\r\n\tthis.update(1)\r\n\r\n\r\n\t// while a HOSPITAL h is under-subscribed and \r\n\t// h's list contains a a RESIDENT r not assigned to h\r\n\r\n\tlet counter_break = 0\r\n\r\n\twhile (this.freeAgentsOfGroup2.length > 0){\r\n\t\t\r\n\r\n\t\t// get first hospital on list \r\n\t\tlet currentHospital = this.group2Agents.get(this.freeAgentsOfGroup2[0]);\r\n\t\t\r\n\t\t// \"While some hospital h is - undersubscibed, \r\n\t\t// and has a resident r on h's preferance list that is no assigned to h\",\r\n\t\tthis.update(2, {\"%hospital%\" : currentHospital.name});\r\n\r\n\t\t// console.log(currentHospital)\r\n\r\n\t\tif (currentHospital.ranking.length <= 0 || !this.getNextPotentialProposee(currentHospital)){\r\n\t\t\tthis.freeAgentsOfGroup2.shift();\r\n\t\t} else {\r\n\r\n\t\t\tlet potentialProposee: Agent = this.getNextPotentialProposee(currentHospital);\r\n\r\n\t\t\t// a RESIDENT r that is not assigned to h, but is on its pref list \r\n\t\t\t// \"r := first resident on h's prefernace list not assigned to h\",\r\n\t\t\tthis.update(3, {\"%resident%\" : potentialProposee.name})\r\n\t\t\t\r\n\t\t\t// console.log(\"potentialProposee\", potentialProposee)\r\n\t\t\t\r\n\t\t\t// if proposee is assigned to a different hospital then un assign\r\n\t\t\t\r\n\t\t\t// if r is assigned to another hospital h\r\n\t\t\tthis.update(4, {\"%resident%\" : potentialProposee.name})\r\n\t\t\t\r\n\t\t\tif (potentialProposee.match[0] != null){\r\n\t\t\t\tthis.breakAssignment(potentialProposee, potentialProposee.match[0]);\r\n\t\t\t}\r\n\r\n\t\t\t\r\n\t\t\t// MATHCING MIGHT NOT STABLE \r\n\t\t\t// VIZ HAS BEEN WORKED ON WITH COMMENTS NEEDS TESTING \r\n\t\t\t// UPDATES MAY BE IN WRONG PLACE TO ACCOMADATE THE CHNAGING VIZ LINES - NEEDS TESTING \r\n\r\n\t\t\t// provisionally assign r to h\r\n\t\t\tthis.provisionallyAssign(potentialProposee, currentHospital);\r\n\t\t\tthis.update(6, {\"%resident%\" : potentialProposee.name, \"%hospital%\" : currentHospital.name})\r\n\r\n\r\n\t\t\tthis.removeRuledOutPreferences(potentialProposee, currentHospital);\r\n\r\n\t\t\tthis.freeAgentsOfGroup2 = this.checkFreeHospitals()\r\n\r\n\t\t\t// continous loop as guessed + not clear way to define/get free hospitals\r\n\t\t\t// rankings should be deleted until convergence?\r\n\r\n\t\t\tthis.freeAgentsOfGroup2 = this.checkFreeHospitals()\r\n\t\t\t// console.log(\"free Agents on iteration\", counter_break, this.freeAgentsOfGroup2)\r\n\r\n\t\t\tif (this.shouldContinueMatching(currentHospital)) {\r\n\t\t\t\tthis.freeAgentsOfGroup1.shift();\r\n\t\t\t}\r\n\r\n\t\t\t\r\n\t\t}\r\n\r\n\r\n\t// breaking to stop infinite loop \r\n\t// break;\r\n\r\n\tcounter_break = counter_break + 1;\r\n\t// console.log(counter_break > 20)\r\n\r\n\t\r\n\t \r\n\tif (counter_break > 200){\r\n\t\t// console.log(\"Done ---- Done ----\")\r\n\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\t// stable matching found \r\n\tthis.update(9)\r\n\tthis.print_matches();\r\n\treturn;\r\n  }\r\n\r\n}\r\n\r\n// MAY PRODUCE UNSTABLE MATCHINGS DUE TO BLOCKING PAIRS - CHECKED BY WEBAPP\r\n// OTHER ISSUES - SOME HOSPITALS/RESIDENTS ARE NOT MACTHED DUE To TAKEN BY OTHER HOSPITALS\r\n// AND THEIR PREFERANCE LIST BEING EMPTYED BY PREVOUIS STEPS \r\n\r\n// NEEDS RESEARCJ TO FIX - I THINK I PRODUCES ","import { Injectable } from '@angular/core';\r\nimport { ExtendedGaleShapley } from '../../abstract-classes/ExtendedGaleShapley';\r\nimport { Agent } from '../../interfaces/Agent';\r\nimport { Hospital } from '../../interfaces/Hospital';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class HrResidentEgsService extends ExtendedGaleShapley {\r\n\r\n  group1Name = \"resident\";\r\n  group2Name = \"hospital\";\r\n\r\n  group2Agents: Map<String, Hospital> = new Map();\r\n\r\n  hospitalCapacity: Map<string, number> = new Map();\r\n\r\n\r\n  generateAgents() {\r\n      for (let i = 1; i < this.numberOfAgents + 1; i++) {\r\n          let group1AgentName = this.group1Name + i;\r\n\r\n          this.group1Agents.set(group1AgentName, {\r\n              name: group1AgentName,\r\n              match: new Array(),\r\n              ranking: new Array(),\r\n          });\r\n\r\n          this.freeAgentsOfGroup1.push(group1AgentName);\r\n\r\n      }\r\n\r\n      let currentLetter = 'A';\r\n\r\n      for (let i = 1; i < this.numberOfGroup2Agents + 1; i++) {\r\n          let group2AgentName = this.group2Name + currentLetter;\r\n\r\n          let availableSpaces = this.getRandomInt(1, this.numberOfAgents-2);\r\n\r\n          this.group2Agents.set(group2AgentName, {\r\n              name: group2AgentName,\r\n              match: new Array(),\r\n              ranking: new Array(),\r\n              availableSpaces: availableSpaces\r\n          });\r\n\r\n          this.hospitalCapacity[currentLetter] = availableSpaces;\r\n\r\n          currentLetter = String.fromCharCode((((currentLetter.charCodeAt(0) + 1) - 65 ) % 26) + 65);\r\n      }\r\n      this.algorithmSpecificData[\"hospitalCapacity\"] = this.hospitalCapacity;\r\n  }\r\n\r\n  print_matches(){\r\n\r\n\tfor (let [key, resident] of this.group1Agents.entries()){\r\n\t\tconsole.log(key, resident.match)\r\n\t}\r\n\r\n\tfor (let [key, hospital] of this.group2Agents.entries()){\r\n\t\tconsole.log(key, hospital.match)\r\n\r\n\t}\r\n}\r\n\r\n\r\n  getRandomInt(min: number, max: number): number {\r\n      min = Math.ceil(min);\r\n      max = Math.floor(max);\r\n      return Math.floor(Math.random() * (max - min + 1) + min)\r\n  }\r\n\r\n\r\n  getWorstResident(hospital: Hospital): Agent {\r\n\r\n      let positionMap: Map<number, Agent> = new Map();\r\n\r\n      for (let resident of hospital.match) {\r\n          positionMap.set(this.findPositionInMatches(hospital, resident), resident);\r\n      }\r\n\r\n      // use destructuring assingment to extract data from array into distinct variables\r\n      // return the worst resident from the hospital's matches\r\n      return positionMap.get(Math.max(...Array.from(positionMap.keys())));\r\n  }\r\n\r\n\r\n  getNextPotentialProposee(hospital: Hospital): Agent {\r\n      // return first hospital on r's list\r\n      return hospital.ranking[0];\r\n  }\r\n\r\n  breakAssignment(resident: Agent, hospital: Hospital): void {\r\n\r\n    this.update(4, {\"%hospital%\": hospital.name, \"%capacity%\": hospital.availableSpaces, \"%resident%\": resident.name});\r\n    if (hospital.match.length >= hospital.availableSpaces) {\r\n        let worstResident = this.getWorstResident(hospital);\r\n        this.update(5, {\"%hospital%\": hospital.name, \"%worstResident%\": worstResident.name});\r\n\r\n\r\n        let matchPosition = this.findPositionInMatches(hospital, worstResident);\r\n\r\n        this.removeArrayFromArray(this.currentLines, [this.getLastCharacter(worstResident.name), this.getLastCharacter(hospital.name), \"green\"]);\r\n\r\n        this.changePreferenceStyle(this.group1CurrentPreferences, this.getLastCharacter(worstResident.name), this.originalGroup1CurrentPreferences.get(this.getLastCharacter(worstResident.name)).findIndex(h => h == this.getLastCharacter(hospital.name)), \"grey\");\r\n        this.changePreferenceStyle(this.group2CurrentPreferences, this.getLastCharacter(hospital.name), matchPosition, \"grey\");\r\n\r\n        this.freeAgentsOfGroup1.push(worstResident.name);\r\n\r\n        hospital.match.splice(hospital.match.findIndex((agent: { name: string; }) => agent.name == worstResident.name), 1);\r\n        hospital.ranking.splice(matchPosition, 1);\r\n\r\n        worstResident.match.splice(0, 1);\r\n        worstResident.ranking.splice(this.findPositionInMatches(worstResident, hospital), 1);\r\n\r\n        let hospitalLastChar = this.getLastCharacter(hospital.name);\r\n        let currentHospitalCapacity: string = this.algorithmSpecificData[\"hospitalCapacity\"][hospitalLastChar];\r\n\r\n        this.algorithmSpecificData[\"hospitalCapacity\"][hospitalLastChar] = String(currentHospitalCapacity).charAt(currentHospitalCapacity.length - 2);\r\n\r\n        this.update(6, {\"%hospital%\": hospital.name, \"%worstResident%\": worstResident.name});\r\n\r\n    }\r\n  }\r\n\r\n  provisionallyAssign(resident: Agent, hospital: Hospital) {\r\n      // provisionally assign r to h;\r\n\r\n      let agentLastChar = this.getLastCharacter(resident.name);\r\n      let proposeeLastChar = this.getLastCharacter(hospital.name);\r\n\r\n      this.removeArrayFromArray(this.currentLines, [agentLastChar, proposeeLastChar, \"red\"]);\r\n\r\n      let greenLine = [agentLastChar, proposeeLastChar, \"green\"];\r\n      this.currentLines.push(greenLine);\r\n\r\n      this.changePreferenceStyle(this.group1CurrentPreferences, agentLastChar, this.originalGroup1CurrentPreferences.get(agentLastChar).findIndex(h => h == this.getLastCharacter(hospital.name)), \"green\");\r\n      this.changePreferenceStyle(this.group2CurrentPreferences, proposeeLastChar, this.findPositionInMatches(hospital, resident), \"green\");\r\n\r\n      if (hospital.match.length >= hospital.availableSpaces - 1) {\r\n        this.algorithmSpecificData[\"hospitalCapacity\"][proposeeLastChar] = \"{#53D26F\" + this.algorithmSpecificData[\"hospitalCapacity\"][proposeeLastChar] + \"}\";\r\n      }\r\n\r\n      this.update(7, {\"%resident%\": resident.name, \"%hospital%\": hospital.name});\r\n      resident.match[0] = hospital;\r\n      hospital.match.push(resident);\r\n  }\r\n\r\n  removeRuledOutPreferences(resident: Agent, hospital: Hospital): void {\r\n\r\n    this.update(8, {\"%resident%\": resident.name, \"%hospital%\": hospital.name});\r\n\r\n      if (hospital.match.length >= hospital.availableSpaces) {\r\n          let worstResident: Agent = this.getWorstResident(hospital);\r\n          let worstResidentPosition: number = this.findPositionInMatches(hospital, worstResident);\r\n\r\n          this.update(9, {\"%hospital%\": hospital.name, \"%worstResident%\": worstResident.name});\r\n\r\n          let hospitalRankingClearCounter: number = worstResidentPosition + 1;\r\n\r\n      // for each successor h' of h on r's list {\r\n          for (let i = worstResidentPosition + 1; i < hospital.ranking.length; i++) {\r\n\r\n              let hospitalPosition: number = this.findPositionInMatches(hospital.ranking[i], hospital);\r\n              this.relevantPreferences.push(this.getLastCharacter(hospital.ranking[i].name));\r\n\r\n              this.update(10, {\"%hospital%\": hospital.name, \"%nextResident%\": hospital.ranking[i].name});\r\n\r\n              this.changePreferenceStyle(this.group1CurrentPreferences, this.getLastCharacter(hospital.ranking[i].name), this.originalGroup1CurrentPreferences.get(this.getLastCharacter(hospital.ranking[i].name)).findIndex(h => h == this.getLastCharacter(hospital.name)), \"grey\");\r\n\r\n              this.changePreferenceStyle(this.group2CurrentPreferences, this.getLastCharacter(hospital.name), hospitalRankingClearCounter, \"grey\");\r\n              hospital.ranking[i].ranking.splice(hospitalPosition, 1);\r\n  \r\n              // remove h' and r from each other's lists\r\n              this.update(11, {\"%hospital%\": hospital.name, \"%nextResident%\": hospital.ranking[i].name});\r\n\r\n              hospital.ranking.splice(i, 1);\r\n              i -= 1;\r\n              \r\n              hospitalRankingClearCounter++;\r\n\r\n              this.relevantPreferences.pop();\r\n\r\n          }\r\n\r\n      }\r\n\r\n  }\r\n\r\n\r\n  shouldContinueMatching(hospital: Hospital): boolean {\r\n      return true;\r\n  }\r\n\r\n\r\n\r\n}","import { Injectable } from '@angular/core';\r\nimport { EgsOneToMany } from '../../abstract-classes/EgsOneToMany';\r\nimport { Agent } from '../../interfaces/Agent';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class EgsStableMarriageService extends EgsOneToMany {\r\n\r\n  group1Name = \"man\";\r\n  group2Name = \"woman\";\r\n\r\n  shouldContinueMatching(currentAgent: Agent): boolean {\r\n      return true;\r\n  }\r\n\r\n  getNextPotentialProposee(currentAgent: Agent): Agent {\r\n      return currentAgent.ranking[0];\r\n  }\r\n  \r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { GaleShapley } from '../../abstract-classes/GaleShapley';\r\nimport { Agent } from '../../interfaces/Agent';\r\nimport { AlgorithmData } from '../../interfaces/AlgorithmData';\r\nimport { Man } from '../../interfaces/Man';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class GsStableMarriageService extends GaleShapley {\r\n\r\n  group1Name = \"man\";\r\n  group2Name = \"woman\";\r\n\r\n  group1Agents: Map<String, Man> = new Map();\r\n\r\n\r\n  generateAgents() {\r\n      for (let i = 1; i < this.numberOfAgents + 1; i++) {\r\n          let group1AgentName = this.group1Name + i;\r\n\r\n          this.group1Agents.set(group1AgentName, {\r\n              name: group1AgentName,\r\n              match: new Array(),\r\n              ranking: new Array(),\r\n              lastProposed: 0\r\n          });\r\n\r\n          this.freeAgentsOfGroup1.push(group1AgentName);\r\n\r\n      }\r\n\r\n      let currentLetter = 'A';\r\n\r\n      for (let i = 1; i < this.numberOfGroup2Agents + 1; i++) {\r\n          let group2AgentName = this.group2Name + currentLetter;\r\n\r\n          this.group2Agents.set(group2AgentName, {\r\n              name: group2AgentName,\r\n              match: new Array(),\r\n              ranking: new Array(),\r\n          });\r\n\r\n          currentLetter = String.fromCharCode((((currentLetter.charCodeAt(0) + 1) - 65 ) % 26) + 65);\r\n      }\r\n\r\n  }\r\n\r\n\r\n  match(): AlgorithmData {\r\n      this.update(1);\r\n  \r\n      // console.log(\"\\n\\nAlgorithm Steps:\");\r\n\r\n    //   console.log(\"Here\", this.group1Agents)\r\n    //   console.log(this.getGroupRankings(this.group1Agents))\r\n  \r\n      // 2: while some man m is free do\r\n      while (this.freeAgentsOfGroup1.length > 0) {\r\n\r\n          this.currentlySelectedAgents = [];\r\n          this.relevantPreferences = [];\r\n        \r\n          let man: Man = this.group1Agents.get(this.freeAgentsOfGroup1[0]);\r\n          this.relevantPreferences.push(man[\"name\"].substring(3));\r\n          this.currentlySelectedAgents.push(man[\"name\"].substring(3));\r\n\r\n        //   console.log(\"in loop\", man.name)\r\n\r\n          this.update(2, {\"%man%\": man.name});\r\n          // console.log(\"-------\");\r\n\r\n          // 3: w = most preferred woman on m’s list to which he has not yet proposed;\r\n          let woman: Agent = man.ranking[man.lastProposed];\r\n\r\n          this.currentlySelectedAgents.push(woman[\"name\"].substring(5));\r\n          this.relevantPreferences.push(woman[\"name\"].substring(5));\r\n\r\n          let redLine = [man[\"name\"].substring(3), woman[\"name\"].substring(5), \"red\"];\r\n          this.currentLines.push(redLine);\r\n    \r\n          let greenLine = [];\r\n    \r\n        //   console.log(\"change...\", woman[\"name\"].substring(5), this.findPositionInMatches(woman, man), \"red\")\r\n\r\n          this.changePreferenceStyle(this.group2CurrentPreferences, woman[\"name\"].substring(5), this.findPositionInMatches(woman, man), \"red\");\r\n          this.changePreferenceStyle(this.group1CurrentPreferences, man[\"name\"].substring(3), this.findPositionInMatches(man, woman), \"red\");\r\n\r\n          this.update(3, {\"%woman%\": woman.name, \"%man%\": man.name});\r\n\r\n          // console.log(\"Man: \" + man[\"name\"]);\r\n          // console.log(\"Woman: \" + woman[\"name\"]);\r\n\r\n          man.lastProposed += 1;\r\n          // man[\"ranking\"].shift();\r\n          this.update(4, {\"%woman%\": woman.name});\r\n\r\n          if (woman.match.length <= 0) {\r\n              // console.log(woman[\"name\"] + \" was free, so matching her with \" + man[\"name\"]);\r\n              woman.match.splice(0, 1);\r\n              woman.match.push(man);\r\n              man.match[0] = woman;\r\n              this.freeAgentsOfGroup1.shift();\r\n\r\n              // colour preferences (for when a partner is instantly selected)\r\n              this.changePreferenceStyle(this.group2CurrentPreferences, woman[\"name\"].substring(5), this.findPositionInMatches(woman, man), \"green\");\r\n              this.changePreferenceStyle(this.group1CurrentPreferences, man[\"name\"].substring(3), this.findPositionInMatches(man, woman), \"green\");\r\n\r\n              this.removeArrayFromArray(this.currentLines, redLine);\r\n              // this.currentLines = this.currentLines.filter(arr => arr[0] != redLine[0] && arr[1] != redLine[1] && arr[2] != redLine[2]);\r\n              greenLine = [man[\"name\"].substring(3), woman[\"name\"].substring(5), \"green\"];\r\n              this.currentLines.push(greenLine);\r\n\r\n              this.update(5, {\"%woman%\": woman.name, \"%man%\": man.name});\r\n          } else {\r\n              this.relevantPreferences.push(woman.match[0].name.substring(3));\r\n              this.update(6, {\"%woman%\": woman.name, \"%man%\": man.name, \"%match%\": woman.match[0].name})\r\n              let manName = man.name;\r\n              this.changePreferenceStyle(this.group2CurrentPreferences, woman[\"name\"].substring(5), this.findPositionInMatches(woman, man), \"red\");\r\n              // console.log(\"Index of current match (\" + woman[\"match\"][\"name\"] + \"): \" + woman[\"ranking\"].findIndex(((man: { name: string; }) => man.name == woman[\"match\"][\"name\"])));\r\n              // console.log(\"Index of man (\" + man[\"name\"] + \"): \" + woman[\"ranking\"].findIndex(((man: { name: string; }) => man.name == manName)) );\r\n              this.update(7, {\"%woman%\": woman.name, \"%man%\": man.name, \"%match%\": woman.match[0].name})\r\n\r\n              \r\n\r\n              if (woman.ranking.findIndex(((man: { name: string; }) => man.name == woman.match[0].name)) > woman.ranking.findIndex(((man: { name: string; }) => man.name == manName))) {\r\n\r\n                  this.changePreferenceStyle(this.group2CurrentPreferences, woman[\"name\"].substring(5), this.findPositionInMatches(woman, woman[\"match\"][0]), \"grey\");\r\n                  this.changePreferenceStyle(this.group1CurrentPreferences, woman.match[0].name.substring(3), this.findPositionInMatches(woman.match[0], woman), \"grey\");\r\n                  this.changePreferenceStyle(this.group2CurrentPreferences, woman[\"name\"].substring(5), this.findPositionInMatches(woman, man), \"green\");\r\n      \r\n                  this.removeArrayFromArray(this.currentLines, redLine);\r\n                  this.removeArrayFromArray(this.currentLines, [woman.match[0].name.substring(3), woman[\"name\"].substring(5), \"green\"]);\r\n\r\n                  // console.log(woman[\"name\"] + \" prefers \" + man[\"name\"] + \" (current match) to \" + woman[\"match\"][\"name\"] + \" (\" + woman[\"match\"][\"name\"] + \" is free, \" + man[\"name\"] + \" engaged to \" + woman[\"name\"] + \")\");\r\n                  let match: string = woman.match[0].name;\r\n\r\n                  this.freeAgentsOfGroup1.push(match);\r\n                  woman.match[0] = man;\r\n\r\n                  greenLine = [man[\"name\"].substring(3), woman[\"name\"].substring(5), \"green\"];\r\n                  this.currentLines.push(greenLine);\r\n        \r\n                  this.changePreferenceStyle(this.group1CurrentPreferences, man[\"name\"].substring(3), this.findPositionInMatches(man, woman), \"green\");        \r\n\r\n                  this.freeAgentsOfGroup1.shift();\r\n                  this.update(8, {\"%woman%\": woman.name, \"%man%\": man.name, \"%match%\": match})\r\n              } else {\r\n                  this.changePreferenceStyle(this.group1CurrentPreferences, man[\"name\"].substring(3), this.findPositionInMatches(man, woman), \"grey\");\r\n                  this.changePreferenceStyle(this.group2CurrentPreferences, woman[\"name\"].substring(5),this.findPositionInMatches(woman, man), \"grey\");\r\n                  // this.currentLines = this.currentLines.filter(arr => arr[0] != redLine[0] && arr[1] != redLine[1] && arr[2] != redLine[2]);\r\n                  this.removeArrayFromArray(this.currentLines, redLine);\r\n                  this.update(9, {\"%woman%\": woman.name, \"%man%\": man.name, \"%match%\": woman.match[0].name})\r\n\r\n                  // console.log(woman[\"name\"] + \" prefers \" + woman[\"match\"][\"name\"] + \" to \" + man[\"name\"] + \" (no change)\");\r\n                  this.update(10);\r\n\r\n              }\r\n          }\r\n      }\r\n  \r\n      // let matches = this.generateMatches();\r\n  \r\n      this.currentlySelectedAgents = [];\r\n      this.relevantPreferences = [];\r\n\r\n      this.update(11);\r\n\r\n      for (let woman of Array.from(this.group2Agents.values())) {\r\n          woman.match[0].match[0] = woman;\r\n      }\r\n  \r\n      return;\r\n  }\r\n\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { StableRoomMates } from '../../abstract-classes/StableRoomMates';\r\nimport { Agent } from '../../interfaces/Agent';\r\nimport { AlgorithmData } from '../../interfaces/AlgorithmData';\r\nimport { Man } from '../../interfaces/Man';\r\nimport { Person } from '../../interfaces/Person';\r\n\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class StableRoomIrvService extends StableRoomMates {\r\n\r\n  group1Name = \"p\";\r\n  group2Name = \"Other\";\r\n\r\n  group1Agents: Map<String, Person> = new Map();\r\n\r\n  personkey = {}\r\n\r\n  generateAgents() {\r\n\r\n    // make each person \r\n    for (let i = 1; i < this.numberOfAgents + 1; i++) {\r\n      let group1AgentName = this.group1Name + i;\r\n\r\n      this.group1Agents.set(group1AgentName, {\r\n          name: group1AgentName,\r\n          match: new Array(),\r\n          ranking: new Array(),\r\n          lastProposed: null\r\n      });\r\n\r\n      this.freeAgentsOfGroup1.push(group1AgentName);\r\n\r\n  }\r\n\r\n  // fill data structures for group2 - Other - might not be used\r\n  let currentLetter = 'A';\r\n\r\n  for (let i = 1; i < this.numberOfGroup2Agents + 1; i++) {\r\n    let group2AgentName = this.group2Name + currentLetter;\r\n\r\n    this.group2Agents.set(group2AgentName, {\r\n        name: group2AgentName,\r\n        match: new Array(),\r\n        ranking: new Array(),\r\n    });\r\n\r\n    this.personkey[String(i)] = String(i);\r\n\r\n    currentLetter = String.fromCharCode((((currentLetter.charCodeAt(0) + 1) - 65 ) % 26) + 65);\r\n    }\r\n\r\n    this.algorithmSpecificData[\"SR\"] = true;\r\n\r\n  }\r\n\r\n  ///////////////////////////////////////////////////\r\n\r\n\r\n  constructor() { \r\n    \r\n    super();\r\n    // console.log(\"Super call\");\r\n\r\n\r\n  }\r\n  ///////////////////////////////////////////////////\r\n\r\n\r\n  // checks is anyone is assigned to a person, returns assigned person if true, null otherwise \r\n  assign_check(assinged: String) {\r\n\r\n    // console.log(\"---Assing Check---\")\r\n\r\n    for (let [key, person] of this.group1Agents.entries()){\r\n\r\n      // if assigned then \r\n      if (person.lastProposed != null){\r\n        if (person.lastProposed.name == assinged){\r\n          // console.log(\"assigned\", person.lastProposed.name, key)\r\n          return key\r\n        }\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  // makes sure noone is assigned to person \"free\"\r\n  // loop through all people - if they are - assign them to null\r\n  free(person_free: String){\r\n\r\n    // console.log(\"---Free Person---\")\r\n\r\n    for (let [key, person] of this.group1Agents.entries()){\r\n\r\n      // if assigned then set to null\r\n      if (person.lastProposed != null){\r\n        if (person.lastProposed.name == person_free){\r\n\r\n          //free a \r\n          this.update(8, {\"%old_person%\" : person.name, \"%selected%\" : person_free})\r\n\r\n          this.removePersonFromArray(this.currentLines, this.getLastCharacter(person.name))\r\n          // add new free person to list \r\n          this.freeAgentsOfGroup1.push(this.getLastCharacter(person.name))\r\n          person.lastProposed = null;\r\n          // console.log(this.group1Agents);\r\n\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  // del agent1 from agent2 ranking \r\n  // del agent2 from agent1 ranking \r\n  delete_pair(agent1, agent2){\r\n\r\n    // console.log(\"---Delete---\");\r\n\r\n    let agent1index = agent2.ranking.indexOf(agent1);\r\n    if (agent1index != -1){\r\n      // console.log(\"Delete --- \", agent1.name, \" From \", agent2.name);\r\n      agent2.ranking.splice(agent1index, 1);\r\n    \r\n    }\r\n  \r\n    let agent2index = agent1.ranking.indexOf(agent2);\r\n    if (agent2index != -1){\r\n      // console.log(\"Delete --- \", agent2.name, \" From \", agent1.name);\r\n      agent1.ranking.splice(agent2index, 1);\r\n    }\r\n\r\n    // grey out elms from visual lists\r\n    this.changePreferenceStyle(\r\n      this.group1CurrentPreferences,\r\n      this.getLastCharacter(agent1.name), \r\n      this.originalGroup1CurrentPreferences.get(this.getLastCharacter(agent1.name)).indexOf(this.getLastCharacter(agent2.name)), \r\n      \"grey\")\r\n\r\n      this.changePreferenceStyle(\r\n      this.group1CurrentPreferences,\r\n      this.getLastCharacter(agent2.name), \r\n      this.originalGroup1CurrentPreferences.get(this.getLastCharacter(agent2.name)).indexOf(this.getLastCharacter(agent1.name)), \r\n      \"grey\")\r\n\r\n\r\n  }\r\n\r\n  print_rankings(agent){\r\n\r\n    for (let i = 0 ; i < agent.ranking.length ; i++){\r\n      console.log(\"Element\", i, agent.ranking[i])\r\n    }\r\n  }\r\n\r\n  \r\n  // returns a map of agents that are free - not assigned to anyone \r\n  check_free_agents(){\r\n\r\n    let free_agents: Map<String, Person> = new Map();\r\n\r\n    for (let [key, person] of this.group1Agents.entries()){\r\n\r\n      // if assigned then \r\n      if (person.lastProposed == null){\r\n        free_agents.set(key, person);\r\n      }\r\n    }\r\n    return free_agents;\r\n  }\r\n\r\n  // returns a list of the agent keys that have more than one preferance \r\n  check_pref_count(){\r\n\r\n    let agents_multiple_prefs: Map<String, Person> = new Map();\r\n\r\n    for (let [key, person] of this.group1Agents.entries()){\r\n\r\n      // if person has more than one person in their ranking \r\n      if (person.ranking.length > 1){\r\n        agents_multiple_prefs.set(key, person);\r\n        // console.log(\"Agent with multiple prefs\", key, person.ranking.length)\r\n      }\r\n    }\r\n    return agents_multiple_prefs;\r\n  }\r\n\r\n  // checks if any preferance lists are empty\r\n  check_pref_list_empty(){\r\n\r\n    let free_agents: Map<String, Person> = new Map();\r\n    \r\n\r\n    for (let [key, person] of this.group1Agents.entries()){\r\n\r\n      if (person.ranking.length < 1){\r\n        return true\r\n      }\r\n    }\r\n    return false;\r\n\r\n  }\r\n\r\n  // returns a persons ranking as a string \r\n  objs_toString(ranking){\r\n    let s = \"\";\r\n\r\n    // go through each ranking and add to string \r\n    for (let person of ranking){\r\n      s = s + person.name;\r\n      s = s + \", \";\r\n    }\r\n\r\n    // remove extra comma added before \r\n    s = s.slice(0 , -2)\r\n    return s \r\n  }\r\n\r\n  match(): AlgorithmData {\r\n\r\n\r\n    // console.log(\"Start\")\r\n    // console.log(this.group1Agents)\r\n    \r\n    \r\n\r\n    let free_agents: Map<String, Person> = new Map();\r\n    free_agents = this.check_free_agents();\r\n\r\n    // Set each person to be free\r\n    this.update(1);\r\n\r\n    console.log(\"--- new info ---\")\r\n    console.log(\"Matches\")\r\n    for (let [key, person] of free_agents.entries()){\r\n      let x = [];\r\n      for (let p of person.ranking){\r\n        x.push(p.name)\r\n      }\r\n      console.log(x)\r\n    }\r\n\r\n    \r\n\r\n\r\n    let last_person = null\r\n    let last_pref = null\r\n\r\n    let count = 0\r\n    \r\n    while (free_agents.size > 0) {\r\n\r\n      this.currentlySelectedAgents = [];\r\n      this.relevantPreferences = [];\r\n\r\n      // console.log(\"match.irv\");\r\n      // console.log(this.group1Agents);\r\n      // console.log(this.group2Agents);\r\n\r\n      let redLine = [\"1\", \"B\", \"red\"]\r\n\r\n      //loop through each agent in the list \r\n      for (let [key, person] of free_agents.entries()){\r\n\r\n        //While some person p is free (not assigned to someone)\r\n        this.update(2, {\"%person%\" : person.name})\r\n            \r\n        //let person: Person = this.group1Agents.get(this.freeAgentsOfGroup1[0]);\r\n        // console.log(\"------------------\")\r\n        // console.log(person);\r\n        // console.log(person.name);\r\n        // console.log(person.ranking);\r\n        // console.log(person.match);\r\n        // console.log(person.lastProposed);\r\n\r\n        \r\n        //if person p has a empty preferance list\r\n        this.update(3, {\"%person%\" : person.name})\r\n\r\n        // if there is no more preferances for a agent - no stable matchong exists\r\n        if (person.ranking.length < 1){\r\n          console.log(\"NO STABLE MATHCING - empty preferance list\")\r\n\r\n          //end - no stable mathcing\r\n                    this.update(4)\r\n\r\n          // if stable == true then regenerate \r\n          if (this.SRstable){\r\n            console.log(\"ReRun\")\r\n            this.run(this.numberOfAgents, this.numberOfGroup2Agents, null, this.SRstable)\r\n          }\r\n\r\n         \r\n          return;\r\n        }\r\n\r\n       \r\n        // change prevouis highlights back to black \r\n        if (last_person != null){\r\n          this.changePreferenceStyle(\r\n                    this.group1CurrentPreferences,\r\n                    this.getLastCharacter(last_person.name), \r\n                    last_pref,\r\n                    \"black\")\r\n        }\r\n\r\n        \r\n        // store prevouis person\r\n        last_person = person\r\n        last_pref = this.originalGroup1CurrentPreferences.get(this.getLastCharacter(person.name)).indexOf(this.getLastCharacter(person.ranking[0].name)), \r\n\r\n\r\n        //highlight pref in persons list \r\n        this.changePreferenceStyle(\r\n          this.group1CurrentPreferences,\r\n          this.getLastCharacter(person.name), \r\n          this.originalGroup1CurrentPreferences.get(this.getLastCharacter(person.name)).indexOf(this.getLastCharacter(person.ranking[0].name)), \r\n          \"red\")\r\n\r\n        //person b := first preferance on p's list\r\n        this.update(5, {\"%person%\" : person.name, \"%selected%\" : person.ranking[0].name})\r\n\r\n        let pref = person.ranking[0];\r\n        // console.log(\"Pref check --- \", person.name, pref.name, person.ranking)\r\n\r\n        redLine = [this.getLastCharacter(person.name), this.personkey[this.getLastCharacter(pref.name)], \"red\"]\r\n        this.currentLines.push(redLine)\r\n\r\n        // update free agents - remove first elm\r\n        this.freeAgentsOfGroup1.shift()\r\n\r\n        //assign p to b\r\n        this.update(6, {\"%person%\" : person.name, \"%selected%\" : pref.name})\r\n\r\n        //if someone is assigned to their most prefered person, then unassign them and assign current agent to them \r\n        let check = this.assign_check(pref.name);\r\n\r\n        // if any person a is assigned to person b\r\n        this.update(7, {\"%person%\" : person.name, \"%selected%\" : pref.name})\r\n        \r\n\r\n        if (check != null){\r\n          this.free(pref.name);\r\n\r\n          //free a \r\n          //this.update(8) -- done in function \r\n        \r\n        }\r\n\r\n        person.lastProposed = pref;\r\n        \r\n\r\n        this.update(9, {\"%person%\" : person.name, \"%selected%\" : pref.name, \"%list%\" : this.objs_toString(pref.ranking)})\r\n        // loop through ranking \r\n        while (true){\r\n\r\n          //get last elm of ranking\r\n          let remove = pref.ranking.slice(-1)[0]\r\n\r\n          // if elm is the current person then stop\r\n          if (remove.name == person.name){\r\n            break;\r\n          }\r\n\r\n          //delele elm from pref ranking list\r\n          // delete perd from elm ranking list \r\n          // console.log(\"del\", remove.name, pref.name)\r\n          this.delete_pair(pref, remove)\r\n\r\n\r\n          \r\n\r\n           // for each person c less preferded than p on b's, preferance list\r\n          this.update(10, {\"%person%\" : person.name, \"%removee%\" : remove.name})\r\n\r\n\r\n        }\r\n\r\n\r\n        //person.ranking = person.ranking.slice(0, 3);\r\n        // console.log(\"Before\", free_agents);\r\n        free_agents = this.check_free_agents();\r\n        // console.log(\"After\", free_agents);\r\n\r\n      }\r\n      \r\n      // console.log(\"ENDER\")\r\n      // for (let data of this.group1Agents.values()){\r\n      //   console.log(data.name, \" ---> \", data.lastProposed, data.ranking)\r\n      // }\r\n\r\n\r\n      // Place holder \r\n      // need to re-generate smaples to give stable mathcing \r\n      // OR leave in, in some form to show not everything has a stable matching \r\n      count++;\r\n      if (count > 100){\r\n        console.log(\"No Stable Mathcing\")\r\n        return;\r\n      }\r\n\r\n\r\n  }\r\n\r\n\r\n  // fix last highlights number \r\n  this.changePreferenceStyle(\r\n    this.group1CurrentPreferences,\r\n    this.getLastCharacter(last_person.name), \r\n    last_pref,\r\n    \"black\")\r\n\r\n  let agents_multiple_prefs = this.check_pref_count()\r\n\r\n \r\n\r\n\r\n\r\n\r\n\r\n  ////// PAHSE 2\r\n  \r\n  // while there are agents that have more than 1 person in their prefrance list \r\n\r\n\r\n  let finished_people = []\r\n\r\n  while (agents_multiple_prefs.size > 0) {\r\n    // console.log(\"There is agents with multiple prefs\")\r\n    // console.log(agents_multiple_prefs)\r\n    \r\n\r\n    //loop through those^ agents\r\n    for (let [key, person] of agents_multiple_prefs.entries()){\r\n\r\n      // While some person p has more than 1 preferance left\r\n      this.update(11, {\"%person%\" : person.name, \"%list%\" : this.objs_toString(person.ranking)}) \r\n\r\n      // look for rotations in perosn p's preferance list \r\n      this.update(12, {\"%person%\" : person.name})\r\n\r\n      let rotation_pairs = []\r\n\r\n      console.log(\"Checking poeple left\", agents_multiple_prefs)        \r\n\r\n      console.log(person.name)\r\n      console.log(person.ranking)\r\n\r\n      let starting_agent = person                               // starting person\r\n      let second_pref = person.ranking[1]                       //the starting persons second prefered person\r\n      let last_pref = second_pref.ranking.slice(-1)[0]          //the second preferned persons last preferd person\r\n\r\n\r\n      // list of pairs to call delete on\r\n      rotation_pairs.push([last_pref, second_pref])\r\n\r\n\r\n      // Loop until there is a loop through people until back to the starting person\r\n\r\n      let counter = 0\r\n      while (starting_agent != last_pref){\r\n        // console.log(\"adding pairs \")  \r\n        counter++\r\n\r\n        // stops infinite loops - break if there is no cycle through all the people \r\n        if (counter > agents_multiple_prefs.size){\r\n          break;\r\n        }\r\n\r\n        // console.log(\"HERE\")\r\n        // console.log(second_pref)\r\n        // console.log(last_pref)\r\n\r\n        // console.log(\"last_pref\", last_pref)\r\n\r\n        second_pref = agents_multiple_prefs.get(last_pref.name).ranking[1]    // update to be second pref of last_pref\r\n        last_pref = second_pref.ranking.slice(-1)[0]                          // update like above with new second_pref\r\n\r\n        // add to list \r\n        rotation_pairs.push([last_pref, second_pref])         \r\n\r\n      }\r\n\r\n      // if rotation r is found\r\n      this.update(13, {\"%rotation%\" : this.objs_toString(rotation_pairs)}) // temp remove %rotation%\r\n\r\n      // console.log(\"Found rotation\", rotation_pairs)\r\n\r\n      let deleted_pairs = []\r\n      for (let pair = 0  ; pair < rotation_pairs.length ; pair++ ){\r\n        // console.log(\"looping dels\")\r\n\r\n        // if pair not already deleted \r\n        if (!deleted_pairs.includes(rotation_pairs[pair])){\r\n          // console.log(\"deleting\", rotation_pairs[pair])\r\n          \r\n          this.delete_pair(rotation_pairs[pair][0], rotation_pairs[pair][1])\r\n          deleted_pairs.push(rotation_pairs[pair])\r\n\r\n          // delete pairs in rotation r\r\n          this.update(14, {\"%person%\" : rotation_pairs[pair][1].name, \"%removee%\" : rotation_pairs[pair][0].name})\r\n\r\n          // update lines \r\n\r\n          for (let [key_inner, person_inner] of this.group1Agents.entries()){\r\n\r\n            if (person_inner.ranking.length == 1 && !finished_people.includes(person_inner.name)){\r\n\r\n              // remove lines starting from person_inner\r\n              this.removePersonFromArray(this.currentLines, this.getLastCharacter(person_inner.name))\r\n\r\n              // this.free(person_inner.lastProposed.name)\r\n\r\n              // HERE ^^^ WORKIGN ON UPDATEING FREE LIST IN PHASE 2 - ISSUE: DONT KNOW WHO GETS UNASSIGNED WHEN SOMEONE IS SET TO FREE, COULD LOOP AND CHECK ALL, \r\n\r\n              // add the \r\n              // this.freeAgentsOfGroup1.push(person_inner.lastProposed.name)\r\n\r\n              // let person_inner propose to their last remaining person\r\n              person_inner.lastProposed = person_inner.ranking.slice(0)[0]\r\n              \r\n              // remove lines going to their new proposal\r\n              this.removeTargetFromArray(this.currentLines, this.personkey[this.getLastCharacter(person_inner.lastProposed.name)])\r\n              // with lines are green early, without overlapping reds \r\n              this.removePersonFromArray(this.currentLines, this.personkey[this.getLastCharacter(person_inner.lastProposed.name)])\r\n\r\n              // update value in list \r\n              this.changePreferenceStyle(\r\n                this.group1CurrentPreferences,\r\n                this.getLastCharacter(person_inner.name), \r\n                this.originalGroup1CurrentPreferences.get(this.getLastCharacter(person_inner.name)).indexOf(this.getLastCharacter(person_inner.ranking[0].name)), \r\n                \"green\")\r\n\r\n              // draw line to new proposal from, to, colour\r\n              let line = [this.getLastCharacter(person_inner.name), this.personkey[this.getLastCharacter(person_inner.lastProposed.name)], \"green\"]\r\n              this.currentLines.push(line)\r\n\r\n              // add person to finished person list \r\n              finished_people.push(person)\r\n\r\n\r\n            }\r\n    \r\n          }\r\n\r\n        } else {\r\n          // everything deleted \r\n          // update \r\n         \r\n          break;\r\n        }\r\n\r\n      }\r\n\r\n\r\n      // conditions to end if stable matching is found \r\n      agents_multiple_prefs = this.check_pref_count()\r\n      // console.log(\"checking number of agents with multiple preferances\")\r\n      // console.log(agents_multiple_prefs)\r\n\r\n      if (agents_multiple_prefs.size < 1) {\r\n        break;\r\n      }\r\n\r\n      // if a person b has 1 perferance left\r\n      this.update(15)\r\n\r\n      // update preferancees \r\n      for (let [key_inner, person_inner] of this.group1Agents.entries()){\r\n\r\n        if (person_inner.ranking.length == 1){\r\n\r\n         \r\n\r\n          person_inner.lastProposed = person_inner.ranking.slice(0)[0]\r\n          let line = [this.getLastCharacter(person_inner.name), this.personkey[this.getLastCharacter(person_inner.lastProposed.name)], \"green\"]\r\n          // let line = [\"1\", \"B\", \"green\"]\r\n          // this.currentLines.push(line)\r\n\r\n          // person b := last preferance\r\n          this.update(16, {\"%person%\" : person_inner.name, \"%preferance%\" : person_inner.lastProposed.name})\r\n\r\n        }\r\n\r\n      }\r\n\r\n      // if any people have empty preferance lists - no mathcong\r\n      this.update(17, {\"%person%\" : person.name})\r\n\r\n      if (this.check_pref_list_empty() == true) {\r\n\r\n        // end - no stable matching\r\n        this.update(18)\r\n\r\n        console.log(\"No Stable matching\")\r\n        \r\n        // if stable == true then regenerate \r\n        if (this.SRstable){\r\n          console.log(\"ReRun\")\r\n          this.run(this.numberOfAgents, this.numberOfGroup2Agents, null, this.SRstable)\r\n        }\r\n\r\n       \r\n        return;\r\n      }\r\n\r\n      // needed to rest the for loop for the new values within the many_pref_list\r\n      // this list is updated to remove people that no longer have many preferances \r\n      // ^ \r\n      break;\r\n\r\n    }\r\n  }\r\n\r\n  // if PHASE 2 is not done - update viz\r\n  if (agents_multiple_prefs.size == 0) {\r\n    for (let [key_inner, person_inner] of this.group1Agents.entries()){\r\n      if (person_inner.ranking.length == 1){\r\n\r\n       // update value in list \r\n       this.changePreferenceStyle(\r\n        this.group1CurrentPreferences,\r\n        this.getLastCharacter(person_inner.name), \r\n        this.originalGroup1CurrentPreferences.get(this.getLastCharacter(person_inner.name)).indexOf(this.getLastCharacter(person_inner.ranking[0].name)), \r\n        \"green\")\r\n        \r\n        this.removePersonFromArray(this.currentLines, this.getLastCharacter(person_inner.name))\r\n\r\n        this.removeTargetFromArray(this.currentLines, this.personkey[this.getLastCharacter(person_inner.lastProposed.name)])\r\n\r\n\r\n        person_inner.lastProposed = person_inner.ranking.slice(0)[0]\r\n        let line = [this.getLastCharacter(person_inner.name), this.personkey[this.getLastCharacter(person_inner.lastProposed.name)], \"green\"]\r\n        // let line = [\"1\", \"B\", \"green\"]\r\n        this.currentLines.push(line)\r\n      }\r\n    }\r\n  }\r\n\r\n  this.update(19)\r\n  // console.log(\"group1agents at end\", this.group1Agents, agents_multiple_prefs)\r\n  \r\n  // if stable == false then regenerate - until a unstable instance is found  \r\n  // if (!this.SRstable){\r\n  //   this.run(this.numberOfAgents, this.numberOfGroup2Agents, null, this.SRstable)\r\n  // }\r\n\r\n  return;\r\n\r\n  }\r\n}\r\n\r\n//end text + viz not quite right, text not mathcing with viz but still is with what is happening \r\n","import { Component, Input, OnInit } from '@angular/core';\r\nimport { AlgorithmRetrievalService } from 'src/app/algorithm-retrieval.service';\r\nimport { PlaybackService } from '../../services/playback/playback.service';\r\n\r\n@Component({\r\n  selector: 'agent-titles',\r\n  templateUrl: './agent-titles.component.html',\r\n  styleUrls: ['./agent-titles.component.scss']\r\n})\r\nexport class AgentTitlesComponent implements OnInit {\r\n\r\n  @Input() showCode: boolean;\r\n\r\n  constructor(public algorithmService: AlgorithmRetrievalService, public playback: PlaybackService) { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n}\r\n","<div class=\"d-flex justify-content-around flex-wrap flex-md-nowrap align-items-center\" style=\"height:120px; border-bottom: 1px solid rgba(184, 184, 184, 0.658);\">\r\n    <h1 id=\"lhsName\" class=\"h2 mt-3\">{{ this.algorithmService.pluralMap.get(this.algorithmService.currentAlgorithm.orientation[0]) }}</h1>\r\n\r\n    <div class=\"row text-center border-bottom mr-3\" style=\"position: fixed; height:114px; width: 350px;\" *ngIf=\"this.showCode\">\r\n      <h3 class=\"col h2 sidebarPopover my-auto text-center\" style=\"font-weight: 400; font-size: 1vw; line-height: 1.5vw;\">{{ this.playback.description }}</h3>\r\n    </div>\r\n\r\n    <h1 id=\"rhsName\" class=\"h2 mt-3\">{{ this.algorithmService.pluralMap.get(this.algorithmService.currentAlgorithm.orientation[1]) }}</h1>\r\n</div>","import { Component, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-animation-container',\r\n  templateUrl: './animation-container.component.html',\r\n  styleUrls: ['./animation-container.component.scss']\r\n})\r\nexport class AnimationContainerComponent implements OnInit {\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n}\r\n","import { Component, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-canvas-display',\r\n  templateUrl: './canvas-display.component.html',\r\n  styleUrls: ['./canvas-display.component.scss']\r\n})\r\nexport class CanvasDisplayComponent implements OnInit {\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n}\r\n","import { Component, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-animation-guide-dialog',\r\n  templateUrl: './animation-guide-dialog.component.html',\r\n  styleUrls: ['./animation-guide-dialog.component.scss']\r\n})\r\nexport class AnimationGuideDialogComponent implements OnInit {\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n}\r\n","<h1 mat-dialog-title>Animation Guide</h1>\r\n<div mat-dialog-content class=\"mb-2\">\r\n    <div class=\"row mb-4\">\r\n        <div class=\"col-md-2\">\r\n            <img src=\"assets/images/greenCircle.svg\">\r\n        </div>\r\n        <div class=\"col-md-10 my-auto\">\r\n            <h3><b>Green border around circle</b>: This agent is currently selected.</h3>\r\n        </div>\r\n    </div>\r\n\r\n    <div class=\"row mb-4\">\r\n        <div class=\"col-md-5\">\r\n            <img src=\"assets/images/redLine.svg\">\r\n        </div>\r\n        <div class=\"col-md-7 my-auto\">\r\n            <h3><b>Red line between two circles</b>: 1 is currently considering proposing to A.</h3>\r\n        </div>\r\n    </div>\r\n\r\n    <div class=\"row\">\r\n        <div class=\"col-md-5\">\r\n            <img src=\"assets/images/greenLine.svg\">\r\n        </div>\r\n        <div class=\"col-md-7 my-auto\">\r\n            <h3><b>Green line between two circles</b>: 1 is provisionally assigned/engaged to A.</h3>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<div mat-dialog-action class=\"mb-2\" align=\"end\">\r\n  <button mat-button mat-dialog-close>Close</button>\r\n</div>","import { Injectable } from '@angular/core';\r\ndeclare var anime: any;  // declaring the animejs animation library for use in this file\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class AlgorithmAnimationService {\r\n\r\n  constructor() { }\r\n\r\n  loadPage(): void {\r\n    // animation for sliding the navbar down from Y-150 its position\r\n    anime({\r\n      targets: '.navbar',\r\n      easing: 'easeOutQuint',\r\n      translateY: [-150, 0],\r\n      delay: 200,\r\n      duration: 900\r\n    })\r\n\r\n    // animation for sliding the sidebar right from X-500 its position\r\n    anime({\r\n      targets: '.sidebar',\r\n      easing: 'easeInOutQuint',\r\n      translateX: [-500, 0],\r\n      delay: 270,\r\n      duration: 1000\r\n    })\r\n\r\n    // animation for fading the sidebar content in as the sidebar slides in\r\n    anime({\r\n      targets: '#sidebarContent',\r\n      easing: 'easeInOutQuint',\r\n      opacity: [0, 1],\r\n      delay: 270,\r\n      duration: 1500\r\n    })\r\n\r\n    // animation for fading the main content in as the sidebar finishes sliding in\r\n    anime({\r\n      targets: '#mainContent',\r\n      easing: 'easeInOutQuint',\r\n      opacity: [0, 1],\r\n      delay: 670,\r\n      duration: 900\r\n    })\r\n  }\r\n\r\n\r\n  goHome(): void {\r\n    anime({\r\n      targets: '.navbar',\r\n      easing: 'easeOutQuint',\r\n      translateY: [0, -150],\r\n      // opacity: [0, 1],\r\n      delay: 400,\r\n      duration: 900\r\n    })\r\n\r\n    anime({\r\n      targets: '.sidebar',\r\n      easing: 'easeInOutQuint',\r\n      translateX: [0, -500],\r\n      // opacity: [0, 1],\r\n      duration: 600\r\n    })\r\n\r\n    anime({\r\n      targets: '#sidebarContent',\r\n      easing: 'easeInOutQuint',\r\n      // translateX: [-1500, 0],\r\n      opacity: [1, 0],\r\n      duration: 600\r\n    })\r\n\r\n    anime({\r\n      targets: '#mainContent',\r\n      easing: 'easeInOutQuint',\r\n      // translateX: [-1500, 0],\r\n      opacity: [1, 0],\r\n      duration: 600\r\n    })\r\n  }\r\n\r\n\r\n  fadeCanvasOut(): void {\r\n    anime({\r\n      targets: '#myCanvas',\r\n      easing: 'easeInOutQuint',\r\n      // translateX: [-1500, 0],\r\n      opacity: [1, 0],\r\n      duration: 300\r\n    })\r\n  }\r\n\r\n  fadeCanvasIn(): void {\r\n    anime({\r\n      targets: '#myCanvas',\r\n      easing: 'easeInOutQuint',\r\n      // translateX: [-1500, 0],\r\n      opacity: [0, 1],\r\n      duration: 300\r\n    })\r\n  }\r\n\r\n\r\n  hideSidebar(): void {\r\n    anime({\r\n      targets: '.sidebar',\r\n      easing: 'easeInOutQuint',\r\n      translateX: [0, -800],\r\n      delay: 200,\r\n      duration: 700\r\n    })\r\n  }\r\n\r\n  showSidebar(): void {\r\n    anime({\r\n      targets: '.sidebar',\r\n      easing: 'easeInOutQuint',\r\n      translateX: [-500, 0],\r\n      // opacity: [0, 1],\r\n      duration: 600\r\n    })\r\n\r\n    anime({\r\n      targets: '#sidebarContent',\r\n      easing: 'easeInOutQuint',\r\n      // translateX: [-1500, 0],\r\n      opacity: [0, 1],\r\n      duration: 600\r\n    })\r\n  }\r\n\r\n\r\n  hideMainContent(): void {\r\n    anime({\r\n      targets: '#mainContent',\r\n      easing: 'easeInOutQuint',\r\n      opacity: [1, 0],\r\n      duration: 500\r\n    })\r\n  }\r\n\r\n  showMainContent(): void {\r\n    anime({\r\n      targets: '#mainContent',\r\n      easing: 'easeInOutQuint',\r\n      opacity: [0, 1],\r\n      duration: 500\r\n    })\r\n  }\r\n\r\n}\r\n","import { Component, Input, OnInit } from '@angular/core';\r\nimport { AlgorithmRetrievalService } from 'src/app/algorithm-retrieval.service';\r\nimport { PlaybackService } from '../services/playback/playback.service';\r\n\r\ndeclare var anime: any;\r\n\r\n@Component({\r\n  selector: 'code-display',\r\n  templateUrl: './code-display.component.html',\r\n  styleUrls: ['./code-display.component.scss', '../sidebar/sidebar.component.scss']\r\n})\r\nexport class CodeDisplayComponent implements OnInit {\r\n\r\n  algorithm: string;\r\n  animate: boolean = true;\r\n\r\n  constructor(public playback: PlaybackService, public algService: AlgorithmRetrievalService) { }\r\n\r\n  ngOnInit(): void {\r\n    this.algorithm = this.algService.currentAlgorithm.id;\r\n  }\r\n\r\n}\r\n","<!-- CODE TERMINAL -->\r\n<!-- <div class=\"terminal-header row justify-content-center text-center mb-0\" (click)=\"toggleExpansion()\" *ngIf=\"!(this.algorithm == '')\">\r\n    <mat-animated-icon id=\"toggleCodeButton\" class=\"playbackButton\" start=\"keyboard_arrow_down\" end=\"keyboard_arrow_up\" colorStart=\"none\" colorEnd=\"none\" [animate]=\"!this.playback.pause\"></mat-animated-icon>\r\n    <mat-animated-icon id=\"playButton\" class=\"playbackButton unselectable\" start=\"expand_less\" end=\"keyboard_arrow_up\" colorStart=\"none\" colorEnd=\"none\" [animate]=\"this.animate\"></mat-animated-icon>\r\n</div> -->\r\n<!-- <div class=\"terminal row justify-content-center align-items-center mt-0\" *ngIf=\"!(this.algorithm == '')\">\r\n    <simple-code *ngIf=\"this.algorithm == 'simple'\"></simple-code>\r\n    <gs-code *ngIf=\"this.algorithm == 'smp-man-gs'\"></gs-code>\r\n    <smp-man-egs-code  *ngIf=\"this.algorithm == 'smp-man-egs'\"></smp-man-egs-code>\r\n    <egs-resident-hs-code *ngIf=\"this.algorithm == 'hr-resident-egs'\"></egs-resident-hs-code>\r\n</div> -->\r\n\r\n<div class=\"border-bottom sidebarPopover mr-2\" style=\"background-color: #1b1f23; max-width: 100%;\" data-toggle=\"popover\" data-placement=\"left\" title=\"Code Display\" data-content=\"This highlights the current line that's being executed in the algorithm as you play or drag the playback slider.\" data-trigger=\"manual\"\r\ndata-template='<div class=\"popover fade show bs-popover-right popoverPositioning blackText\" role=\"tooltip\"><div class=\"arrow\"></div><h3 class=\"popover-header\"></h3><div class=\"popover-body\"></div></div>'>\r\n    <h1 class=\"pt-4 pl-3\" style=\"color:rgb(231, 231, 231); font-weight: 300; margin-bottom: 0; padding-bottom: 0; font-size: 1.4vw;\">\r\n        Pseudocode\r\n    </h1>\r\n\r\n    <div style=\"white-space: pre; height: 100%; vertical-align: middle; font-size: 0.8vw; line-height: 1.2vw; margin: 0; color:rgb(231, 231, 231); width: 100%\">\r\n        <ol class=\"pt-3 pb-4\" style=\"width: 100%; display: table; margin: 0; vertical-align: middle; background-color: #1b1f23; padding-left: 30px;\">\r\n            <div style=\"display: table-row; width: 100%; vertical-align: middle; margin: 0; \" *ngFor=\"let line of this.algService.currentAlgorithm.code; let i = index\" id=\"line{{i+1}}\">\r\n                <li class=\"pl-2\" style=\"vertical-align: middle; width: 100%; tab-size: 0.8vw; word-wrap: break-word; white-space: pre-wrap\">\r\n                    {{ line }}\r\n                </li>\r\n            </div>\r\n        </ol>\r\n    </div>   \r\n</div>\r\n\r\n<!-- <div style=\"position: absolute; opacity: 0;\"><gs-code *ngIf=\"this.algorithm == 'gale-shapley'\"></gs-code></div> -->","import { Component, HostListener, Inject, Input, OnInit } from '@angular/core';\r\nimport { FormControl, Validators } from '@angular/forms';\r\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { element } from 'protractor';\r\nimport { AlgorithmRetrievalService } from 'src/app/algorithm-retrieval.service';\r\nimport { CanvasService } from '../../services/canvas/canvas.service';\r\nimport { PlaybackService } from '../../services/playback/playback.service';\r\n\r\n@Component({\r\n  selector: 'app-edit-preferences-dialog',\r\n  templateUrl: './edit-preferences-dialog.component.html',\r\n  styleUrls: ['./edit-preferences-dialog.component.scss']\r\n})\r\nexport class EditPreferencesDialogComponent implements OnInit {\r\n\r\n  group1Preferences: Map<string, Array<string>> = new Map();\r\n  group2Preferences: Map<string, Array<string>> = new Map();\r\n\r\n  preferences: string = \"\";\r\n\r\n  equalGroups: boolean = false;\r\n\r\n  constructor(public algorithmService: AlgorithmRetrievalService, public playbackService: PlaybackService, public canvasService: CanvasService, public dialogRef: MatDialogRef<EditPreferencesDialogComponent>, private _snackBar: MatSnackBar) { }\r\n\r\n  @Input() algorithm: Algorithm;\r\n\r\n\r\n  numberOfGroup1Agents = new FormControl(this.algorithmService.numberOfGroup1Agents, [\r\n    Validators.required,\r\n    Validators.min(1),\r\n    Validators.max(9)\r\n  ]);\r\n\r\n  numberOfGroup2Agents = new FormControl(this.algorithmService.numberOfGroup2Agents, [\r\n    Validators.required,\r\n    Validators.min(1),\r\n    Validators.max(9)\r\n  ]);\r\n\r\n  preferencesForm: FormControl;\r\n  formString: string;\r\n  missingPreferences: Array<Array<string>>;\r\n\r\n  valid: boolean = true;\r\n\r\n  @HostListener('document:keydown.enter') \r\n  onEnter() {\r\n    if (!(this.numberOfGroup1Agents.errors && this.numberOfGroup2Agents.errors)) {\r\n      this.generateAlgorithmPreferences();\r\n    }\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.group1Preferences = this.playbackService.commandList[0][\"group1CurrentPreferences\"];\r\n    this.group2Preferences = this.playbackService.commandList[0][\"group2CurrentPreferences\"];\r\n\r\n    this.preferencesForm = new FormControl(this.preferences);\r\n\r\n    if (this.algorithmService.currentAlgorithm.equalGroups) {\r\n      this.equalGroups = true;\r\n    }\r\n\r\n    this.generatePreferenceString();\r\n    // console.log(this.formString)\r\n\r\n  }\r\n\r\n  generatePreferenceString(): void {\r\n\r\n    let preferenceString: string = this.algorithmService.pluralMap.get(this.algorithmService.currentAlgorithm.orientation[0]) + \"\\n\";\r\n    let currentLine: string = \"\";\r\n\r\n    let counter: number = 0;\r\n\r\n    this.missingPreferences = [];\r\n\r\n    if (this.equalGroups) {\r\n      this.numberOfGroup2Agents.setValue(this.numberOfGroup1Agents.value);\r\n    }\r\n\r\n    if (this.algorithmService.numberOfGroup1Agents < this.numberOfGroup1Agents.value || this.algorithmService.numberOfGroup2Agents < this.numberOfGroup2Agents.value) {\r\n\r\n      let numbersToAdd: Array<string> = [];\r\n      let lettersToAdd: Array<string> = [];\r\n\r\n      for (let i = this.algorithmService.numberOfGroup2Agents + 1; i <= this.numberOfGroup2Agents.value; i++) {\r\n        lettersToAdd.push(String.fromCharCode(i + 64));\r\n      }\r\n\r\n      for (let i = this.algorithmService.numberOfGroup1Agents + 1; i <= this.numberOfGroup1Agents.value; i++) {\r\n        numbersToAdd.push(String(i));\r\n      }\r\n\r\n      for (let agent of this.group1Preferences) {\r\n        if (Number(agent[0]) <= this.numberOfGroup1Agents.value) {\r\n          currentLine = \"\";\r\n          this.shuffle(lettersToAdd);\r\n  \r\n          let id: string = agent[0];\r\n          let newPreferences: string[] = agent[1].filter(pref => pref.charCodeAt(0) - 64 <= this.numberOfGroup2Agents.value).concat(lettersToAdd);\r\n  \r\n          currentLine = id + \": \" + newPreferences.join(\", \");\r\n    \r\n          currentLine += \"\\n\";\r\n          preferenceString += currentLine;\r\n        }\r\n      }\r\n\r\n      for (let i = this.algorithmService.numberOfGroup1Agents + 1; i <= this.numberOfGroup1Agents.value; i++) {\r\n        let newPreferences = Array.from(this.group1Preferences.values())[0].concat(lettersToAdd).filter(pref => pref.charCodeAt(0) - 64 <= this.numberOfGroup2Agents.value);\r\n        this.shuffle(newPreferences);\r\n        currentLine = i + \": \" + newPreferences.join(\", \");\r\n        currentLine += \"\\n\";\r\n        preferenceString += currentLine;\r\n      }\r\n\r\n      preferenceString += \"\\n\" + this.algorithmService.pluralMap.get(this.algorithmService.currentAlgorithm.orientation[1]) + \"\\n\";\r\n\r\n\r\n      for (let agent of this.group2Preferences) {\r\n        if (Number(agent[0].charCodeAt(0) - 64) <= this.numberOfGroup2Agents.value) {\r\n          currentLine = \"\";\r\n          this.shuffle(numbersToAdd);\r\n\r\n          let id: string = agent[0];\r\n          let newPreferences: string[] = agent[1].filter(pref => pref <= this.numberOfGroup1Agents.value).concat(numbersToAdd);\r\n\r\n          currentLine = id + \": \" + newPreferences.join(\", \");\r\n    \r\n          currentLine += \"\\n\";\r\n          preferenceString += currentLine;\r\n        }\r\n      }\r\n\r\n      // console.log(this.numberOfGroup2Agents.value);\r\n      for (let i = this.algorithmService.numberOfGroup2Agents + 1; i <= this.numberOfGroup2Agents.value; i++) {\r\n        let newPreferences = (Array.from(this.group2Preferences.values())[0].concat(numbersToAdd)).filter(pref => pref <= this.numberOfGroup1Agents.value);\r\n        this.shuffle(newPreferences);\r\n        currentLine = String.fromCharCode(i + 64) + \": \" + newPreferences.join(\", \");\r\n        currentLine += \"\\n\";\r\n        preferenceString += currentLine;\r\n      }\r\n\r\n    } else {\r\n      for (let agent of this.group1Preferences) {\r\n        currentLine = \"\";\r\n  \r\n        if (counter < this.numberOfGroup1Agents.value) {\r\n          let id: string = agent[0];\r\n          let currentPreferences: string[] = agent[1];\r\n  \r\n          let newPreferences: string[] = [];\r\n  \r\n          for (let preference of currentPreferences) {\r\n            if (preference.charCodeAt(0) - 65 < this.numberOfGroup2Agents.value) {\r\n              newPreferences.push(preference);\r\n            }\r\n          }\r\n    \r\n          currentLine = id + \": \" + newPreferences.join(\", \");\r\n  \r\n          currentLine += \"\\n\";\r\n          preferenceString += currentLine;\r\n        }\r\n  \r\n        counter++;\r\n  \r\n      }\r\n  \r\n      // console.log(this.algorithmService, \"name here\")\r\n\r\n      if (this.algorithmService.currentAlgorithm.name != \"Stable Roommates Problem\" || true) {\r\n\r\n    \r\n        preferenceString += \"\\n\" + this.algorithmService.pluralMap.get(this.algorithmService.currentAlgorithm.orientation[1]) + \"\\n\";\r\n    \r\n        counter = 0;\r\n    \r\n\r\n    \r\n        for (let agent of this.group2Preferences) {\r\n          currentLine = \"\";\r\n    \r\n          if (counter < this.numberOfGroup2Agents.value) {\r\n            let id: string = agent[0];\r\n            let currentPreferences: string[] = agent[1];\r\n    \r\n            let newPreferences: string[] = [];\r\n    \r\n            for (let preference of currentPreferences) {\r\n              if (Number(preference) <= this.numberOfGroup1Agents.value) {\r\n                newPreferences.push(preference);\r\n              }\r\n            }\r\n    \r\n            currentLine = id + \": \" + newPreferences.join(\", \");\r\n    \r\n    \r\n            currentLine += \"\\n\";\r\n            preferenceString += currentLine;\r\n          }\r\n    \r\n          counter++;\r\n    \r\n        }\r\n      }\r\n    }\r\n    \r\n    this.formString = preferenceString.slice(0, -1);\r\n\r\n  }\r\n\r\n  generateAlgorithmPreferences(): void {\r\n    let preferenceString: string = this.formString;\r\n\r\n    console.log(\"---\");\r\n    console.log(preferenceString);\r\n\r\n    let newPreferences: Map<String, Array<String>> = new Map();\r\n\r\n    console.log(preferenceString.split(\"\\n\"));\r\n\r\n    for (let line of preferenceString.split(\"\\n\")) {\r\n      if (this.checkIfPreference(line)) {\r\n        if (this.checkValidity) {\r\n          line = line.replace(/:\\s+,/g, ':');\r\n          line = line.replace(/,\\s+,/g, ',');\r\n          line = line.replace(/, $/g, '');\r\n          line = line.replace(/,$/g, '');\r\n          line = line.replace(/\\s+/g, '');    // remove whitespace from line from https://stackoverflow.com/questions/24580912/trim-all-white-space-from-string-javascript\r\n          let agentId: string = line.slice(0, line.indexOf(\":\"));\r\n          let agentPreferences = line.slice(line.indexOf(\":\") + 1).split(\",\");\r\n          \r\n          if (agentPreferences.slice().length == 1){\r\n            agentPreferences = Array<string>(this.numberOfGroup1Agents.value - 1).fill(\"1\")\r\n          }\r\n\r\n          newPreferences.set(agentId, agentPreferences.slice());\r\n\r\n          console.log(agentPreferences.slice())\r\n\r\n        }\r\n      }\r\n    }\r\n\r\n    \r\n\r\n    var command = this.playbackService.commandList[this.playbackService.previousStepCounter];\r\n    let a = document.getElementById(\"line\" + command[\"lineNumber\"]);\r\n    a.style.backgroundColor = \"\";\r\n    a.style.color = \"\";\r\n\r\n    this.algorithmService.numberOfGroup1Agents = Number(this.numberOfGroup1Agents.value);\r\n    this.algorithmService.numberOfGroup2Agents = Number(this.numberOfGroup2Agents.value);\r\n\r\n    this.canvasService.initialise();\r\n    this.playbackService.setAlgorithm(this.algorithmService.currentAlgorithm.id, this.algorithmService.numberOfGroup1Agents, this.algorithmService.numberOfGroup2Agents, newPreferences);\r\n\r\n    this.dialogRef.close();\r\n\r\n    this._snackBar.open(\"Preferences changed\", \"Dismiss\", {\r\n      duration: 2000,\r\n    });\r\n\r\n  }\r\n  \r\n  checkIfPreference(str: string): boolean {\r\n    let re = /^.:/;\r\n    return re.test(str);\r\n  }\r\n\r\n  checkValidity(str: string): boolean {\r\n    return true;\r\n  }\r\n\r\n\r\n  generateMissingPreferences(preferenceString) {\r\n\r\n    let newPreferences: Map<string, Array<string>> = new Map();\r\n    this.missingPreferences = [];\r\n\r\n\r\n    // dont check for SR\r\n    if (this.algorithmService.currentAlgorithm.name == \"Stable Roommates Problem\"){\r\n      return;\r\n    }\r\n\r\n    for (let line of preferenceString.split(\"\\n\")) {\r\n      if (this.checkIfPreference(line)) {\r\n        if (this.checkValidity) {\r\n          line = line.replace(/:\\s+,/g, ':');\r\n          line = line.replace(/,\\s+,/g, ',');\r\n          line = line.replace(/, $/g, '');\r\n          line = line.replace(/,$/g, '');\r\n          line = line.replace(/\\s+/g, '');    // remove whitespace from line from https://stackoverflow.com/questions/24580912/trim-all-white-space-from-string-javascript\r\n          let agentId: string = line.slice(0, line.indexOf(\":\"));\r\n          let agentPreferences = line.slice(line.indexOf(\":\") + 1).split(\",\");\r\n          \r\n          newPreferences.set(agentId, agentPreferences.slice());\r\n\r\n        }\r\n      }\r\n    }\r\n\r\n    // console.log(newPreferences);\r\n    // console.log(\"\\n\\n\");\r\n\r\n    this.valid = true;\r\n\r\n    // let missingPreferences: Array<Array<string>> = [];\r\n\r\n    for (let agent of newPreferences) {\r\n      // let currentPreferences: Array<string> = agent[1];\r\n      let agentId: string = agent[0];\r\n      let currentPreferences: string[] = agent[1];\r\n      let isGroup1: boolean = isNaN(Number(agentId));\r\n\r\n      // console.log(agentId);\r\n      // console.log(currentPreferences);\r\n      // console.log(isGroup1);\r\n\r\n      // console.log(\"\\n\");\r\n\r\n      for (let i = 1; i <= (isGroup1 ? this.numberOfGroup1Agents.value : this.numberOfGroup2Agents.value); i++ ) {\r\n        // console.log(isGroup1 ? i : String.fromCharCode(i + 64));\r\n        let currentNumInPreference = false;\r\n        for (let preference of currentPreferences) {\r\n          // console.log(isGroup1 ? String(i) : String.fromCharCode(i + 64));\r\n          // console.log(preference);\r\n          if (((isGroup1 ? String(i) : String.fromCharCode(i + 64)) == preference)) {\r\n            // console.log(\"here\");\r\n            // boolean array?\r\n            currentNumInPreference = true;\r\n          }\r\n        }\r\n        if (!currentNumInPreference) {\r\n          // console.log(\"(\" + agentId + \", \" + (isGroup1 ? String(i) : String.fromCharCode(i + 64)) + \")\");\r\n          // console.log([agentId, (isGroup1 ? String(i) : String.fromCharCode(i + 64))])\r\n          // console.log([(isGroup1 ? String(i) : String.fromCharCode(i + 64)), agentId]);\r\n          // console.log([agentId, (isGroup1 ? String(i) : String.fromCharCode(i + 64))] == [\"1\", \"D\"]);\r\n\r\n          // console.log(this.checkArrayEquality([agentId, (isGroup1 ? String(i) : String.fromCharCode(i + 64))], [\"1\", \"D\"]));\r\n\r\n          let added: boolean = false;\r\n\r\n          for (let preference of this.missingPreferences) {\r\n            if (this.checkArrayEquality(preference, [(isGroup1 ? String(i) : String.fromCharCode(i + 64)), agentId])) {\r\n              added = true;\r\n              console.log(\"???\");\r\n              console.log(this.missingPreferences.indexOf(preference));\r\n              this.missingPreferences.splice(this.missingPreferences.indexOf(preference), 1);\r\n            }\r\n          }\r\n\r\n          if (!added) {\r\n            this.missingPreferences.push([agentId, (isGroup1 ? String(i) : String.fromCharCode(i + 64))]);\r\n          }\r\n\r\n          // if (missingPreferences.includes([(isGroup1 ? String(i) : String.fromCharCode(i + 64)), agentId])) {\r\n          //   missingPreferences.splice(missingPreferences.indexOf([(isGroup1 ? String(i) : String.fromCharCode(i + 64)), agentId]), 1);\r\n          // } else {\r\n          //   missingPreferences.push([agentId, (isGroup1 ? String(i) : String.fromCharCode(i + 64))]);\r\n          // }\r\n          // console.log(\"make valid = false here!\");\r\n        }\r\n      }\r\n\r\n\r\n      // console.log(\"-----------\");\r\n\r\n\r\n\r\n    }\r\n    // console.log(this.group1Preferences);\r\n    this.valid = this.missingPreferences.length == 0;\r\n    console.log(this.missingPreferences);\r\n    console.log(this.valid);\r\n\r\n  }\r\n\r\n  // [1, 2, 3, 4]\r\n  // [4, 3, 2, 1]\r\n\r\n  // [1, 4], [1, 3], [1, 2], [1, 1]\r\n  // false, false, false, true\r\n\r\n    // FROM: https://javascript.info/task/shuffle\r\n  shuffle(array: Array<Object>) {\r\n    for (let i = array.length - 1; i > 0; i--) {\r\n      let j = Math.floor(Math.random() * (i + 1)); // random index from 0 to i\r\n  \r\n      // swap elements array[i] and array[j]\r\n      // we use \"destructuring assignment\" syntax to achieve that\r\n      // you'll find more details about that syntax in later chapters\r\n      // same can be written as:\r\n      // let t = array[i]; array[i] = array[j]; array[j] = t\r\n      [array[i], array[j]] = [array[j], array[i]];\r\n    }\r\n  }\r\n\r\n\r\n  checkArrayEquality(a: Array<string>, b: Array<string>) {\r\n    for (let i = 0; i < a.length; i++) {\r\n      if (a[i] !== b[i]) { return false; }\r\n    }\r\n    return true;\r\n  }\r\n\r\n}\r\n","<div style=\"min-width: 300px\">\r\n    <h1>Edit Preferences</h1>\r\n\r\n    <p>\r\n      Click on the number below and use arrow keys to change the number of {{ this.algorithmService.pluralMap.get(this.algorithmService.currentAlgorithm.orientation[0]).toLowerCase() }} and {{ this.algorithmService.pluralMap.get(this.algorithmService.currentAlgorithm.orientation[1]).toLowerCase() }}\r\n      <br><br>\r\n      Any preferences should be in the form:\r\n      <br>\r\n      <{{this.algorithmService.currentAlgorithm.orientation[0].toLowerCase()}}/{{this.algorithmService.currentAlgorithm.orientation[1].toLowerCase()}} number>: &lt;preferences separated by commas>\r\n    </p>\r\n\r\n    <form class=\"example-form pl-3\">\r\n      <div class=\"row justify-content-start\" *ngIf=\"this.algorithmService.currentAlgorithm.name == 'Stable Marriage Problem'\">\r\n        <mat-form-field style=\"width: 200px;\">\r\n          <mat-label>Number of Men and Women</mat-label>\r\n          <input [formControl]=\"numberOfGroup1Agents\" type=\"number\" matInput placeholder=\"5\" value=\"5\" (ngModelChange)=\"this.generatePreferenceString()\" min=\"1\" max=\"9\" oninput=\"this.value = this.value > 0 && this.value < 10 ? (!!this.value && Math.abs(this.value) >= 0 ? Math.abs(this.value) : null) : Number(String(this.value).charAt(1))\" onDrag=\"return false\" onDrop=\"return false\" onPaste=\"return false\">\r\n          <mat-error *ngIf=\"numberOfGroup1Agents.hasError('required')\">\r\n            This field is <strong>required</strong>\r\n          </mat-error>\r\n          <mat-error *ngIf=\"numberOfGroup1Agents.hasError('min') || numberOfGroup1Agents.hasError('max')\">\r\n            Please input a number between 1 and 9\r\n          </mat-error>\r\n        </mat-form-field>\r\n      </div>\r\n  \r\n      <div class=\"row justify-content-center\" *ngIf=\"this.algorithmService.currentAlgorithm.name == 'Hospitals/Residents Problem'\">\r\n        <mat-form-field style=\"width: 200px;\" class=\"mr-1\">\r\n          <mat-label>Number of Residents</mat-label>\r\n          <input [formControl]=\"numberOfGroup1Agents\" type=\"number\" matInput placeholder=\"5\" value=\"5\" (ngModelChange)=\"this.generatePreferenceString()\" min=\"2\" max=\"9\" oninput=\"this.value = this.value > 1 && this.value < 10 ? (!!this.value && Math.abs(this.value) >= 0 ? Math.abs(this.value) : null) : Number(String(this.value).charAt(1))\" onDrag=\"return false\" onDrop=\"return false\" onPaste=\"return false\">\r\n          <mat-error *ngIf=\"numberOfGroup1Agents.hasError('required')\">\r\n            This field is <strong>required</strong>\r\n          </mat-error>\r\n          <mat-error *ngIf=\"numberOfGroup1Agents.hasError('min') || numberOfGroup1Agents.hasError('max')\">\r\n            Please input a number between 1 and 9\r\n          </mat-error>\r\n        </mat-form-field>\r\n  \r\n        <mat-form-field style=\"width: 200px;\" class=\"ml-1\">\r\n          <mat-label>Number of Hospitals</mat-label>\r\n          <input [formControl]=\"numberOfGroup2Agents\" type=\"number\" matInput placeholder=\"5\" value=\"5\" (ngModelChange)=\"this.generatePreferenceString()\" min=\"2\" max=\"9\" oninput=\"this.value = this.value > 1 && this.value < 10 ? (!!this.value && Math.abs(this.value) >= 0 ? Math.abs(this.value) : null) : Number(String(this.value).charAt(1))\" onDrag=\"return false\" onDrop=\"return false\" onPaste=\"return false\">\r\n          <mat-error *ngIf=\"numberOfGroup2Agents.hasError('required')\">\r\n            This field is <strong>required</strong>\r\n          </mat-error>\r\n          <mat-error *ngIf=\"numberOfGroup2Agents.hasError('min') || numberOfGroup2Agents.hasError('max')\">\r\n            Please input a number between 1 and 9\r\n          </mat-error>\r\n        </mat-form-field>\r\n      </div>\r\n\r\n      <div class=\"row justify-content-start\" *ngIf=\"this.algorithmService.currentAlgorithm.name == 'Stable Roommates Problem'\">\r\n        <mat-form-field style=\"width: 200px;\">\r\n          <mat-label>Number of Men and Women</mat-label>\r\n          <input [formControl]=\"numberOfGroup1Agents\" type=\"number\" matInput placeholder=\"5\" value=\"5\" (ngModelChange)=\"this.generatePreferenceString()\" min=\"1\" max=\"10\" oninput=\"this.value = this.value > 0 && this.value < 11 ? (!!this.value && Math.abs(this.value) >= 0 ? Math.abs(this.value) : null) : Number(String(this.value))\" onDrag=\"return false\" onDrop=\"return false\" onPaste=\"return false\">\r\n          <mat-error *ngIf=\"numberOfGroup1Agents.hasError('required')\">\r\n            This field is <strong>required</strong>\r\n          </mat-error>\r\n          <mat-error *ngIf=\"numberOfGroup1Agents.hasError('min') || numberOfGroup1Agents.hasError('max')\">\r\n            Please input an even number between 1 and 10\r\n          </mat-error>\r\n        </mat-form-field>\r\n      </div>\r\n  \r\n    </form>\r\n\r\n    <h2 class=\"mt-2\">Input New Preferences</h2>\r\n\r\n    <mat-form-field class=\"example-full-width\" style=\"width: 100%; height:fit-content\">\r\n        <mat-label>Enter your custom preferences here (separated by commas)!</mat-label>\r\n        <textarea matInput placeholder=\"1: A, B, C, D, E\" [(ngModel)]=\"this.formString\" cdkTextareaAutosize #autosize=\"cdkTextareaAutosize\" style=\"overflow: hidden;\" value=\"{{ this.formString }}\" (ngModelChange)=\"this.generateMissingPreferences($event)\"></textarea>\r\n    </mat-form-field>\r\n\r\n    <h2 *ngIf=\"this.missingPreferences.length != 0\">Preferences Missing</h2>\r\n    <span *ngFor=\"let item of this.missingPreferences; let lastItem = last;\">\r\n      <span>({{ item }})</span><span *ngIf=\"!lastItem\">, </span>\r\n    </span>\r\n\r\n    <div class=\"row\">\r\n        <div class=\"col-12 text-right\">\r\n            <button mat-stroked-button (click)=\"generateAlgorithmPreferences()\" [disabled]=\"this.missingPreferences.length != 0 || (this.numberOfGroup1Agents.errors && this.numberOfGroup2Agents.errors)\">Generate!</button>\r\n        </div>\r\n    </div>\r\n\r\n</div>\r\n","import { Component, Input, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'mat-animated-icon',\r\n  templateUrl: './mat-animated-icon.component.html',\r\n  styleUrls: ['./mat-animated-icon.component.scss']\r\n})\r\nexport class MatAnimatedIconComponent implements OnInit {\r\n\r\n  @Input() start: String;\r\n  @Input() end: String;\r\n  @Input() colorStart: String;\r\n  @Input() colorEnd: String;\r\n  @Input() animate: boolean;\r\n  @Input() animateFromParent?: boolean = false;\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit() {\r\n    // console.log(this.colorStart);\r\n    // console.log(this.colorEnd);\r\n  }\r\n\r\n  toggle() {\r\n    if(!this.animateFromParent) this.animate = !this.animate;\r\n  }\r\n\r\n}\r\n","<mat-icon [ngClass]=\"{'animate' : animate}\" color=\"{{animate ? colorEnd : colorStart}}\" (click)=\"toggle()\">{{animate ? end : start}}</mat-icon>","import { Component, HostListener, Input, OnInit } from '@angular/core';\r\nimport { AlgorithmRetrievalService } from 'src/app/algorithm-retrieval.service';\r\nimport { PlaybackService } from '../services/playback/playback.service';\r\n\r\ndeclare var anime: any;\r\n\r\n@Component({\r\n  selector: 'playback-controls',\r\n  templateUrl: './playback-controls.component.html',\r\n  styleUrls: ['./playback-controls.component.scss']\r\n})\r\nexport class PlaybackControlsComponent implements OnInit {\r\n\r\n  @Input() algorithm: string;\r\n\r\n  constructor(public playback: PlaybackService, public algService: AlgorithmRetrievalService) { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n  formatLabel(value: number) {\r\n\r\n    // pause\r\n    value = 3050 - value;\r\n    // play? (maybe not cause so many changes to this.timeInBetween value)\r\n\r\n    if (value >= 1000) {\r\n      return Math.round(value / 1000) + 's';\r\n    }\r\n\r\n    return value;\r\n  }\r\n\r\n  updateSpeed(val: number): void {\r\n    this.playback.speed = 3050 - val;\r\n  }\r\n\r\n  delay(ms: number) {\r\n    return new Promise( resolve => setTimeout(resolve, ms) );\r\n  }\r\n\r\n}\r\n","\r\n\r\n\r\n\r\n\r\n<div class=\"container-fluid py-3\" style=\"background-color: rgb(241, 241, 241); border-top: 0.6px solid rgb(124, 124, 124); \">\r\n    <div class=\"row\" style=\"height: 100%\">\r\n      <div class=\"col-12 mainContentPopover my-auto\" data-toggle=\"popover\" data-placement=\"top\" title=\"Playback Controls\" data-content=\"Use the controls below to interact with the algorithm! Play or step through at a pace you choose with the speed slider, or use the position slider at the bottom to drag through the algorithm!\" data-trigger=\"manual\">\r\n        <div class=\"playback-block\">\r\n            <!-- PLAYBACK CONTROLS -->\r\n            <div>\r\n                <!-- SPEED CONTROL SLIDER -->\r\n                <div>\r\n                    <div class=\"row justify-content-center\">\r\n                    <span style=\"padding-top: 4px\" class=\"mt-2 mr-2\">Slow</span>\r\n                        <mat-slider\r\n                        #timeSlider\r\n                        thumbLabel\r\n                        [displayWith]=\"formatLabel\"\r\n                        tickInterval=\"1000\"\r\n                        min=\"50\"\r\n                        max=\"3000\"\r\n                        value=\"2500\"\r\n                        (input)=\"this.updateSpeed(timeSlider.value)\"></mat-slider>\r\n                        <span style=\"padding-top: 4px\" class=\"mt-2 ml-2\">Fast</span>\r\n                    </div>\r\n                </div>\r\n\r\n                <!-- PLAYBACK ICONS -->\r\n                <div>\r\n                    <div class=\"row justify-content-center\">\r\n                    <!-- GO TO START -->\r\n                    <mat-icon id=\"restartButton\" style=\"cursor: pointer;\" class=\"playbackButton unselectable disabled mr-2\" aria-hidden=\"false\" aria-label=\"Example home icon\" (click)=\"this.playback.restart()\" [ngClass]=\"{'disabled': this.playback.stepCounter == 0}\">skip_previous</mat-icon>\r\n\r\n                    <!-- BACK ONE STEP -->\r\n                    <mat-icon id=\"backButton\" style=\"cursor: pointer;\" class=\"playbackButton unselectable mr-2\" aria-hidden=\"false\" aria-label=\"Example home icon\" (click)=\"this.playback.backStep()\" [ngClass]=\"{'disabled': !this.playback.pause || this.playback.stepCounter == 0}\">fast_rewind</mat-icon>\r\n                    \r\n                    <!-- PLAY -->\r\n                    <mat-animated-icon id=\"playButton\" class=\"playbackButton unselectable\" start=\"play_arrow\" end=\"pause\" colorStart=\"none\" colorEnd=\"none\" [animate]=\"!this.playback.pause\" (click)=\"this.playback.toggle()\" [ngClass]=\"{'disabled': this.playback.stepCounter >= this.playback.numCommands}\"></mat-animated-icon>\r\n\r\n                    <!-- FORWARD ONE STEP -->\r\n                    <mat-icon id=\"forwardButton\" style=\"cursor: pointer;\" class=\"playbackButton unselectable ml-2\" aria-hidden=\"false\" aria-label=\"Example home icon\" (click)=\"this.playback.forwardStep()\" [ngClass]=\"{'disabled': !this.playback.pause || this.playback.stepCounter >= this.playback.numCommands}\">fast_forward</mat-icon>\r\n\r\n                    <!-- GO TO END -->\r\n                    <mat-icon id=\"endButton\" style=\"cursor: pointer;\" class=\"playbackButton unselectable ml-2\" aria-hidden=\"false\" aria-label=\"Example home icon\" (click)=\"this.playback.goToEnd()\" [ngClass]=\"{'disabled': this.playback.stepCounter >= this.playback.numCommands}\">skip_next</mat-icon>\r\n                    </div>\r\n                </div>\r\n\r\n                <!-- STEP SLIDER -->\r\n                <div>\r\n                    <div class=\"row justify-content-center\">\r\n                        <div id=\"stepCounter\" style=\"padding-top: 4px; width: 5px\" class=\"mt-2 mr-3\">{{ this.playback.stepCounter }}</div>\r\n                        <mat-slider style=\"width:80%; max-width: 600px;\"\r\n                        #slider\r\n                        thumbLabel\r\n                        [(ngModel)]=\"this.playback.stepCounter\"\r\n                        (input)=\"this.playback.onSliderChange(slider.value)\"\r\n                        tickInterval=\"1\"\r\n                        min=\"0\"\r\n                        max={{this.playback.numCommands}}></mat-slider>\r\n                        <div style=\"padding-top: 4px\" class=\"mt-2 ml-2\">{{ this.playback.numCommands }}</div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>","import { ElementRef, ViewChild } from '@angular/core';\r\nimport { Injectable } from '@angular/core';\r\nimport { AlgorithmRetrievalService } from '../../../algorithm-retrieval.service';\r\nimport { SidebarComponent } from '../../sidebar/sidebar.component';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class CanvasService {\r\n\r\n  originalGroup1Preferences: Array<Array<string>>;\r\n  originalGroup2Preferences: Array<Array<string>>;\r\n\r\n  // HTML drawing properties\r\n  sizes = [];\r\n  baseSize = undefined;\r\n  font = undefined;\r\n  controlChars = \"{}\\n\\t\";\r\n  spaceSize = 0;\r\n  tabSize = 8; // in spaceSize units\r\n  tabs = (function(){var t = [];for(var i=0; i < 100; i += 8){t.push(i);}; return t;})();\r\n\r\n\r\n  // circle properties\r\n  radiusOfCircles: number = 30;\r\n  yMargin: number = 0.15;\r\n  xMargin: number = 0.3;\r\n\r\n\r\n  // font properties\r\n  fontSize: number = 20;\r\n\r\n\r\n  alwaysShowPreferences: boolean = false;\r\n\r\n  canvas: ElementRef<HTMLCanvasElement>;\r\n\r\n  positions;\r\n\r\n  public currentCommand: Object;\r\n\r\n  public ctx: CanvasRenderingContext2D;\r\n\r\n  lineSizes: Map<string, number> = new Map();\r\n\r\n  firstRun: boolean = true;\r\n\r\n  constructor(public algService: AlgorithmRetrievalService) { }\r\n\r\n  ngOnInit(): void {\r\n\r\n  }\r\n\r\n  setCommand(command) {\r\n    this.currentCommand = command;\r\n    this.redrawCanvas();\r\n  }\r\n\r\n  initialise() {\r\n    // this.lineSizes = new Map();\r\n    this.firstRun = true;\r\n  }\r\n\r\n  // Idea:\r\n  // Start from middle of canvas and \r\n  calculateEqualDistance() {\r\n\r\n    let canvas: HTMLCanvasElement = <HTMLCanvasElement>document.getElementById(\"myCanvas\");\r\n\r\n    let LHSHeightOffset = 0;\r\n    let RHSHeightOffset = 0;\r\n\r\n    if (this.algService.numberOfGroup1Agents == 8) {\r\n      LHSHeightOffset = 8;\r\n      this.radiusOfCircles = 27;\r\n    } else if (this.algService.numberOfGroup1Agents == 9) {\r\n      LHSHeightOffset = 6;\r\n      this.radiusOfCircles = 21;\r\n    } else {\r\n      LHSHeightOffset = 0;\r\n      this.radiusOfCircles = 30;\r\n    }\r\n\r\n    if (this.algService.numberOfGroup2Agents == 8) {\r\n      RHSHeightOffset = 8;\r\n      this.radiusOfCircles = 27;\r\n    } else if (this.algService.numberOfGroup2Agents == 9) {\r\n      RHSHeightOffset = 6;\r\n      this.radiusOfCircles = 21;\r\n    } else {\r\n      RHSHeightOffset = 0;\r\n      this.radiusOfCircles = 30;\r\n    }\r\n\r\n    let effectiveHeight: number = canvas.height - (canvas.height * this.yMargin);\r\n    let effectiveWidth: number = canvas.width - (canvas.width * this.xMargin) \r\n    let spaceBetweenCircles: number = (effectiveHeight / this.algService.numberOfGroup1Agents) + LHSHeightOffset;\r\n    \r\n    let canvasMiddle: number = (effectiveHeight / 2) + 40;\r\n    \r\n    // center points of the canvas for SR circles \r\n    let centerX = (effectiveWidth / 2) + (canvas.width * 0.15)\r\n    let centerY = (effectiveHeight / 2)\r\n    \r\n    // console.log(canvasMiddle);\r\n\r\n    this.positions = {}\r\n\r\n    // canvas Middle \r\n    this.positions[\"middleX\"] = centerX\r\n    this.positions[\"middleY\"] = centerY\r\n\r\n\r\n\r\n    // LHS Positions\r\n\r\n\r\n    if (this.algService.numberOfGroup1Agents % 2 == 1) {\r\n\r\n      // plot middle circle\r\n      this.positions[\"circle\" + Math.floor((this.algService.numberOfGroup1Agents / 2) + 1)] = {\r\n        positionX: (this.currentCommand[\"algorithmSpecificData\"][\"hospitalCapacity\"] ? canvas.width * this.xMargin - 35 : canvas.width * this.xMargin),\r\n        positionY: canvasMiddle\r\n      }\r\n\r\n      // plot circles above middle\r\n      // console.log(\"above middle\");\r\n      for (let i = Math.floor((this.algService.numberOfGroup1Agents / 2)); i > 0; i--) {\r\n        // console.log(i);\r\n        this.positions[\"circle\" + i] = {\r\n          positionX: (this.currentCommand[\"algorithmSpecificData\"][\"hospitalCapacity\"] ? canvas.width * this.xMargin - 35 : canvas.width * this.xMargin),\r\n          positionY: canvasMiddle - ((Math.ceil((this.algService.numberOfGroup1Agents / 2)) - i) * spaceBetweenCircles)\r\n        }\r\n      }\r\n\r\n      // plot circles below middle\r\n      // console.log(\"below middle\");\r\n      for (let i = Math.ceil((this.algService.numberOfGroup1Agents / 2)) + 1; i < this.algService.numberOfGroup1Agents + 1; i++) {\r\n        // console.log(i);\r\n        this.positions[\"circle\" + i] = {\r\n          positionX: (this.currentCommand[\"algorithmSpecificData\"][\"hospitalCapacity\"] ? canvas.width * this.xMargin - 35 : canvas.width * this.xMargin),\r\n          positionY: canvasMiddle + ((i - Math.ceil((this.algService.numberOfGroup1Agents / 2))) * spaceBetweenCircles)\r\n        }\r\n      }\r\n\r\n      // console.log(this.positions);\r\n\r\n    } else {\r\n\r\n      // plot middle circle\r\n      // console.log(Math.floor(this.algService.numberOfGroup1Agents / 2));\r\n      // console.log((Math.ceil(this.algService.numberOfGroup1Agents / 2)) + 1);\r\n      this.positions[\"circle\" + Math.floor(this.algService.numberOfGroup1Agents / 2)] = {\r\n        positionX: (this.currentCommand[\"algorithmSpecificData\"][\"hospitalCapacity\"] ? canvas.width * this.xMargin - 35 : canvas.width * this.xMargin),\r\n        positionY: canvasMiddle - spaceBetweenCircles / 2\r\n      }\r\n\r\n      // plot middle circle\r\n      this.positions[\"circle\" + (Math.ceil(this.algService.numberOfGroup1Agents / 2) + 1)] = {\r\n        positionX: (this.currentCommand[\"algorithmSpecificData\"][\"hospitalCapacity\"] ? canvas.width * this.xMargin - 35 : canvas.width * this.xMargin),\r\n        positionY: canvasMiddle + spaceBetweenCircles / 2\r\n      }\r\n\r\n      // plot circles above middle\r\n      // console.log(\"above middle\");\r\n      for (let i = Math.floor((this.algService.numberOfGroup1Agents / 2)) - 1; i > 0; i--) {\r\n        // console.log(i);\r\n        this.positions[\"circle\" + i] = {\r\n          positionX: (this.currentCommand[\"algorithmSpecificData\"][\"hospitalCapacity\"] ? canvas.width * this.xMargin - 35 : canvas.width * this.xMargin),\r\n          positionY: canvasMiddle - (spaceBetweenCircles / 2) - ((Math.ceil((this.algService.numberOfGroup1Agents / 2)) - i) * spaceBetweenCircles)\r\n        }\r\n      }\r\n\r\n      // // plot circles below middle\r\n      // console.log(\"below middle\");\r\n      for (let i = Math.ceil((this.algService.numberOfGroup1Agents / 2)) + 2; i < this.algService.numberOfGroup1Agents + 1; i++) {\r\n        // console.log(i);\r\n        this.positions[\"circle\" + i] = {\r\n          positionX: (this.currentCommand[\"algorithmSpecificData\"][\"hospitalCapacity\"] ? canvas.width * this.xMargin - 35 : canvas.width * this.xMargin),\r\n          positionY: canvasMiddle + (spaceBetweenCircles / 2) + ((i - Math.ceil((this.algService.numberOfGroup1Agents / 2) + 1)) * spaceBetweenCircles)\r\n        }\r\n      }\r\n\r\n      // console.log(this.positions);\r\n    }\r\n\r\n\r\n    spaceBetweenCircles = (effectiveHeight / this.algService.numberOfGroup2Agents) + RHSHeightOffset;\r\n\r\n    // console.log(this.algService.numberOfGroup2Agents);\r\n    // RHS Circles \r\n\r\n    if (this.algService.numberOfGroup2Agents % 2 == 1) {\r\n\r\n      // plot middle circle\r\n      this.positions[\"circle\" + String.fromCharCode(Math.floor((this.algService.numberOfGroup2Agents / 2) + 1 + 64))] = {\r\n        positionX: canvas.width - (canvas.width * this.xMargin),\r\n        positionY: canvasMiddle\r\n      }\r\n\r\n      // plot circles above middle\r\n      // console.log(\"above middle\");\r\n      for (let i = Math.floor((this.algService.numberOfGroup2Agents / 2)); i > 0; i--) {\r\n        // console.log(i);\r\n        this.positions[\"circle\" + String.fromCharCode(i + 64)] = {\r\n          positionX: canvas.width - (canvas.width * this.xMargin),\r\n          positionY: canvasMiddle - ((Math.ceil((this.algService.numberOfGroup2Agents / 2)) - i) * spaceBetweenCircles)\r\n        }\r\n      }\r\n\r\n      // plot circles below middle\r\n      // console.log(\"below middle\");\r\n      for (let i = Math.ceil((this.algService.numberOfGroup2Agents / 2)) + 1; i < this.algService.numberOfGroup2Agents + 1; i++) {\r\n        // console.log(i);\r\n        this.positions[\"circle\" + String.fromCharCode(i + 64)] = {\r\n          positionX: canvas.width - (canvas.width * this.xMargin),\r\n          positionY: canvasMiddle + ((i - Math.ceil((this.algService.numberOfGroup2Agents / 2))) * spaceBetweenCircles)\r\n        }\r\n      }\r\n\r\n      // console.log(this.positions);\r\n\r\n    } else {\r\n\r\n      // plot middle circle\r\n      // console.log(Math.floor(this.algService.numberOfGroup1Agents / 2));\r\n      // console.log((Math.ceil(this.algService.numberOfGroup1Agents / 2)) + 1);\r\n      // console.log(String.fromCharCode(Math.floor(this.algService.numberOfGroup2Agents / 2) + 64));\r\n      this.positions[\"circle\" + String.fromCharCode(Math.floor(this.algService.numberOfGroup2Agents / 2) + 64)] = {\r\n        positionX: canvas.width - (canvas.width * this.xMargin),\r\n        positionY: canvasMiddle - spaceBetweenCircles / 2\r\n      }\r\n\r\n      // plot middle circle\r\n      this.positions[\"circle\" + String.fromCharCode(Math.ceil(this.algService.numberOfGroup2Agents / 2) + 1 + 64)] = {\r\n        positionX: canvas.width - (canvas.width * this.xMargin),\r\n        positionY: canvasMiddle + spaceBetweenCircles / 2\r\n      }\r\n\r\n      // plot circles above middle\r\n      // console.log(\"above middle\");\r\n      for (let i = Math.floor((this.algService.numberOfGroup2Agents / 2)) - 1; i > 0; i--) {\r\n        // console.log(i);\r\n        this.positions[\"circle\" + String.fromCharCode(i + 64)] = {\r\n          positionX: canvas.width - (canvas.width * this.xMargin),\r\n          positionY: canvasMiddle - (spaceBetweenCircles / 2) - ((Math.ceil((this.algService.numberOfGroup2Agents / 2)) - i) * spaceBetweenCircles)\r\n        }\r\n      }\r\n\r\n      // // plot circles below middle\r\n      // console.log(\"below middle\");\r\n      for (let i = Math.ceil((this.algService.numberOfGroup2Agents / 2)) + 2; i < this.algService.numberOfGroup2Agents + 1; i++) {\r\n        // console.log(i);\r\n        this.positions[\"circle\" + String.fromCharCode(i + 64)] = {\r\n          positionX: canvas.width - (canvas.width * this.xMargin),\r\n          positionY: canvasMiddle + (spaceBetweenCircles / 2) + ((i - Math.ceil((this.algService.numberOfGroup2Agents / 2) + 1)) * spaceBetweenCircles)\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  calculateEqualDistance1Group() {\r\n    let canvas: HTMLCanvasElement = <HTMLCanvasElement>document.getElementById(\"myCanvas\");\r\n\r\n    let LHSHeightOffset = 0;\r\n    let RHSHeightOffset = 0;\r\n\r\n    if (this.algService.numberOfGroup1Agents == 8) {\r\n      LHSHeightOffset = 8;\r\n      this.radiusOfCircles = 27;\r\n    } else if (this.algService.numberOfGroup1Agents == 9) {\r\n      LHSHeightOffset = 6;\r\n      this.radiusOfCircles = 21;\r\n    } else {\r\n      LHSHeightOffset = 0;\r\n      this.radiusOfCircles = 30;\r\n    }\r\n\r\n    if (this.algService.numberOfGroup2Agents == 8) {\r\n      RHSHeightOffset = 8;\r\n      this.radiusOfCircles = 27;\r\n    } else if (this.algService.numberOfGroup2Agents == 9) {\r\n      RHSHeightOffset = 6;\r\n      this.radiusOfCircles = 21;\r\n    } else {\r\n      RHSHeightOffset = 0;\r\n      this.radiusOfCircles = 30;\r\n    }\r\n\r\n    let effectiveHeight: number = canvas.height - (canvas.height * this.yMargin);\r\n    let effectiveWidth: number = canvas.width - (canvas.width * this.xMargin) \r\n\r\n    let spaceBetweenCircles: number = (effectiveHeight / this.algService.numberOfGroup1Agents) + LHSHeightOffset;\r\n\r\n    \r\n    // center points of the canvas for SR circles \r\n    let centerX = (effectiveWidth / 2) + (canvas.width * 0.15)\r\n    let centerY = (effectiveHeight / 2)\r\n    \r\n    // console.log(canvasMiddle);\r\n\r\n    this.positions = {}\r\n\r\n    // canvas Middle \r\n    this.positions[\"middleX\"] = centerX\r\n    this.positions[\"middleY\"] = centerY\r\n\r\n    // positions \r\n\r\n    let number = this.algService.numberOfGroup1Agents;\r\n\r\n    let angle = ((Math.PI * 2) / number) ;\r\n    let r = 200;\r\n\r\n    // number to rotated the circle, so that numbering looks more natural \r\n    let offset = 3; \r\n\r\n\r\n    // Draw LHS circles in orange\r\n    for (let i = 2; i < this.algService.numberOfGroup1Agents + 2; i++) {\r\n      \r\n      this.positions[\"circle\" + (i - 1) ] = {\r\n        positionX: r * Math.cos(angle * i) + centerX,\r\n        positionY: r * Math.sin(angle * i) + centerY\r\n      }\r\n      \r\n    }\r\n\r\n  }\r\n\r\n  drawLHSCircles() {\r\n\r\n    console.log(\"LHS draw positions\", this.positions)\r\n\r\n    this.ctx.beginPath();\r\n    this.ctx.fillStyle = \"#FF6332\";\r\n\r\n\r\n    // Draw LHS circles in orange\r\n    for (let i = 1; i < this.algService.numberOfGroup1Agents + 1; i++) {\r\n      let posX: number = this.positions[\"circle\" + i].positionX;\r\n      let posY: number = this.positions[\"circle\" + i].positionY;\r\n\r\n      this.ctx.moveTo(posX + this.radiusOfCircles, posY);\r\n      this.ctx.arc(posX, posY, this.radiusOfCircles, 0, Math.PI * 2, true)\r\n    }\r\n\r\n    this.ctx.fill();\r\n    this.ctx.stroke();\r\n\r\n\r\n    // Draw text (numbers)\r\n    for (let i = 1; i < this.algService.numberOfGroup1Agents + 1; i++) {\r\n      let posX: number = this.positions[\"circle\" + i].positionX;\r\n      let posY: number = this.positions[\"circle\" + i].positionY;\r\n\r\n      this.ctx.fillStyle = \"black\";\r\n      this.ctx.font = this.radiusOfCircles + 'px Arial';\r\n\r\n      this.ctx.fillText(String(i), posX - 8, posY + 10, 20);\r\n\r\n    }\r\n\r\n  }\r\n\r\n\r\n  drawRHSCircles() {\r\n    this.ctx.beginPath();\r\n    this.ctx.fillStyle = \"#CA32FF\";\r\n    let currentLetter = 'A';\r\n\r\n    // Draw RHS circles in orange\r\n    for (let i = 0; i < this.algService.numberOfGroup2Agents; i++) {\r\n      let posX: number = this.positions[\"circle\" + currentLetter].positionX;\r\n      let posY: number = this.positions[\"circle\" + currentLetter].positionY;\r\n\r\n      this.ctx.moveTo(posX + this.radiusOfCircles, posY);\r\n      this.ctx.arc(posX, posY, this.radiusOfCircles, 0, Math.PI * 2, true)\r\n      currentLetter = String.fromCharCode((((currentLetter.charCodeAt(0) + 1) - 65 ) % 26) + 65);\r\n    }\r\n\r\n    this.ctx.fill();\r\n    this.ctx.stroke();\r\n\r\n\r\n    currentLetter = 'A';\r\n\r\n    // Draw text (numbers)\r\n    for (let i = 1; i < this.algService.numberOfGroup2Agents + 1; i++) {\r\n      let posX: number = this.positions[\"circle\" + currentLetter].positionX;\r\n      let posY: number = this.positions[\"circle\" + currentLetter].positionY;\r\n\r\n      this.ctx.fillStyle = \"black\";\r\n      this.ctx.font = this.radiusOfCircles + 'px Arial';\r\n\r\n      this.ctx.fillText(currentLetter, posX - 9, posY + 11, 20);\r\n      currentLetter = String.fromCharCode((((currentLetter.charCodeAt(0) + 1) - 65 ) % 26) + 65);\r\n    }\r\n  }\r\n\r\n  drawCircles1Group() {\r\n\r\n    this.ctx.beginPath();\r\n    this.ctx.fillStyle = \"#FF6332\";\r\n\r\n\r\n    // number to rotated the circle, so that numbering looks more natural \r\n    let offset = 1;\r\n    // Draw LHS circles in orange\r\n    for (let i = 1; i < this.algService.numberOfGroup1Agents + 1; i++) {\r\n\r\n      let posX: number = this.positions[\"circle\" + i].positionX;\r\n      let posY: number = this.positions[\"circle\" + i].positionY;\r\n\r\n      this.ctx.moveTo(posX + this.radiusOfCircles, posY);\r\n      this.ctx.arc(posX, posY, this.radiusOfCircles, 0, Math.PI * 2, true)\r\n\r\n    }\r\n\r\n\r\n    // colours circles \r\n    this.ctx.fill();\r\n    this.ctx.stroke();\r\n\r\n\r\n    for (let i = offset; i < this.algService.numberOfGroup1Agents + offset; i++) {\r\n      let posX: number = this.positions[\"circle\" + i].positionX;\r\n      let posY: number = this.positions[\"circle\" + i].positionY;\r\n\r\n      this.ctx.fillStyle = \"black\";\r\n      this.ctx.font = this.radiusOfCircles + 'px Arial';\r\n\r\n      this.ctx.fillText(String(i - offset + 1), posX - 8, posY + 10, 20);\r\n\r\n    }\r\n \r\n  }\r\n\r\n\r\n  drawLine1Group(line: Array<string>): void {\r\n\r\n    let color: string = line[2];\r\n\r\n    if (color == \"red\") {\r\n      this.ctx.strokeStyle = \"#EB2A2A\";\r\n    } else if (color == \"green\") {\r\n      this.ctx.strokeStyle = \"#53D26F\";\r\n    }\r\n\r\n    this.ctx.lineWidth = 3;\r\n\r\n    \r\n    let xLen = (this.positions[\"circle\" + line[1]].positionX) - (this.positions[\"circle\" + line[0]].positionX)\r\n    let yLen = (this.positions[\"circle\" + line[1]].positionY) - (this.positions[\"circle\" + line[0]].positionY)\r\n\r\n\r\n    // halfX = this.positions[\"circle\" + line[0]].positionX + (xLen * (1 - Math.abs(this.radiusOfCircles / yLen)))\r\n    // halfY = this.positions[\"circle\" + line[0]].positionY + (yLen * (1 - Math.abs(this.radiusOfCircles / yLen))) \r\n\r\n    let halfX = this.positions[\"circle\" + line[0]].positionX + (xLen * 0.8)\r\n    let halfY = this.positions[\"circle\" + line[0]].positionY + (yLen * 0.8) \r\n\r\n\r\n\r\n    let angle = Math.atan(yLen / xLen)\r\n\r\n  \r\n    let newX = 0\r\n    let newY = 0\r\n\r\n    let right = false;\r\n\r\n    // if starting < ending - pointing right- canvas in bottum right quadrent\r\n    if (this.positions[\"circle\" + line[0]].positionX < this.positions[\"circle\" + line[1]].positionX) {\r\n      right = true\r\n    } else {\r\n      right = false\r\n    }\r\n\r\n    // draw arrow \r\n    this.ctx.beginPath();\r\n    this.ctx.moveTo(this.positions[\"circle\" + line[0]].positionX, this.positions[\"circle\" + line[0]].positionY);\r\n    \r\n\r\n    if (color != \"green\") {\r\n\r\n      this.ctx.lineTo(halfX, halfY);\r\n    \r\n      if (right) {\r\n\r\n        newX = halfX + 20 * Math.cos(angle + (3 * Math.PI / 4))\r\n        newY = halfY + 20 * Math.sin(angle + (3 * Math.PI / 4))\r\n\r\n      } else {\r\n\r\n        newX = halfX + 20 * Math.cos(angle + (Math.PI / 4))\r\n        newY = halfY + 20 * Math.sin(angle + (Math.PI / 4))\r\n      }\r\n\r\n      this.ctx.lineTo(newX, newY)\r\n      this.ctx.lineTo(halfX, halfY);\r\n\r\n\r\n      if (right) {\r\n\r\n        newX = halfX + 20 * Math.cos(angle - (3 * Math.PI / 4))\r\n        newY = halfY + 20 * Math.sin(angle - (3 * Math.PI / 4))\r\n\r\n      } else {\r\n\r\n        newX = halfX + 20 * Math.cos(angle - (Math.PI / 4))\r\n        newY = halfY + 20 * Math.sin(angle - (Math.PI / 4))\r\n      }\r\n\r\n      this.ctx.lineTo(newX, newY)\r\n\r\n    } else {\r\n      this.ctx.lineTo(this.positions[\"circle\" + line[1]].positionX, this.positions[\"circle\" + line[1]].positionY);\r\n    }\r\n    \r\n    this.ctx.stroke();\r\n\r\n    this.ctx.strokeStyle = \"#000000\";\r\n    this.ctx.lineWidth = 1;\r\n\r\n  }\r\n\r\n  drawLine(line: Array<string>): void {\r\n\r\n    let color: string = line[2];\r\n\r\n    if (color == \"red\") {\r\n      this.ctx.strokeStyle = \"#EB2A2A\";\r\n    } else if (color == \"green\") {\r\n      this.ctx.strokeStyle = \"#53D26F\";\r\n    }\r\n\r\n    this.ctx.lineWidth = 3;\r\n\r\n    this.ctx.beginPath();\r\n    this.ctx.moveTo(this.positions[\"circle\" + line[0]].positionX, this.positions[\"circle\" + line[0]].positionY);\r\n    this.ctx.lineTo(this.positions[\"circle\" + line[1]].positionX, this.positions[\"circle\" + line[1]].positionY);\r\n    this.ctx.stroke();\r\n\r\n    this.ctx.strokeStyle = \"#000000\";\r\n    this.ctx.lineWidth = 1;\r\n\r\n  }\r\n\r\n\r\n  drawAllPreferences() {\r\n\r\n    this.ctx.font = this.fontSize + 'px Arial';\r\n\r\n    let group1PreferenceList: Array<Array<string>> = Object.values(this.currentCommand[\"group1CurrentPreferences\"]);\r\n\r\n    if (group1PreferenceList.length <= 0) {\r\n      group1PreferenceList = Array.from(this.currentCommand[\"group1CurrentPreferences\"].values());\r\n    }\r\n\r\n\r\n    for (let i = 1; i < this.algService.numberOfGroup1Agents + 1; i++) {\r\n      this.drawText(this.ctx, group1PreferenceList[i-1].join(\", \"), this.positions[\"circle\" + i].positionX - this.lineSizes.get(String(i)) * 2 - 65, this.positions[\"circle\" + i].positionY + 7, this.fontSize);\r\n    }\r\n\r\n    // only draw group2 if it is not SR\r\n    \r\n    let group2PreferenceList: Array<Array<string>> = Object.values(this.currentCommand[\"group2CurrentPreferences\"]);\r\n    let currentLetter = 'A';\r\n\r\n    if (group2PreferenceList.length <= 0) {\r\n      group2PreferenceList = Array.from(this.currentCommand[\"group2CurrentPreferences\"].values());\r\n    }\r\n\r\n    for (let i = 1; i < this.algService.numberOfGroup2Agents + 1; i++) {\r\n      this.drawText(this.ctx, group2PreferenceList[i-1].join(\", \"), this.positions[\"circle\" + currentLetter].positionX + (this.currentCommand[\"algorithmSpecificData\"][\"hospitalCapacity\"] ? 115 : 65), this.positions[\"circle\" + currentLetter].positionY + 7, this.fontSize);\r\n      currentLetter = String.fromCharCode((((currentLetter.charCodeAt(0) + 1) - 65 ) % 26) + 65);\r\n    }\r\n    \r\n  }\r\n\r\n  drawAllPreferences1Group() {\r\n\r\n    this.ctx.font = this.fontSize + 'px Arial';\r\n\r\n    let group1PreferenceList: Array<Array<string>> = Object.values(this.currentCommand[\"group1CurrentPreferences\"]);\r\n\r\n    if (group1PreferenceList.length <= 0) {\r\n      group1PreferenceList = Array.from(this.currentCommand[\"group1CurrentPreferences\"].values());\r\n    }\r\n\r\n    let num = this.algService.numberOfGroup1Agents\r\n\r\n    for (let i = 1; i < num / 2 + 1; i++) {\r\n      this.drawText(this.ctx, \r\n      group1PreferenceList[i-1].join(\", \"),\r\n      this.positions[\"circle\" + i].positionX - (this.lineSizes.get(String(i)) * 2) - 65,\r\n      this.positions[\"circle\" + i].positionY + 7, this.fontSize);\r\n    }\r\n\r\n    for (let i = (num / 2) + 1; i < num + 1; i++) {\r\n      this.drawText(this.ctx, \r\n      group1PreferenceList[i-1].join(\", \"),\r\n      this.positions[\"circle\" + i].positionX + 65,\r\n      this.positions[\"circle\" + i].positionY + 7, this.fontSize);\r\n    }\r\n\r\n  }\r\n\r\n  drawRelevantPreferences() {\r\n\r\n    let group1PreferenceList: Array<Array<string>> = Object.values(this.currentCommand[\"group1CurrentPreferences\"]);\r\n\r\n    if (group1PreferenceList.length <= 0) {\r\n      group1PreferenceList = Array.from(this.currentCommand[\"group1CurrentPreferences\"].values());\r\n    }\r\n\r\n    let group2PreferenceList: Array<Array<string>> = Object.values(this.currentCommand[\"group2CurrentPreferences\"]);\r\n\r\n    if (group2PreferenceList.length <= 0) {\r\n      group2PreferenceList = Array.from(this.currentCommand[\"group2CurrentPreferences\"].values());\r\n    }\r\n\r\n    for (let agent of this.currentCommand[\"relevantPreferences\"]) {\r\n      if (agent.match(/[A-Z]/i)) {\r\n        this.drawText(this.ctx, group2PreferenceList[(((agent.charCodeAt(0)) - 65 ))].join(\", \"), this.positions[\"circle\" + agent].positionX + (this.currentCommand[\"algorithmSpecificData\"][\"hospitalCapacity\"] ? 115 : 65), this.positions[\"circle\" + agent].positionY + 7, this.fontSize);\r\n      } else {\r\n        this.drawText(this.ctx, group1PreferenceList[agent - 1].join(\", \"), this.positions[\"circle\" + agent].positionX - this.lineSizes.get(agent) * 2 - 65, this.positions[\"circle\" + agent].positionY + 7, this.fontSize);\r\n      }\r\n    }\r\n  }\r\n\r\n  drawHospitalCapacity() {\r\n    let hospitalCapacityMap = this.currentCommand[\"algorithmSpecificData\"][\"hospitalCapacity\"];\r\n\r\n    this.ctx.font = this.fontSize + 'px Arial';\r\n\r\n    let currentLetter = 'A';\r\n\r\n    for (let i = 1; i < this.algService.numberOfGroup2Agents + 1; i++) {\r\n\r\n      let currentCapacity: number = hospitalCapacityMap[currentLetter];\r\n\r\n      this.drawText(this.ctx, \"(\" + String(currentCapacity) + \")\", this.positions[\"circle\" + currentLetter].positionX + 60, this.positions[\"circle\" + currentLetter].positionY + 7, this.fontSize);\r\n      // this.ctx.fillText(group2PreferenceList[i-1].join(\", \"), this.positions[\"circle\" + currentLetter].positionX + 65, this.positions[\"circle\" + currentLetter].positionY + 7);\r\n      currentLetter = String.fromCharCode((((currentLetter.charCodeAt(0) + 1) - 65 ) % 26) + 65);\r\n    }\r\n\r\n  }\r\n\r\n  selectCircles(circles: Array<string>) {\r\n\r\n    let originalLineWidth: number = this.ctx.lineWidth;\r\n    let originalStrokeStyle: string | CanvasGradient | CanvasPattern = this.ctx.strokeStyle;\r\n\r\n    this.ctx.lineWidth = 4;\r\n    this.ctx.strokeStyle = \"#53D26F\";\r\n\r\n    for (let agent of circles) {\r\n\r\n      this.ctx.beginPath();\r\n\r\n      let posX: number = this.positions[\"circle\" + agent].positionX;\r\n      let posY: number = this.positions[\"circle\" + agent].positionY;\r\n\r\n      this.ctx.moveTo(posX + this.radiusOfCircles, posY);\r\n\r\n      this.ctx.arc(posX, posY, this.radiusOfCircles, 0, Math.PI * 2, true)\r\n\r\n      this.ctx.stroke();\r\n\r\n    }\r\n\r\n    this.ctx.lineWidth = originalLineWidth;\r\n    this.ctx.strokeStyle = originalStrokeStyle;\r\n\r\n  }\r\n\r\n\r\n  getNextTab(x) {\r\n    let i = 0;\r\n    while(i < this.tabs.length){\r\n        if(x < this.tabs[i] * this.tabSize * this.spaceSize){\r\n            return this.tabs[i] * this.tabSize * this.spaceSize;\r\n        }\r\n        i++;\r\n    }\r\n    return this.tabs[i-1] * this.tabSize * this.spaceSize;\r\n  }\r\n\r\n  getFontSize(font) {\r\n    var numFind = /[0-9]+/;\r\n    var number: number = Number(numFind.exec(font)[0]);\r\n    if(isNaN(number)){\r\n        throw Error(\"SimpleTextStyler Cant find font size\");\r\n    }\r\n    return Number(number);\r\n    \r\n  }\r\n\r\n  setFont(font = this.ctx.font) {\r\n    this.font = this.ctx.font = font;\r\n    this.baseSize = this.getFontSize(font);\r\n    for(var i = 32; i < 256; i ++){\r\n        this.sizes[i-32] = this.ctx.measureText(String.fromCharCode(i)).width/this.baseSize;\r\n    }\r\n    this.spaceSize = this.sizes[0];\r\n\r\n}\r\n\r\n\r\n// FROM: https://stackoverflow.com/questions/43904201/how-can-i-colour-different-words-in-the-same-line-with-html5-canvas\r\n// adapted for use in this project\r\n  drawText(context,text,x,y,size){\r\n    var i,len,subText;\r\n    var w,scale;\r\n    var xx,yy,ctx;\r\n    var state = [];\r\n    if(text === undefined){ return }\r\n    xx = x;\r\n    yy = y;\r\n    if(!context.setTransform){ // simple test if this is a 2D context\r\n        if(context.ctx){ ctx = context.ctx } // may be a image with attached ctx?\r\n        else{ return }\r\n    }else { ctx = context }\r\n\r\n    function renderText(text){\r\n    \r\n        ctx.save();\r\n        ctx.fillStyle = colour;\r\n        ctx.translate(x,y)\r\n        ctx.scale(scale,scale)\r\n        ctx.fillText(text,0,0);\r\n        ctx.restore();\r\n    }\r\n    var colour = ctx.fillStyle;\r\n    ctx.font = this.font;\r\n    len = text.length;\r\n    subText = \"\";\r\n    w = 0;\r\n    i = 0;\r\n    scale = size / this.baseSize;\r\n    while(i < len){\r\n        var c = text[i];\r\n        var cc = text.charCodeAt(i);\r\n        if(cc < 256){ // only ascii\r\n            if(this.controlChars.indexOf(c) > -1){\r\n                if(subText !== \"\"){\r\n                    scale = size / this.baseSize;\r\n                    renderText(subText);\r\n                    x += w;\r\n                    w = 0;\r\n                    subText = \"\";                        \r\n                }\r\n                if(c === \"\\n\"){  // return move to new line\r\n                    x = xx;\r\n                    y += size;\r\n                }else\r\n                if(c === \"\\t\"){ // tab move to next tab\r\n                    x = this.getNextTab(x-xx)+xx;\r\n                }else\r\n                if(c === \"{\"){   // Text format delimiter                       \r\n                    state.push({\r\n                        size : size,\r\n                        colour : colour,\r\n                        x:x,\r\n                        y:y,\r\n                    })\r\n                    i += 1;\r\n                    var t = text[i];\r\n                    if(t === \"#\"){\r\n                      colour = text.substr(i,7);\r\n                      i+= 6;\r\n                    }\r\n                }else if(c  === \"}\"){\r\n                    var s = state.pop();\r\n                    y = s.y;\r\n                    size = s.size;\r\n                    colour = s.colour;\r\n                    scale = size / this.baseSize;\r\n                }\r\n            }else{\r\n                subText += c;\r\n                w += this.sizes[cc-32] * (size ) ;\r\n            }\r\n        }\r\n        i += 1;\r\n    }\r\n    if(subText !== \"\"){\r\n        renderText(subText);\r\n    }\r\n  \r\n  }\r\n\r\n\r\n\r\n  redrawCanvas(command?: Object): void {\r\n\r\n    if (command) {\r\n      this.currentCommand = command;\r\n    }\r\n\r\n    let canvas: HTMLCanvasElement = <HTMLCanvasElement>document.getElementById(\"myCanvas\");\r\n    var parent = document.getElementById(\"parent\");\r\n    canvas.width = parent.offsetWidth - 20;\r\n    canvas.height = parent.offsetHeight - 20;\r\n\r\n    if (this.firstRun) {\r\n      this.originalGroup1Preferences = Array.from(this.currentCommand[\"group1CurrentPreferences\"].values());\r\n      this.originalGroup2Preferences = Array.from(this.currentCommand[\"group2CurrentPreferences\"].values());\r\n      this.firstRun = false;\r\n    }\r\n\r\n    this.lineSizes = new Map();\r\n    for (let i=1; i < this.algService.numberOfGroup1Agents + 1; i++) {\r\n      let lineSize = this.ctx.measureText(this.originalGroup1Preferences[i-1].join(\", \")).width;\r\n      this.lineSizes.set(String(i), lineSize);\r\n    }\r\n\r\n    this.setFont();\r\n\r\n    \r\n    \r\n\r\n   \r\n    // this.drawLineBetween(\"circle1\", \"circleE\", \"red\")\r\n    // this.drawLineBetween(\"circle1\", \"circleB\");\r\n\r\n    // draw circles\r\n\r\n    // if SR Algorithm\r\n    if (this.currentCommand[\"algorithmSpecificData\"][\"SR\"]) {\r\n\r\n      // draw lines between circles (matches and relations)\r\n      for (let line of this.currentCommand[\"currentLines\"]) {\r\n        this.drawLine1Group(line);\r\n      }\r\n\r\n      // update positions of all canvas elements\r\n      this.calculateEqualDistance1Group();\r\n      this.drawCircles1Group();\r\n\r\n    } else {\r\n\r\n      // draw lines between circles (matches and relations)\r\n      for (let line of this.currentCommand[\"currentLines\"]) {\r\n        this.drawLine(line);\r\n      }\r\n\r\n      // update positions of all canvas elements\r\n      this.calculateEqualDistance();\r\n\r\n      this.drawLHSCircles();\r\n      this.drawRHSCircles();\r\n    }\r\n    \r\n    \r\n\r\n    if (this.currentCommand) {\r\n      if (this.currentCommand[\"algorithmSpecificData\"][\"hospitalCapacity\"]) {\r\n        this.drawHospitalCapacity();\r\n      }\r\n\r\n      if (this.currentCommand[\"relevantPreferences\"].length >= 1 && this.alwaysShowPreferences) {\r\n        this.drawRelevantPreferences();\r\n      } else {\r\n\r\n        // preferances drawn differently for SR\r\n        if (this.currentCommand[\"algorithmSpecificData\"][\"SR\"]){\r\n          this.drawAllPreferences1Group();\r\n        } else {\r\n          this.drawAllPreferences();\r\n        }\r\n      }\r\n    }\r\n\r\n    \r\n\r\n\r\n    this.selectCircles(this.currentCommand[\"currentlySelectedAgents\"]);\r\n\r\n  }\r\n}","import { Injectable } from '@angular/core';\r\nimport { CombineLatestSubscriber } from 'rxjs/internal/observable/combineLatest';\r\nimport { AlgorithmRetrievalService } from 'src/app/algorithm-retrieval.service';\r\nimport { MatchingAlgorithm } from '../../algorithms/abstract-classes/MatchingAlgorithm';\r\nimport { AlgorithmData } from '../../algorithms/interfaces/AlgorithmData';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ExecutionService {\r\n\r\n  commandMap = {}\r\n  commandList = {};\r\n\r\n  // add the services for any new algorithms here\r\n  constructor(\r\n    public algorithmRetrieval: AlgorithmRetrievalService\r\n  ) { }\r\n\r\n  initialise(): void {\r\n    this.commandMap = {};\r\n    this.commandList = {};\r\n  }\r\n\r\n  getExecutionFlow(algorithm: string, numberOfAgents: number, numberOfGroup2Agents: number = numberOfAgents, preferences: Map<String, Array<String>>, SRstable: boolean = true): Object {\r\n    this.initialise();\r\n    let algorithmService: MatchingAlgorithm = this.algorithmRetrieval.mapOfAvailableAlgorithms.get(algorithm).service;\r\n    this.commandMap = this.algorithmRetrieval.mapOfAvailableAlgorithms.get(algorithm).helpTextMap;\r\n    // console.log(this.commandMap);\r\n\r\n    console.log(\"get execution flow\", SRstable)\r\n    let commandList: AlgorithmData = algorithmService.run(numberOfAgents, numberOfGroup2Agents, preferences, SRstable);\r\n\r\n    commandList.descriptions = this.generateDescriptions(commandList);\r\n\r\n    console.log(commandList);\r\n\r\n    // this.drawService.redrawCanvas(commandList[\"commands\"][0]);\r\n\r\n    return commandList;\r\n  }\r\n\r\n\r\n\r\n  // --------------------------------------------------------- FUNCTIONS TO GENERATE LINE DESCRIPTIONS\r\n\r\n  generateDescriptions(commandList: AlgorithmData): String[] {\r\n    let descriptions = [];\r\n\r\n    for (let step of commandList[\"commands\"]) {\r\n\r\n      let lineNumber = step[\"lineNumber\"];\r\n      let stepVariables = step[\"stepVariables\"];\r\n\r\n      if (stepVariables) {\r\n        descriptions.push(this.generateMessage(lineNumber, stepVariables));\r\n      } else {\r\n        descriptions.push(this.commandMap[lineNumber]);\r\n      }\r\n    }\r\n\r\n    return descriptions;\r\n  }\r\n\r\n\r\n  generateMessage(commandNum: number, replacements: Object): string {\r\n\r\n    var str = this.commandMap[commandNum];\r\n\r\n    // FROM: https://stackoverflow.com/questions/7975005/format-a-javascript-string-using-placeholders-and-an-object-of-substitutions\r\n    str = str.replace(/%\\w+%/g, function(all: string | number) {\r\n      return replacements[all] || all;\r\n    });\r\n\r\n    return str;\r\n  }\r\n  \r\n\r\n}","import { Injectable } from '@angular/core';\r\nimport { ExecutionService } from '../execution/execution.service';\r\nimport { CanvasService } from '../canvas/canvas.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class PlaybackService {\r\n\r\n  // algorithm data variables\r\n  public algorithmData: Object;\r\n  commandList: Array<Object>;\r\n  currentCommand: Object;\r\n\r\n  // playback variables\r\n  firstRun: boolean = true;\r\n  stepCounter: number;\r\n  previousStepCounter: number;\r\n  currentLine: number;\r\n  numCommands: number;\r\n  pause: boolean = true;\r\n  speed: number = 500;\r\n\r\n  description: string = \"Click play to run the program below!\";\r\n\r\n  constructor(public exeService: ExecutionService, public drawService: CanvasService) { }\r\n\r\n  initialise(): void {\r\n    this.algorithmData = {};\r\n    this.commandList = [];\r\n    this.currentCommand = {};\r\n  }\r\n\r\n  resetPlaybackData(): void {\r\n    this.firstRun = true;\r\n    this.stepCounter = 0;\r\n    this.previousStepCounter = 0;\r\n    this.currentLine = 0;\r\n    this.pause = true;\r\n\r\n    this.description = \"Click play to run the program below!\";\r\n  }\r\n\r\n  setAlgorithm(algorithm: string, numberOfAgents: number, numberOfGroup2Agents: number = numberOfAgents, preferences: Map<String, Array<String>> = null, SRstable: boolean = true): void {\r\n\r\n    this.initialise();\r\n    console.log(\"Set algorithm\", SRstable)\r\n    this.algorithmData = this.exeService.getExecutionFlow(algorithm, numberOfAgents, numberOfGroup2Agents, preferences, SRstable);\r\n    this.commandList = this.algorithmData[\"commands\"];\r\n    this.resetPlaybackData();\r\n    this.numCommands = this.commandList.length-1;\r\n\r\n    // console.log(this.algorithmData);\r\n    this.updateCurrentCommand();\r\n\r\n  }\r\n\r\n  setSpeed(milliseconds: number) {\r\n    this.speed = milliseconds;\r\n  }\r\n\r\n  updateCurrentCommand(): void {\r\n    if (this.previousStepCounter != this.stepCounter) {\r\n      this.previousStepCounter = this.stepCounter;\r\n    }\r\n\r\n    this.currentCommand = this.algorithmData[\"commands\"][this.stepCounter];\r\n    this.description = this.algorithmData[\"descriptions\"][this.stepCounter];\r\n    this.currentLine = this.currentCommand[\"lineNumber\"];\r\n    this.drawService.redrawCanvas(this.currentCommand);\r\n  }\r\n\r\n\r\n  restart(): void {\r\n    this.pause = true;\r\n    this.uncolourCurrentLine();\r\n    this.stepCounter = 0;\r\n    this.updateCurrentCommand();\r\n    this.colourCurrentLine();\r\n  }\r\n\r\n  goToEnd(): void {\r\n    this.pause = true;\r\n    this.uncolourCurrentLine();\r\n    this.stepCounter = this.numCommands;\r\n    this.updateCurrentCommand();\r\n    this.colourCurrentLine();\r\n  }\r\n\r\n  backStep(): void {\r\n    this.uncolourCurrentLine();\r\n    if (this.stepCounter > 0) { this.stepCounter--; }\r\n    this.updateCurrentCommand();\r\n    this.colourCurrentLine(); \r\n  }\r\n\r\n  forwardStep(): void {\r\n    this.uncolourCurrentLine();\r\n    if (this.stepCounter < this.numCommands) { this.stepCounter++; }\r\n    this.updateCurrentCommand();\r\n    this.colourCurrentLine();\r\n  }\r\n\r\n  async toggle() {\r\n    if (this.firstRun) {\r\n      this.firstRun = false;\r\n      this.pause = false;\r\n      this.play();\r\n    } else {\r\n      if (this.pause) {\r\n        this.pause = false;\r\n        this.play();\r\n      } else {\r\n        this.pause = true;\r\n      }\r\n    }\r\n  }\r\n\r\n  async play(): Promise<void> {\r\n    while (this.stepCounter < this.numCommands) {\r\n\r\n      if (this.pause) {\r\n        console.log(\"Paused at step \" + (this.stepCounter) + \"!\");\r\n        console.log(\"Current Line: \" + this.currentLine);\r\n        break;\r\n      }\r\n\r\n      this.colourCurrentLine();\r\n\r\n      await this.sleep(this.speed);\r\n\r\n      if (!this.pause) {\r\n        // console.log(this.stepCounter + \" | \" + this.numCommands);\r\n        this.uncolourCurrentLine();\r\n        this.stepCounter++;\r\n        this.updateCurrentCommand();\r\n        if (this.stepCounter >= this.numCommands) {\r\n          this.pause = true;\r\n        }\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n  async sleep(msec: number) {\r\n    return new Promise(resolve => setTimeout(resolve, msec));\r\n  }\r\n\r\n\r\n  uncolourCurrentLine(): void {\r\n    let codeLineHTML = document.getElementById(\"line\" + this.currentLine);\r\n    codeLineHTML.style.backgroundColor = \"\";\r\n    codeLineHTML.style.color = \"\";\r\n  }\r\n\r\n  colourCurrentLine(): void {\r\n    let codeLineHTML = document.getElementById(\"line\" + this.currentLine);\r\n    codeLineHTML.style.backgroundColor = \"black\";\r\n    codeLineHTML.style.color = \"#37FF00\";\r\n  }\r\n\r\n\r\n  onSliderChange(val: number) {\r\n\r\n    if (this.firstRun) {\r\n      this.firstRun = false;\r\n    }\r\n\r\n    if (this.previousStepCounter != this.stepCounter) {\r\n      this.previousStepCounter = this.stepCounter;\r\n    }\r\n\r\n    this.pause = true;\r\n\r\n    this.stepCounter = val;\r\n\r\n    var command = this.commandList[this.previousStepCounter];\r\n    let a = document.getElementById(\"line\" + command[\"lineNumber\"]);\r\n    a.style.backgroundColor = \"\";\r\n    a.style.color = \"\";\r\n\r\n    this.updateCurrentCommand();\r\n    \r\n    this.colourCurrentLine();\r\n  }\r\n\r\n\r\n  // unboldenVariables(): void {\r\n\r\n  //   var command = this.commandList[this.stepCounter-1];\r\n  //   let changeTrace = command[\"changeTrace\"][\"embolden\"];\r\n\r\n  //   console.log(changeTrace);\r\n\r\n  //   for (let className of changeTrace) {\r\n  //     let a = document.getElementsByClassName(className);\r\n  //     for (let i = 0; i < a.length; i++) {\r\n  //       a[i].setAttribute(\"style\", \"font-weight: normal;\");\r\n  //     }\r\n  //   }\r\n  // }\r\n\r\n  // unboldenPreviousVariables(): void {\r\n\r\n  //   var command = this.commandList[this.previousStepCounter];\r\n  //   let changeTrace = command[\"changeTrace\"][\"embolden\"];\r\n\r\n  //   console.log(changeTrace);\r\n\r\n  //   for (let className of changeTrace) {\r\n  //     let a = document.getElementsByClassName(className);\r\n  //     for (let i = 0; i < a.length; i++) {\r\n  //       a[i].setAttribute(\"style\", \"font-weight: normal;\");\r\n  //     }\r\n  //   }\r\n  // }\r\n\r\n  // unboldenCurrentVariables(): void {\r\n\r\n  //   var command = this.commandList[this.stepCounter];\r\n  //   let changeTrace = command[\"changeTrace\"][\"embolden\"];\r\n\r\n  //   console.log(changeTrace);\r\n\r\n  //   for (let className of changeTrace) {\r\n  //     let a = document.getElementsByClassName(className);\r\n  //     for (let i = 0; i < a.length; i++) {\r\n  //       a[i].setAttribute(\"style\", \"font-weight: normal;\");\r\n  //     }\r\n  //   }\r\n  // }\r\n\r\n\r\n  // emboldenVariables(): void {\r\n\r\n  //   var command = this.commandList[this.stepCounter];\r\n  //   let changeTrace = command[\"changeTrace\"][\"embolden\"];\r\n\r\n  //   for (let className of changeTrace) {\r\n  //     let a = document.getElementsByClassName(className);\r\n  //     for (let i = 0; i < a.length; i++) {\r\n  //       a[i].setAttribute(\"style\", \"font-weight: bold;\");\r\n  //     }\r\n  //   }\r\n  // }\r\n\r\n}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { PlaybackService } from '../../services/playback/playback.service';\r\n\r\n@Component({\r\n  selector: 'alg-description',\r\n  templateUrl: './alg-description.component.html',\r\n  styleUrls: ['./alg-description.component.scss', '../sidebar.component.scss']\r\n})\r\nexport class AlgDescriptionComponent implements OnInit {\r\n\r\n  constructor(public playback: PlaybackService) { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n}\r\n","<div class=\"row text-center border-bottom px-5\" id=\"descriptionDiv\">\r\n    <h3 class=\"col-12 h2 sidebarPopover my-auto text-center pr-4\" id=\"algorithmDescription\" data-toggle=\"popover\" data-placement=\"left\" title=\"Current Line Description\"\r\n    data-content=\"This gives you a description of what's happening in the algorithm at this step with reference to the variables involved.\" data-trigger=\"manual\"\r\n    data-template='<div class=\"popover fade show bs-popover-right popoverPositioning blackText\" role=\"tooltip\"><div class=\"arrow\"></div><h3 class=\"popover-header\"></h3><div class=\"popover-body\"></div></div>'>\r\n        {{ this.playback.description }}\r\n    </h3>\r\n</div>","import { Component, OnInit } from '@angular/core';\r\nimport { PlaybackService } from '../../services/playback/playback.service';\r\n\r\n@Component({\r\n  selector: 'execution-log',\r\n  templateUrl: './execution-log.component.html',\r\n  styleUrls: ['./execution-log.component.scss', '../sidebar.component.scss']\r\n})\r\nexport class ExecutionLogComponent implements OnInit {\r\n\r\n  constructor(public playback: PlaybackService) { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n}\r\n","<div class=\"sidebarPopover\" id=\"executionTrace\" data-toggle=\"popover\" data-placement=\"left\" title=\"Execution Trace\" data-content=\"This will fill out as you play the algorithm with a log of all current line descriptions, so you can go back and get a better idea of what happens at certain parts in the algorithm!\" data-trigger=\"manual\"\r\n  data-template='<div class=\"popover fade show bs-popover-right popoverPositioning blackText\" style=\"color:black\" role=\"tooltip\"><div class=\"arrow\"></div><h3 class=\"popover-header\"></h3><div class=\"popover-body\"></div></div>'>\r\n  <h1 class=\"pt-4 pl-3\" style=\"color:rgb(231, 231, 231); font-weight: 300; margin-bottom: 0; padding-bottom: 0; font-size: 1.4vw;\">\r\n    Execution Log\r\n  </h1>\r\n  <ol start=0 class=\"pt-3 pb-4\" style=\"width: 100%; display: table; margin: 0; vertical-align: middle; background-color: #1b1f23; padding-left: 30px; font-size: 0.8vw; line-height: 1.2vw;\">\r\n    <li class=\"mb-4 pr-2\" *ngFor=\"let line of this.playback.algorithmData['descriptions'].slice(0, this.playback.stepCounter + 1)\">\r\n      {{ line }}.\r\n    </li>\r\n  </ol>\r\n</div>","import { Component, OnInit } from '@angular/core';\r\nimport { AlgorithmRetrievalService } from 'src/app/algorithm-retrieval.service';\r\nimport { PlaybackService } from '../../services/playback/playback.service';\r\n\r\n@Component({\r\n  selector: 'free-agents',\r\n  templateUrl: './free-agents.component.html',\r\n  styleUrls: ['./free-agents.component.scss', '../sidebar.component.scss']\r\n})\r\nexport class FreeAgentsComponent implements OnInit {\r\n\r\n  constructor(\r\n    public playback: PlaybackService,  // injecting the playback service\r\n    public algorithmService: AlgorithmRetrievalService) {}  // injecting the algorithm service) { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n}\r\n","<div class=\"border-bottom align-items-center\">\r\n    <div class=\"row align-items-center mx-2\" style=\"height: 100%\">\r\n      <div class=\"col-4 pr-2\" style=\"font-size: 22px;\">\r\n        <span style=\"font-size: 0.9vw;\">Free {{ this.algorithmService.pluralMap.get(this.algorithmService.currentAlgorithm.orientation[0]) }}:</span>\r\n      </div>\r\n      <div class=\"col-8 text-center pr-5 py-3\" style=\"font-size: 0.9vw;\">\r\n        [\r\n        <span *ngFor=\"let item of this.playback.commandList[this.playback.stepCounter]['freeAgents']; let lastItem = last;\">\r\n          <span class=\"{{ item }}\">{{ item.slice(item.length - 1) }}</span><span *ngIf=\"!lastItem\">, </span>\r\n        </span>\r\n        ]\r\n      </div>\r\n    </div>\r\n</div>","import { Component, OnInit } from '@angular/core';\r\nimport { AlgorithmRetrievalService } from 'src/app/algorithm-retrieval.service';\r\nimport { PlaybackService } from '../../services/playback/playback.service';\r\n\r\n@Component({\r\n  selector: 'pseudocode',\r\n  templateUrl: './pseudocode.component.html',\r\n  styleUrls: ['./pseudocode.component.scss', '../sidebar.component.scss']\r\n})\r\nexport class PseudocodeComponent implements OnInit {\r\n\r\n  algorithm: string;\r\n  animate: boolean = true;\r\n\r\n  constructor(public playback: PlaybackService, public algService: AlgorithmRetrievalService) { }\r\n\r\n  ngOnInit(): void {\r\n    this.algorithm = this.algService.currentAlgorithm.id;\r\n  }\r\n\r\n}\r\n","<div class=\"border-bottom sidebarPopover mr-2\" style=\"background-color: #1b1f23; max-width: 100%;\" data-toggle=\"popover\" data-placement=\"left\" title=\"Code Display\" data-content=\"This highlights the current line that's being executed in the algorithm as you play or drag the playback slider.\" data-trigger=\"manual\"\r\ndata-template='<div class=\"popover fade show bs-popover-right popoverPositioning blackText\" role=\"tooltip\"><div class=\"arrow\"></div><h3 class=\"popover-header\"></h3><div class=\"popover-body\"></div></div>'>\r\n    <h1 class=\"pt-4 pl-3\" style=\"color:rgb(231, 231, 231); font-weight: 300; margin-bottom: 0; padding-bottom: 0; font-size: 1.4vw;\">\r\n        Pseudocode\r\n    </h1>\r\n\r\n    <div style=\"white-space: pre; height: 100%; vertical-align: middle; font-size: 0.8vw; line-height: 1.2vw; margin: 0; color:rgb(231, 231, 231); width: 100%\">\r\n        <ol class=\"pt-3 pb-4\" style=\"width: 100%; display: table; margin: 0; vertical-align: middle; background-color: #1b1f23; padding-left: 30px;\">\r\n            <div style=\"display: table-row; width: 100%; vertical-align: middle; margin: 0; \" *ngFor=\"let line of this.algService.currentAlgorithm.code; let i = index\" id=\"line{{i+1}}\">\r\n                <li class=\"pl-2\" style=\"vertical-align: middle; width: 100%; tab-size: 0.8vw; word-wrap: break-word; white-space: pre-wrap\">\r\n                    {{ line }}\r\n                </li>\r\n            </div>\r\n        </ol>\r\n    </div>   \r\n</div>\r\n","import { Component, Input, OnInit } from '@angular/core';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { Router } from '@angular/router';\r\nimport { AlgorithmRetrievalService } from 'src/app/algorithm-retrieval.service';\r\nimport { UtilsService } from 'src/app/utils/utils.service';\r\nimport { AlgorithmAnimationService } from '../animations/algorithm-animation.service';\r\nimport { CanvasService } from '../services/canvas/canvas.service';\r\nimport { PlaybackService } from '../services/playback/playback.service';\r\n\r\n@Component({\r\n  selector: 'sidebar',\r\n  templateUrl: './sidebar.component.html',\r\n  styleUrls: ['./sidebar.component.scss']\r\n})\r\nexport class SidebarComponent implements OnInit {\r\n\r\n  @Input() showCode: boolean;\r\n  @Input() tutorialStep: number;\r\n\r\n  constructor(\r\n    public playback: PlaybackService,  // injecting the playback service\r\n    public algorithmService: AlgorithmRetrievalService,  // injecting the algorithm service\r\n    public drawService: CanvasService,  // injecting the canvas service\r\n    public animation: AlgorithmAnimationService,\r\n    public utils: UtilsService,\r\n    public dialog: MatDialog,  // injecting the dialog component\r\n    public router: Router  // injecting the router service (for programmatic route navigation)\r\n  ) { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n}\r\n","<nav class=\"d-none sidebar\" [ngClass]=\"{'col-md-3 d-md-block': !this.showCode, 'moveContentToTop': this.tutorialStep == 2}\">\r\n    <div class=\"sidebar-sticky shadow-lg\">\r\n      <div class=\"grid-container-algorithm\" id=\"sidebarContent\">\r\n\r\n        <!-- Algorithm Description -->\r\n        <alg-description></alg-description>\r\n\r\n\r\n        <!-- Free Agents -->\r\n        <free-agents></free-agents>\r\n\r\n\r\n        <!-- Code Display -->\r\n        <pseudocode></pseudocode>\r\n\r\n\r\n        <!-- Execution Log -->\r\n        <execution-log style=\"overflow: auto;\"></execution-log>\r\n\r\n      </div>\r\n  </div>\r\n</nav>","import { Injectable } from '@angular/core';\r\nimport { Algorithm } from './Algorithm';\r\nimport { HrResidentEgsService } from './algorithm-page/algorithms/algorithm-services/hr-resident-egs/hr-resident-egs.service';\r\nimport { EgsStableMarriageService } from './algorithm-page/algorithms/algorithm-services/smp-man-egs/egs-stable-marriage.service';\r\nimport { GsStableMarriageService } from './algorithm-page/algorithms/algorithm-services/smp-man-gs/gs-stable-marriage.service';\r\nimport { StableRoomIrvService } from './algorithm-page/algorithms/algorithm-services/smp-room-irv/stable-room-irv.service';\r\nimport { HrHospitalEgsService } from './algorithm-page/algorithms/algorithm-services/hr-hospital-egs/hr-hospital-egs.service';\r\n\r\n\r\n// ------------------------------------------------------- ALGORITHM TEMPLATE\r\n\r\n// [\r\n//   \"smp-man-egs\", {\r\n//     id: \"smp-man-egs\",\r\n//     name: \"Stable Marriage Problem\",\r\n//     orientation: [\"Man\", \"Woman\"],\r\n//     algorithm: \"Extended Gale-Shapley Stable Matching\",\r\n//     service: null,\r\n//     description: \"The stable marriage problem is the problem of finding a stable matching between two equally sized sets of elements. In this case: <b>men and women</b>.<br><br>To do this, the Extended Gale-Shapley Stable Marriage algorithm is used.\",\r\n//     helpTextMap: {\r\n\r\n//     },\r\n//   }\r\n// ],\r\n\r\n// -------------------------------------------------------\r\n\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class AlgorithmRetrievalService {\r\n\r\n  currentAlgorithm: Algorithm;\r\n\r\n  numberOfGroup1Agents: number = 5;\r\n  numberOfGroup2Agents: number = 5;\r\n\r\n  mapOfAvailableAlgorithms: Map<String, Algorithm> = new Map([\r\n    [\r\n      \"smp-man-gs\", {\r\n        id: \"smp-man-gs\",\r\n        name: \"Stable Marriage Problem\",\r\n        orientation: [\"Man\", \"Woman\"],\r\n        equalGroups: true,\r\n        algorithm: \"Gale-Shapley Stable Matching\",\r\n        service: this.gsStableMarriageService,\r\n        description: \"The stable marriage problem is the problem of finding a stable matching between two equally sized sets of elements. In this case: <b>men and women</b>.<br><br>To do this, the Gale-Shapley Stable Marriage algorithm is used.\",\r\n        helpTextMap: {\r\n          1: \"Ensure there are no pre-existing matches between men and women\",\r\n          2: \"While there is still a man without a match, select the first one (%man%)\",\r\n          3: \"%woman% is selected as %man%'s most preferred woman who he has not yet proposed to\",\r\n          4: \"Checking to see if %woman% has a match\",\r\n          5: \"%woman% was free, so matching her with %man%\",\r\n          6: \"%woman% is currently matched to %match%, so can't instantly engage %woman% and %man%\",\r\n          7: \"Checking if %woman% likes %match% more than %man%\",\r\n          8: \"%woman% likes %man% (current proposer) more than %match% (current match) so free %match% and engage %woman% and %man%\",\r\n          9: \"%woman% likes %match% more than %man%\",\r\n          10: \"No change to anyone's matches\",\r\n          11: \"A stable matching has been generated.\"\r\n        },\r\n        code: [\r\n          \"set each person to be free;\",\r\n          \"while some man m is free do:\",\r\n          \"\\tw = next most preferred woman on m’s list;\",\r\n          \"\\tif w is free then\",\r\n          \"\\t\\tassign m to w;\",\r\n          \"\\telse\",\r\n          \"\\t\\tif w prefers m to her current partner m' then\",\r\n          \"\\t\\t\\tassign m to w to be engaged and set m' to be free;\",\r\n          \"\\t\\telse\",\r\n          \"\\t\\t\\tw rejects m’s proposal and remains with m';\",\r\n          \"the stable matching consists of all n engagements\"\r\n        ]\r\n      }\r\n    ],\r\n\r\n    [\r\n      \"smp-man-egs\", {\r\n        id: \"smp-man-egs\",\r\n        name: \"Stable Marriage Problem\",\r\n        orientation: [\"Man\", \"Woman\"],\r\n        equalGroups: true,\r\n        algorithm: \"Extended Gale-Shapley Stable Matching\",\r\n        service: this.egsStableMarriageService,\r\n        description: \"The stable marriage problem is the problem of finding a stable matching between two equally sized sets of elements. In this case: <b>men and women</b>.<br><br>To do this, the Extended Gale-Shapley Stable Marriage algorithm is used.\",\r\n        helpTextMap: {\r\n          1: \"Set all men and women to have no engagements\",\r\n          2: \"While there are some men who are not engaged, select the next one (%currentAgent%)\",\r\n          3: \"%potentialProposee% is selected as %currentAgent%'s most preferred woman who he has not yet proposed to\",\r\n          4: \"Check if %woman% is currently engaged to someone\",\r\n          5: \"%woman% is engaged to %currentPartner%, so break the engagement between them\",\r\n          6: \"%woman% is not engaged, so continue with algorithm\",\r\n          7: \"Engage %man% and %woman%\",\r\n          8: \"Select each man with a worse preference ranking than %man% on %woman%\\'s list\",\r\n          9: \"%nextWorstMan% is chosen as the next worst man on %woman%\\'s preference list\",\r\n          10: \"Remove %nextWorstMan% and %woman% from each other\\'s lists\",\r\n          11: \"All men worse than %man% on %woman%\\'s preference list have been removed\",\r\n          12: \"A stable matching between men and women has been found\",\r\n        },\r\n        code: [\r\n          \"set each person to be free;\",\r\n          \"while some man m is free {\",\r\n          \"\\tw = first woman on m's list\",\r\n          \"\\tif w is currently engaged to someone {\",\r\n          \"\\t\\tbreak engagement between w and w's current partner\",\r\n          \"\\t}\",\r\n          \"\\tprovisionally engage m and w\",\r\n          \"\\tfor each successor m'' of m on w's list {\",\r\n          \"\\t\\tm'' = next worst man on w's preference list\",\r\n          \"\\t\\tremove m'' from w's preference list and vice versa\",\r\n          \"\\t}\",\r\n          \"}\"   // a stable matching between men and women has been found\r\n        ]\r\n      }\r\n    ],\r\n\r\n    [\r\n      \"hr-resident-egs\", {\r\n        id: \"hr-resident-egs\",\r\n        name: \"Hospitals/Residents Problem\",\r\n        orientation: [\"Resident\", \"Hospital\"],\r\n        equalGroups: false,\r\n        algorithm: \"Extended Gale-Shapley Stable Matching\",\r\n        service: this.HrResidentEgsService,\r\n        description: \"The Hospitals/Residents Problem is the problem of finding a stable matching between a set of <b>hospitals and residents</b>, where a hospital can take multiple residents.<br><br>This is the <b>resident-oriented</b> version of the algorithm, so <b>residents will propose to hospitals</b>.<br><br>To do this, the Extended Gale-Shapley Stable Marriage algorithm is used.\",\r\n        helpTextMap: {\r\n          1: \"Clear the matches of all residents and hospitals\",\r\n          2: \"The next resident who doesn't have a match and still has some hospitals in their preference list is selected (%currentAgent%\\)\",\r\n          3: \"The first hospital on %currentAgent%\\'s preference list is selected (%potentialProposee%)\",\r\n          4: \"Check if %hospital% is currently full: is it already matched with %capacity% resident(s)? If not, provisionally assign %resident% to %hospital%\",\r\n          5: \"%hospital%'s number of residents is equal to its max capacity, so choose the worst resident assigned to %hospital% (%worstResident%)\",\r\n          6: \"Clear the match between %hospital% and %worstResident%\",\r\n          7: \"Assign %resident% to %hospital%\",\r\n          8: \"Check if %hospital% is full after assigning %resident% to %hospital%\",\r\n          9: \"%hospital% is fully subscribed, so choose the worst resident assigned to them (%worstResident%) and remove each successor from %hospital%'s preference list\",\r\n          10: \"%nextResident% is chosen as the next resident to be removed from %hospital%'s list\",\r\n          11: \"Remove %nextResident% from %hospital%'s list\",\r\n          12: \"A stable matching between residents and hospitals has been found\",\r\n        },\r\n        code: [\r\n          \"set each hospital and resident to be completely free;\",\r\n          \"while (some resident r is free) and (r has a nonempty list)\",\r\n          \"\\th := first hospital on r's list\",\r\n          \"\\tif h is fully subscribed then\",\r\n          \"\\t\\tr' := worst resident provisionally assigned to h\",\r\n          \"\\t\\tassign r' to be free (clear match)\",\r\n          \"\\tprovisionally assign r to h\",\r\n          \"\\tif h is fully subscribed (after assigning r to h) then\",\r\n          \"\\t\\ts := worst resident provisionally assigned to h\",\r\n          \"\\t\\tfor each successor s' of s on h's list\",\r\n          \"\\t\\t\\tremove s' and h from each other's lists\",\r\n          \"the stable matching consists of all n engagements\"\r\n        ]\r\n      }\r\n    ],\r\n\r\n    // ADD NEW ALGORITHMS UNDER HERE\r\n\r\n    [\r\n      \"smp-room-irv\", {\r\n        id: \"smp-room-irv\",\r\n        name: \"Stable Roommates Problem\",\r\n        orientation: [\"Person\", \"Person\"],\r\n        equalGroups: true,\r\n        algorithm: \"Stable Roommates - Irving's Algorithm\",\r\n        service: this.StableRoomIrvService,\r\n        description: \"The stable roommates problem is the problem of finding a stable matching between 1 group of elements. In this case <b>people</b>.<br> <br>To do this the Irving’s algorithm is used \",\r\n        helpTextMap: {\r\n          1: \"Set all people to be free\",\r\n          2 : \"While some person %person% has not been assigned to a anyone and has a non-empty preferance list\",\r\n          3 : \"check if %person%\\'s preferance list is empty\",\r\n          4 : \"end the algorithm, there is no stable matching\",\r\n\r\n          5 : \"the first person on %person%\\'s preferance list is selected - %selected%\",\r\n          6 : \"set %person%\\ to be provisonally assigned to selected person %selected%\",\r\n\r\n          7 : \"check if any other person, other than %person% is assigned to %selected% \",\r\n          8 : \"If they are, then unassign them. unassign %old_person% from %selected%\",\r\n\r\n          9 : \"look through %selected%\\'s preferance list - %list%, for each person less prefered than %person%\",\r\n          10 : \"remove %removee% from %person%\\'s preferance list and remove %person% from %removee%\\'s preferance list\",\r\n\r\n          11 : \"While some person %person% has more then 1 person left in their preferance list - %list%\",\r\n          12 : \"look for rotations within %person%\\'s preferance list, that is a cycle of ordered pairs through preferance lists\",\r\n          13 : \"if a rotation is found\", //%rotation%\r\n          14 : \"delete pairs in rotation - remove %removee% from %person%\\'s preferance list and remove %person% from %removee%\\'s preferance list\",\r\n\r\n          15 : \"check if any person has only 1 preferance left\",\r\n          16 : \"assign %person% to the last person in their preferance list - %preferance%\",\r\n          17 : \"check if %person%\\'s preferance list is empty\",\r\n          18 : \"end the algorithm, there is no stable matching\",\r\n         \r\n          19 : \"Stable mathcing found.\",\r\n\r\n\r\n        },\r\n        code: [\r\n          \"Set each person to be free\",\r\n          \"While some person p is free (not assigned to someone)\",\r\n          \"\\t if person p has a empty preferance list\",\r\n          \"\\t\\t end - no stable matching\",\r\n\r\n          \"\\t person b := first preferance on p's list\",\r\n           \"\\t assign p to b\",\r\n\r\n          \"\\t if any person a is assigned to person b\",\r\n          \"\\t\\t free a\",\r\n\r\n          \"\\t for each person c less preferded than p on b's, preferance list\",\r\n          \"\\t\\t remove c from p's list and remove p from c's list\",\r\n          // 10 lines so far \r\n\r\n          // PAHSE 2\r\n          \"While some person p has more than 1 preferance left\",\r\n          \"look for rotations in perosn p's preferance list\",\r\n          \"if rotation r is found\",\r\n          \"\\t delete pairs in rotation r\",\r\n\r\n\r\n          \"\\t if a person b has 1 perferance left\",\r\n          \"\\t\\t person b := last preferance\",\r\n\r\n          \"if any people have empty preferance lists\",\r\n          \"\\t end - no stable matching\",\r\n         \r\n\r\n          \"done\"\r\n          // 11 ---> 17 lines \r\n          \r\n          \r\n        ]\r\n      }\r\n    ],\r\n\r\n    \r\n    [\r\n      \"hr-hospital-egs\", {\r\n        id: \"hr-hospital-egs\",\r\n        name: \"Hospitals/Residents Problem\",\r\n        orientation: [\"Hospital\", \"Resident\"],\r\n        equalGroups: false,\r\n        algorithm: \"Extended Gale-Shapley Stable Matching\",\r\n        service: this.HrHospitalEgsService,\r\n        description: \"The Hospitals/Residents Problem is the problem of finding a stable matching between a set of <b>hospitals and residents</b>, where a hospital can take multiple residents.<br><br>This is the <b>hospital-oriented</b> version of the algorithm, so <b>hospitals will propose to residents</b>.<br><br>To do this, the Extended Gale-Shapley Stable Marriage algorithm is used.\",\r\n        helpTextMap: {\r\n          1 : \"Set all hospitals and residents to be completely free\",\r\n          2 : \"While some hospital (%hospital%) is undersubscribed and has a resident on their preferance list that is not assigned to them\",\r\n          3 : \"Set r to %resident% from hospital's preferance list\",\r\n          4 : \"If %resident% is assigned to another hospital, unassign them from each other\",\r\n          5 : \"Unassign %resident% and %oldHospital% from each other\",\r\n          6 : \"Assign %resident% and %hospital% to each other\",\r\n          7 : \"For each resident r' after %resident% on %hospital%'s preferance list, remove them from each others preferance list\",\r\n          8 : \"remove %resident% from %hospital%'s preferance list and %hospital% from %resident%'s preferance list\",\r\n          9 : \"Stable matching is found\",\r\n\r\n          \r\n        },\r\n        code: [\r\n          \"Set each hospital and resident to be completely free\",\r\n          \"While some hospital h is undersubscibed, and has a resident on their preferance list\",\r\n          \"\\t r := first resident on h's prefernace list not assigned to h\",\r\n          \"\\t if r is assigned to another hospital h'\",\r\n          \"\\t\\t unassign r and h'\",\r\n          \r\n          \"\\t provisionally assign r to h\",\r\n          \"\\t for each successor r' of r on h's list\",\r\n          \"\\t\\t remove r' and h from each others preferance list\",\r\n          \"stable matching is found \"\r\n          \r\n         \r\n        ]\r\n\r\n    \r\n      }\r\n    ],\r\n\r\n\r\n  ]);\r\n\r\n  pluralMap: Map<string, string> = new Map([\r\n    [\"Man\", \"Men\"],\r\n    [\"Woman\", \"Women\"],\r\n    [\"Resident\", \"Residents\"],\r\n    [\"Hospital\", \"Hospitals\"],\r\n    [\"Person\", \"People\"],\r\n\r\n  ]);\r\n\r\n  constructor(\r\n    public gsStableMarriageService: GsStableMarriageService,\r\n    public egsStableMarriageService: EgsStableMarriageService,\r\n    public HrResidentEgsService: HrResidentEgsService,\r\n    public StableRoomIrvService: StableRoomIrvService,\r\n    public HrHospitalEgsService: HrHospitalEgsService,\r\n  ) { }\r\n\r\n  getListOfAlgorithms(): Array<Algorithm> {\r\n    return Array.from(this.mapOfAvailableAlgorithms.values());\r\n  }\r\n\r\n}\r\n","import { animate, animateChild, group, query, state, style, transition, trigger } from \"@angular/animations\";\r\n\r\nexport const simpleFadeAnimation =\r\n    // the fade-in/fade-out animation.\r\n    trigger('simpleFadeAnimation', [\r\n\r\n        // the \"in\" style determines the \"resting\" state of the element when it is visible.\r\n        state('in', style({opacity: 1})),\r\n  \r\n        // fade in when created. this could also be written as transition('void => *')\r\n        transition(':enter', [\r\n          style({opacity: 0}),\r\n          animate('400ms 0ms cubic-bezier(0.5, 0, 0.75, 0)')\r\n        ]),\r\n  \r\n        // fade out when destroyed. this could also be written as transition('void => *')\r\n        transition(':leave',\r\n          animate(500, style({opacity: 0})))\r\n      ]);","import { Component } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-root',\r\n  templateUrl: './app.component.html',\r\n  styleUrls: ['./app.component.scss'],\r\n})\r\nexport class AppComponent {\r\n\r\n  title = 'individual-project';\r\n\r\n}\r\n","<router-outlet></router-outlet>","import { BrowserModule } from '@angular/platform-browser';\r\nimport { NgModule } from '@angular/core';\r\n\r\nimport { AppRoutingModule } from './routing/app-routing.module';\r\nimport { AppComponent } from './app.component';\r\nimport { AlgorithmPageComponent } from './algorithm-page/algorithm-page.component';\r\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations';\r\nimport {FormsModule, ReactiveFormsModule} from '@angular/forms';\r\n\r\nimport {MatSelectModule} from '@angular/material/select';\r\nimport {MatFormField, MatFormFieldModule} from '@angular/material/form-field';\r\nimport {MatSliderModule} from '@angular/material/slider';\r\nimport {MatIconModule} from '@angular/material/icon';\r\nimport {MatButtonModule} from '@angular/material/button';\r\nimport {MatTabsModule} from '@angular/material/tabs';\r\nimport {MatCardModule} from '@angular/material/card';\r\nimport {MatDialogModule} from '@angular/material/dialog';\r\nimport {MatInputModule} from '@angular/material/input';\r\nimport {MatTooltipModule} from '@angular/material/tooltip';\r\nimport {MatSnackBarModule} from '@angular/material/snack-bar';\r\nimport { MatAnimatedIconComponent } from './algorithm-page/mat-animated-icon/mat-animated-icon.component';\r\nimport { PlaybackControlsComponent } from './algorithm-page/playback-controls/playback-controls.component';\r\nimport { CodeDisplayComponent } from './algorithm-page/code-display/code-display.component';\r\nimport { HomePageComponent } from './home-page/home-page.component';\r\nimport { AngularResizedEventModule } from 'angular-resize-event';\r\nimport { HomeContentComponent } from './home-page/home-content/home-content.component';\r\nimport { AboutContentComponent } from './home-page/about-content/about-content.component';\r\nimport { AlgorithmContentComponent } from './home-page/algorithm-content/algorithm-content.component';\r\nimport { FeedbackContentComponent } from './home-page/feedback-content/feedback-content.component';\r\nimport { AlgorithmCardComponent } from './home-page/algorithm-content/algorithm-card/algorithm-card.component';\r\nimport { IconBannerComponent } from './home-page/icon-banner/icon-banner.component';\r\nimport { FeedbackBannerComponent } from './home-page/feedback-banner/feedback-banner.component';\r\nimport { NavbarComponent } from './home-page/navbar/navbar.component';\r\nimport { EditPreferencesDialogComponent } from './algorithm-page/edit-preferences-dialog/edit-preferences-dialog/edit-preferences-dialog.component';\r\nimport { AnimationGuideDialogComponent } from './algorithm-page/animation-guide-dialog/animation-guide-dialog.component';\r\nimport { SidebarComponent } from './algorithm-page/sidebar/sidebar.component';\r\nimport { AlgDescriptionComponent } from './algorithm-page/sidebar/alg-description/alg-description.component';\r\nimport { FreeAgentsComponent } from './algorithm-page/sidebar/free-agents/free-agents.component';\r\nimport { PseudocodeComponent } from './algorithm-page/sidebar/pseudocode/pseudocode.component';\r\nimport { ExecutionLogComponent } from './algorithm-page/sidebar/execution-log/execution-log.component';\r\nimport { AlgorithmNavbarComponent } from './algorithm-page/algorithm-navbar/algorithm-navbar.component';\r\nimport { AnimationContainerComponent } from './algorithm-page/animation-container/animation-container.component';\r\nimport { AgentTitlesComponent } from './algorithm-page/animation-container/agent-titles/agent-titles.component';\r\nimport { CanvasDisplayComponent } from './algorithm-page/animation-container/canvas-display/canvas-display.component';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    AppComponent,\r\n    AlgorithmPageComponent,\r\n    MatAnimatedIconComponent,\r\n    PlaybackControlsComponent,\r\n    CodeDisplayComponent,\r\n    HomePageComponent,\r\n    HomeContentComponent,\r\n    AboutContentComponent,\r\n    AlgorithmContentComponent,\r\n    FeedbackContentComponent,\r\n    AlgorithmCardComponent,\r\n    IconBannerComponent,\r\n    FeedbackBannerComponent,\r\n    NavbarComponent,\r\n    EditPreferencesDialogComponent,\r\n    AnimationGuideDialogComponent,\r\n    SidebarComponent,\r\n    AlgDescriptionComponent,\r\n    FreeAgentsComponent,\r\n    PseudocodeComponent,\r\n    ExecutionLogComponent,\r\n    AlgorithmNavbarComponent,\r\n    AnimationContainerComponent,\r\n    AgentTitlesComponent,\r\n    CanvasDisplayComponent\r\n  ],\r\n  imports: [\r\n    BrowserModule,\r\n    AppRoutingModule,\r\n    BrowserAnimationsModule,\r\n    MatFormFieldModule,\r\n    MatSelectModule,\r\n    MatSliderModule,\r\n    MatIconModule,\r\n    MatButtonModule,\r\n    MatTabsModule,\r\n    MatCardModule,\r\n    MatDialogModule,\r\n    MatInputModule,\r\n    MatTooltipModule,\r\n    MatSnackBarModule,\r\n    FormsModule,\r\n    ReactiveFormsModule,\r\n    AngularResizedEventModule\r\n  ],\r\n\r\n\r\n  providers: [],\r\n  bootstrap: [AppComponent]\r\n})\r\nexport class AppModule { }\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { simpleFadeAnimation } from 'src/app/animations/fadeAnimation';\r\n\r\n@Component({\r\n  selector: 'app-about-content',\r\n  templateUrl: './about-content.component.html',\r\n  styleUrls: ['./about-content.component.scss', '../home-page.component.scss', '../home-content/home-content.component.scss'],\r\n  animations: [\r\n    simpleFadeAnimation\r\n  ]\r\n})\r\nexport class AboutContentComponent implements OnInit {\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n}\r\n","<div [@simpleFadeAnimation]=\"'in'\" class=\"aboutContent\">\r\n    <div class=\"container text-center py-5 my-5 col-sm-11 col-lg-8 col-xl-6\">\r\n        <h1 class=\"title-text\">Hi, I'm Liam!<br><div class=\"divider my-4\"></div><span style=\"color: #464d57;\">This app was developed for my final year project at the University of Glasgow.</span></h1>\r\n    </div>\r\n\r\n    <div class=\"py-5\" style=\"background-color: #f6f6f8\">\r\n\r\n        <div class=\"container my-5\" style=\"font-family: DM Sans;\">\r\n            <div class=\"row pt-3\">\r\n                <div class=\"col-12\">\r\n                    <h1 style=\"font-size: 40px; line-height: 50px; font-weight: 600;\">The project</h1>\r\n                    <p class=\"pr-5\" style=\"font-size: 20px; line-height: 30px; font-weight: 300;\">\r\n                        This app is a matching algorithm animator proposed by Sofiat Olaosebikan, my supervisor for this project, and developed as part of my final year individual project over the course of 6 months.\r\n                        The idea of this app was to create a slick, easy to use learning tool for matching algorithms - that is, algorithms that involve the stable matching of 2 groups through various criteria.\r\n                        <br><br>\r\n                        Although this project is not as polished or feature-rich as I would like it to be, due to time and other constraints, I hope you like it and are also able to give me some feedback on what I could improve!\r\n                        <br><br>\r\n                        This app is created for <b>desktop</b> use - so will look the best on larger screens - I currently have no plans to optimise it for mobile devices so elements may not appear properly on smaller screens/windows.\r\n                        <br><br>\r\n                        To get started or learn more, head over to the Algorithms page where you can select an algorithm to run in different scenarios. Currently there are 3 options, and due to time constraints,\r\n                        I have no plans to add more.\r\n                    </p>\r\n                </div>\r\n            </div>\r\n\r\n            <div class=\"\" style=\"height: 150px\"></div>\r\n\r\n            <div class=\"row pb-5\">\r\n                <div class=\"col-lg-6 col-sm-12 my-auto\" id=\"homePageRow3Text\">\r\n                    <h1 style=\"font-size: 40px; line-height: 50px; font-weight: 600;\">More about me</h1>\r\n                    <p style=\"font-size: 20px; line-height: 30px; font-weight: 300;\">\r\n                        I'm Liam! A 4th year Computer Scientist at the University of Glasgow. When I'm not developing, I'm usually playing games, piano or learning whatever I can!\r\n                        <br><br>\r\n                        If you want to know more about me, head down to the bottom of the page and check out my social links!\r\n                    </p>\r\n                </div>\r\n                <div class=\"col-lg-6 col-sm-12 pl-5\">\r\n                    <div style=\"width: 300px; height: 300px; overflow: hidden; border-radius: 50%; border: 3px solid rgb(180, 180, 180);\" class=\"mx-auto\">\r\n                        <img src=\"assets/images/liam.jpg\" id=\"homePageRow3Content\" style=\"margin: 0 auto; margin-left: -8.2%; margin-top: -14%;height: 140%; width: auto;\" alt=\"me\">\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <div class=\"\" style=\"height: 150px\"></div>\r\n\r\n            <div class=\"row pb-5\">\r\n                <div class=\"col-12\">\r\n                    <h1 style=\"font-size: 40px; line-height: 50px; font-weight: 600;\">Help and special mentions</h1>\r\n                    <p class=\"pr-5\" style=\"font-size: 20px; line-height: 30px; font-weight: 300;\">\r\n                        A big thank you to Sofiat Olaosebikan for helping me throughout the process and looking out for me to make sure on track, even in such a hectic year.\r\n                        <br><br>\r\n                        Also, thank you to Sarah, my partner, for your constant support and helping me out of my lowest lows.\r\n                    </p>\r\n                </div>\r\n            </div>\r\n\r\n        </div>\r\n    </div>\r\n</div>","<div class=\"card px-1\">\r\n    <div class=\"card-body\">\r\n        <div class=\"row mt-2\">\r\n            <div class=\"col-7\">\r\n                <h1 class=\"card-title\" style=\"font-size: 30px; font-weight: 400;\">{{ algorithm.name }}</h1>\r\n            </div>\r\n            <div class=\"col-5 mt-2 pr-4 text-right\">\r\n                <h6 class=\"card-subtitle text-muted\" style=\"font-size: 20px; font-weight: 400\">{{ algorithm.orientation[0] }}-Oriented</h6>\r\n            </div>\r\n        </div>\r\n        \r\n        <h5 class=\"card-subtitle mb-4 text-muted\" style=\"font-size: 22px; font-weight: 400\">{{ algorithm.algorithm }}</h5>\r\n\r\n        <div class=\"mt-3\" style=\"height: 150px; overflow:scroll\">\r\n            <p class=\"card-text\" style=\"font-size: 18px; line-height: 25px; font-weight: 400;\" [innerHTML]=\"algorithm.description\"></p>\r\n        </div>\r\n\r\n        <div class=\"divider mt-3\"></div>\r\n\r\n        <div class=\"row mt-4\">\r\n\r\n            <div class=\"col-7\">\r\n                <form class=\"example-form pl-3\">\r\n                    <div class=\"row justify-content-start\" *ngIf=\"algorithm.name == 'Stable Marriage Problem'\">\r\n                      <mat-form-field style=\"width: 200px;\">\r\n                        <mat-label>Number of Men and Women</mat-label>\r\n                        <input id={{algorithm.id}} [formControl]=\"numberOfGroup1Agents\" (keyup.enter)=\"(numberOfGroup1Agents.hasError('required') || numberOfGroup1Agents.hasError('max') || numberOfGroup1Agents.hasError('min')) ? '' : this.onGeneratePreferences()\" type=\"number\" matInput placeholder=\"5\" value=\"5\" min=\"1\" max=\"9\" onkeydown=\"if(event.key==='.'){event.preventDefault();}\" oninput=\"this.value = this.value > 0 && this.value < 10 ? (!!this.value && Math.abs(this.value) >= 0 ? Math.abs(this.value) : null) : Number(String(this.value).charAt(1))\" onDrag=\"return false\" onDrop=\"return false\" onPaste=\"return false\">\r\n                        <mat-error *ngIf=\"numberOfGroup1Agents.hasError('required')\">\r\n                          This field is <strong>required</strong>\r\n                        </mat-error>\r\n                        <mat-error *ngIf=\"numberOfGroup1Agents.hasError('min') || numberOfGroup1Agents.hasError('max')\">\r\n                          Please input a number between 1 and 9\r\n                        </mat-error>\r\n                      </mat-form-field>\r\n                    </div>\r\n                \r\n                    <div class=\"row justify-content-center\" *ngIf=\"algorithm.name == 'Hospitals/Residents Problem'\">\r\n                      <mat-form-field style=\"width: 200px;\" class=\"mr-1\">\r\n                        <mat-label>Number of Residents</mat-label>\r\n                        <input id=\"hr1\" [formControl]=\"numberOfGroup1Agents\" (keyup.enter)=\"numberOfGroup1Agents.hasError('required') || numberOfGroup1Agents.hasError('max') || numberOfGroup1Agents.hasError('min') || numberOfGroup2Agents.hasError('required') || numberOfGroup2Agents.hasError('max') || numberOfGroup2Agents.hasError('min') ? '' :  this.onGeneratePreferences()\" type=\"number\" matInput placeholder=\"5\" value=\"5\" min=\"2\" max=\"9\" oninput=\"this.value = this.value > 1 && this.value < 10 ? (!!this.value && Math.abs(this.value) >= 0 ? Math.abs(this.value) : null) : Number(String(this.value).charAt(1))\" onDrag=\"return false\" onDrop=\"return false\" onPaste=\"return false\">\r\n                        <mat-error *ngIf=\"numberOfGroup1Agents.hasError('required')\">\r\n                          This field is <strong>required</strong>\r\n                        </mat-error>\r\n                        <mat-error *ngIf=\"numberOfGroup1Agents.hasError('min') || numberOfGroup1Agents.hasError('max')\">\r\n                          Please input a number between 1 and 9\r\n                        </mat-error>\r\n                      </mat-form-field>\r\n                \r\n                      <mat-form-field style=\"width: 200px;\" class=\"ml-1\">\r\n                        <mat-label>Number of Hospitals</mat-label>\r\n                        <input id=\"hr2\" [formControl]=\"numberOfGroup2Agents\" (keyup.enter)=\"numberOfGroup1Agents.hasError('required') || numberOfGroup1Agents.hasError('max') || numberOfGroup1Agents.hasError('min') || numberOfGroup2Agents.hasError('required') || numberOfGroup2Agents.hasError('max') || numberOfGroup2Agents.hasError('min') ? '' :  this.onGeneratePreferences()\" type=\"number\" matInput placeholder=\"5\" value=\"5\" min=\"2\" max=\"9\" oninput=\"this.value = this.value > 1 && this.value < 10 ? (!!this.value && Math.abs(this.value) >= 0 ? Math.abs(this.value) : null) : Number(String(this.value).charAt(1))\" onDrag=\"return false\" onDrop=\"return false\" onPaste=\"return false\">\r\n                        <mat-error *ngIf=\"numberOfGroup2Agents.hasError('required')\">\r\n                          This field is <strong>required</strong>\r\n                        </mat-error>\r\n                        <mat-error *ngIf=\"numberOfGroup2Agents.hasError('min') || numberOfGroup2Agents.hasError('max')\">\r\n                          Please input a number between 1 and 9\r\n                        </mat-error>\r\n                      </mat-form-field>\r\n                    </div>\r\n\r\n                    <!-- Roommates -->\r\n                    <div class=\"row justify-content-start\" *ngIf=\"algorithm.name == 'Stable Roommates Problem'\">\r\n                      <mat-form-field style=\"width: 200px;\">\r\n                        <mat-label>Number of People</mat-label>\r\n                        <input id={{algorithm.id}} [formControl]=\"numberOfGroup1Agents\" (keypress)=\"evenOnly($event)\" (keyup.enter)=\"((numberOfGroup1Agents.hasError('required') || numberOfGroup1Agents.hasError('max') || numberOfGroup1Agents.hasError('min')) ? '' : this.onGeneratePreferences())\" type=\"number\" matInput placeholder=\"5\" value=\"5\" min=\"1\" max=\"10\" onkeydown=\"if(event.key==='.'){event.preventDefault();}\" oninput=\"this.value = this.value > 0 && this.value < 10 ? (!!this.value && Math.abs(this.value) >= 0 ? Math.abs(this.value) : null) : Number(String(this.value).charAt(1))\" onDrag=\"return false\" onDrop=\"return false\" onPaste=\"return false\">\r\n                        <mat-error *ngIf=\"numberOfGroup1Agents.hasError('required')\">\r\n                          This field is <strong>required</strong>\r\n                        </mat-error>\r\n                        <mat-error *ngIf=\"numberOfGroup1Agents.hasError('min') || numberOfGroup1Agents.hasError('max')\">\r\n                          Please input a even number between 1 and 8\r\n                        </mat-error>\r\n                      </mat-form-field>\r\n                    </div>\r\n                \r\n                  </form>\r\n            </div>\r\n\r\n            <div class=\"col-5 text-right\">\r\n                <button class=\"cardButton\" mat-stroked-button style=\"border-radius: 70px; width: 220px; height: 45px;\" *ngIf=\"algorithm.name == 'Stable Marriage Problem' && !(numberOfGroup1Agents.hasError('required') || numberOfGroup1Agents.hasError('max') || numberOfGroup1Agents.hasError('min'))\" cdkFocusInitial [disabled]=\"numberOfGroup1Agents.hasError('required') || numberOfGroup1Agents.hasError('max') || numberOfGroup1Agents.hasError('min')\" (click)=\"this.onGeneratePreferences()\"><span style=\"font-size: 18px; font-weight: 500; color: black;\">Generate Preferences</span></button>\r\n                <button class=\"cardButton\" mat-stroked-button style=\"border-radius: 70px; width: 220px; height: 45px;\" *ngIf=\"algorithm.name == 'Hospitals/Residents Problem' && !(numberOfGroup1Agents.hasError('required') || numberOfGroup1Agents.hasError('max') || numberOfGroup1Agents.hasError('min') || numberOfGroup2Agents.hasError('required') || numberOfGroup2Agents.hasError('max') || numberOfGroup2Agents.hasError('min'))\" cdkFocusInitial [disabled]=\"numberOfGroup1Agents.hasError('required') || numberOfGroup1Agents.hasError('max') || numberOfGroup1Agents.hasError('min') || numberOfGroup2Agents.hasError('required') || numberOfGroup2Agents.hasError('max') || numberOfGroup2Agents.hasError('min')\" (click)=\"this.onGeneratePreferences()\"><span style=\"font-size: 18px; font-weight: 500; color: black;\">Generate Preferences</span></button>\r\n                <button class=\"cardButton\" mat-stroked-button style=\"border-radius: 70px; width: 220px; height: 45px;\" *ngIf=\"algorithm.name == 'Stable Roommates Problem' && !(numberOfGroup1Agents.hasError('required') || numberOfGroup1Agents.hasError('max') || numberOfGroup1Agents.hasError('min'))\" cdkFocusInitial [disabled]=\"numberOfGroup1Agents.hasError('required') || numberOfGroup1Agents.hasError('max') || numberOfGroup1Agents.hasError('min')\" (click)=\"this.onGeneratePreferences()\"><span style=\"font-size: 18px; font-weight: 500; color: black;\">Generate Preferences</span></button>\r\n\r\n              </div>\r\n        </div>\r\n        \r\n    </div>\r\n</div>","import { Component, Input, OnInit } from '@angular/core';\r\nimport { FormControl, FormGroupDirective, NgForm, Validators } from '@angular/forms';\r\nimport { ErrorStateMatcher } from '@angular/material/core';\r\nimport { Router } from '@angular/router';\r\nimport { AlgorithmRetrievalService } from 'src/app/algorithm-retrieval.service';\r\nimport { Algorithm } from '../../../Algorithm';\r\n\r\ndeclare var anime: any;\r\n\r\n/** Error when invalid control is dirty, touched, or submitted. */\r\nexport class MyErrorStateMatcher implements ErrorStateMatcher {\r\n  isErrorState(control: FormControl | null, form: FormGroupDirective | NgForm | null): boolean {\r\n    const isSubmitted = form && form.submitted;\r\n    return !!(control && control.invalid && (control.dirty || control.touched || isSubmitted));\r\n  }\r\n}\r\n\r\n\r\n@Component({\r\n  selector: 'algorithm-card',\r\n  templateUrl: './algorithm-card.component.html',\r\n  styleUrls: ['./algorithm-card.component.scss', '../../home-page.component.scss', '../../home-content/home-content.component.scss']\r\n})\r\nexport class AlgorithmCardComponent implements OnInit {\r\n\r\n  @Input() algorithm: Algorithm;\r\n\r\n\r\n  numberOfGroup1Agents = new FormControl('', [\r\n    Validators.required,\r\n    Validators.min(1),\r\n    Validators.max(9),\r\n    Validators.pattern(\"[2|4|6|8|10]\")\r\n  ]);\r\n\r\n  numberOfGroup2Agents = new FormControl('', [\r\n    Validators.required,\r\n    Validators.min(1),\r\n    Validators.max(9)\r\n  ]);\r\n\r\n  evenOnly(event): boolean {\r\n\r\n    if (event.key == \"enter\"){\r\n      return true\r\n    }\r\n  \r\n    if ([\"2\", \"4\", \"6\", \"8\", \"1\", \"0\"].includes(event.key)) {\r\n      return true\r\n    }\r\n\r\n    return false\r\n  }\r\n\r\n  // matcher = new MyErrorStateMatcher();\r\n\r\n  constructor(public algorithmService: AlgorithmRetrievalService, public router: Router) { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n\r\n  // on clicking \"Generate Preferences\" change the global algorithm to the one passed into this dialog\r\n  async onGeneratePreferences(): Promise<void> {\r\n    this.algorithmService.currentAlgorithm = this.algorithm;\r\n    this.algorithmService.numberOfGroup1Agents = this.numberOfGroup1Agents.value;\r\n    if (this.numberOfGroup2Agents.value == '') {\r\n      this.algorithmService.numberOfGroup2Agents = this.numberOfGroup1Agents.value;\r\n    } else {\r\n      this.algorithmService.numberOfGroup2Agents = this.numberOfGroup2Agents.value;\r\n    }\r\n\r\n\r\n    anime({\r\n      targets: '.main-page',\r\n      easing: 'easeOutQuint',\r\n      opacity: [1, 0],\r\n      duration: 500\r\n    })\r\n\r\n    anime({\r\n      targets: '.navbar',\r\n      easing: 'easeOutQuint',\r\n      translateY: [0, -150],\r\n      opacity: [1, 0],\r\n      delay: 300,\r\n      duration: 500\r\n    })\r\n\r\n    await this.delay(700);\r\n\r\n    this.router.navigateByUrl(\"/animation\", { skipLocationChange: true });\r\n  }\r\n\r\n\r\n  delay(ms: number) {\r\n    return new Promise( resolve => setTimeout(resolve, ms) );\r\n  }\r\n\r\n}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { AlgorithmRetrievalService } from 'src/app/algorithm-retrieval.service';\r\nimport { simpleFadeAnimation } from 'src/app/animations/fadeAnimation';\r\n\r\n@Component({\r\n  selector: 'app-algorithm-content',\r\n  templateUrl: './algorithm-content.component.html',\r\n  styleUrls: ['./algorithm-content.component.scss', '../home-page.component.scss', '../home-content/home-content.component.scss'],\r\n  animations: [\r\n    simpleFadeAnimation\r\n  ]\r\n})\r\nexport class AlgorithmContentComponent implements OnInit {\r\n\r\n  constructor(public algorithmRetrieval: AlgorithmRetrievalService) { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n}\r\n","<div [@simpleFadeAnimation]=\"'in'\" class=\"algorithmContent\">\r\n    <div class=\"container text-center py-5 my-5\">\r\n        <h1 class=\"title-text\">Learn a matching algorithm!</h1>\r\n\r\n        <div class=\"row pt-3 justify-content-center\">\r\n            <div class=\"col-9 pr-5 text-center\">\r\n                <p class=\"lead\" style=\"font-size: 1.6rem; line-height: 2.5rem; font-family: 'DM Sans'\">Using this app you can pick a problem (currently either Stable Marriage or Hospital/Residents) and see how the Gale-Shapley and Extended Gale-Shapley algorithms are used in those scenarios.</p>\r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n\r\n    <div class=\"py-5\" style=\"background-color: #f6f6f8\">\r\n        <div class=\"container-fluid mt-3 mb-5\">\r\n\r\n            <div class=\"text-center\">\r\n                <h1 class=\"title-text\" style=\"color: #464d57;\">Problems</h1>\r\n            </div>\r\n            \r\n\r\n            <div class=\"row justify-content-center mb-4\">\r\n                <div class=\"col-6 text-center\">\r\n                    <p class=\"\" style=\"font-size: 1.2rem; line-height: 2rem; font-family: 'DM Sans';\">If it's your first time using this app, <b>try the algorithm on the left with 5 men and women</b>, then click on the question mark on the top right when the algorithm loads to get a short walkthrough of the functions of the app.</p>\r\n                </div>\r\n            </div>\r\n\r\n            <div class=\"row my-5 mx-5 justify-content-center\">\r\n                <div class=\"col-xl-6 col-sm-12 mb-5\" *ngFor=\"let algorithm of algorithmRetrieval.getListOfAlgorithms()\">\r\n                  <algorithm-card [algorithm]=algorithm></algorithm-card>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n</div>","import { Component, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'feedback-banner',\r\n  templateUrl: './feedback-banner.component.html',\r\n  styleUrls: ['./feedback-banner.component.scss']\r\n})\r\nexport class FeedbackBannerComponent implements OnInit {\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n}\r\n","<div class=\"py-5\" id=\"feedbackBanner\" style=\"background-color: #1b1f23\">\r\n\r\n    <div class=\"text-center pt-2 px-5\">\r\n        <h2 class=\"mb-4\" style=\"color: white; font-weight: 400;\">\r\n            If you have any feedback for me, or anything you'd like to see in this app, click the button below to be navigated to the feedback page, or contact me at one of my socials!\r\n        </h2>\r\n\r\n        <h2 class=\"mb-5\" style=\"color: white; font-weight: 400;\">\r\n            I'm currently actively working on the app, however as it is part of my final year university project, I will eventually stop.\r\n        </h2>\r\n\r\n        <button class=\"feedbackButton\" mat-flat-button style=\"border-radius: 70px; width: 170px; height: 45px;\" routerLink=\"/feedback\"><span style=\"font-size: 18px; font-weight: 500; color: black; outline: none\">Give Feedback!</span></button>\r\n\r\n    </div>\r\n</div>","import { Component, OnInit } from '@angular/core';\r\nimport { simpleFadeAnimation } from 'src/app/animations/fadeAnimation';\r\n\r\n@Component({\r\n  selector: 'app-feedback-content',\r\n  templateUrl: './feedback-content.component.html',\r\n  styleUrls: ['./feedback-content.component.scss', '../home-page.component.scss', '../home-content/home-content.component.scss'],\r\n  animations: [\r\n    simpleFadeAnimation\r\n  ]\r\n})\r\nexport class FeedbackContentComponent implements OnInit {\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n}\r\n","<div [@simpleFadeAnimation]=\"'in'\" class=\"feedbackContent\">\r\n    <div class=\"container text-center py-5 my-5 col-sm-11 col-lg-8 col-xl-6\">\r\n        <h1 class=\"title-text\">I would greatly appreciate any feedback!<br><div class=\"divider my-4\"></div><span style=\"color: #464d57;\">I am collecting feedback to improve this app through Google Forms! Check below for details!</span></h1>\r\n    </div>\r\n\r\n    <div class=\"py-5\" style=\"background-color: #f6f6f8\">\r\n\r\n        <div class=\"container my-5\" style=\"font-family: DM Sans;\">\r\n            <div class=\"row pt-3\">\r\n                <div class=\"col-12\">\r\n                    <h1 style=\"font-size: 40px; line-height: 50px; font-weight: 600;\">Evaluation</h1>\r\n                    <p style=\"font-size: 20px; line-height: 30px; font-weight: 300;\">If you'd like to help me out, I'd really appreciate you spending the time to go through and do my evaluation of this app. It's at this Google Forms link.</p>\r\n                    <p style=\"font-size: 20px; line-height: 30px; font-weight: 300;\">If there's anything you'd like to mention that my evaluation doesn't cover, please contact me at 2314991L@student.gla.ac.uk. I'd love to hear any and all opinions!</p>\r\n                </div>\r\n            </div>\r\n\r\n            <div class=\"\" style=\"height: 150px\"></div>\r\n\r\n            <div class=\"row pt-3\">\r\n                <div class=\"col-12\">\r\n                    <h1 style=\"font-size: 40px; line-height: 50px; font-weight: 600;\">Future Work</h1>\r\n                    <p style=\"font-size: 20px; line-height: 30px; font-weight: 300;\">As this is a university project, there's a limit on what I can feasibly do in the time given, especially alongside the rest of my studies. However, below is a list of features, fixes and improvements I would love to make, if I had the time:</p>\r\n                    <ul style=\"font-size: 18px; line-height: 30px; font-weight: 300;\">\r\n                        <li>Implementation of more algorithms</li>\r\n                        <li>Functionality to edit number of available spaces for hospitals through edit preferences</li>\r\n                        <li>A more robust, user friendly implementation of the edit preferences system</li>\r\n                        <li>A more in-depth, high quality tutorial</li>\r\n                        <li>Screen responsiveness (app responding properly to different screen sizes)</li>\r\n                        <li>Mobile version of the web app</li>\r\n                        <li>More polish - ensuring no bugs and other oddities with presentation</li>\r\n                        <li>User friendly system to create their own algorithms - possibly \"writing code\" or combining blocks of logic to create matching algorithms?</li>\r\n                    </ul>\r\n                    <p style=\"font-size: 20px; line-height: 30px; font-weight: 300;\">If there's anything you think would be a great addition to this app, please go through my evaluation and add your thoughts!</p>\r\n                </div>\r\n            </div>\r\n\r\n        </div>\r\n    </div>\r\n\r\n</div>\r\n","import { Component, ElementRef, OnInit, ViewChild } from '@angular/core';\r\nimport { simpleFadeAnimation } from 'src/app/animations/fadeAnimation';\r\n\r\ndeclare var anime: any;\r\n\r\n@Component({\r\n  selector: 'home-content',\r\n  templateUrl: './home-content.component.html',\r\n  styleUrls: ['./home-content.component.scss', '../home-page.component.scss'],\r\n  animations: [\r\n    simpleFadeAnimation\r\n  ]\r\n})\r\nexport class HomeContentComponent implements OnInit {\r\n\r\n  @ViewChild('animationVid') animationVid: ElementRef;\r\n  @ViewChild('descriptionVid') descriptionVid: ElementRef;\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    let vid: HTMLVideoElement = this.animationVid.nativeElement;\r\n    vid.muted = true;\r\n    vid.play();\r\n\r\n    vid = this.descriptionVid.nativeElement;\r\n    vid.muted = true;\r\n    vid.play();\r\n  }\r\n\r\n  delay(ms: number) {\r\n    return new Promise( resolve => setTimeout(resolve, ms) );\r\n  }\r\n\r\n}\r\n","<div [@simpleFadeAnimation]=\"'in'\" class=\"homeContent\">\r\n\r\n    <div class=\"titleContent\">\r\n        <div class=\"container text-center pt-5 col-sm-11 col-lg-8 col-xl-5\">\r\n            <h1 class=\"title-text\">Learn, visualise and walk through matching algorithms at your own pace.</h1>\r\n        </div>\r\n    \r\n        <div class=\"container pb-5 mb-5 text-center\">\r\n            <video #animationVid class=\"video\" id=\"animationVideo\" autoplay muted loop src=\"assets/animations/algAnimation.mp4\" type=\"video/mp4\"></video>\r\n            <!-- <button mat-flat-button color=\"accent\" style=\"border-radius: 70px; width: 300px; height: 90px\"><span style=\"font-size: 36px; font-weight: 500\">Get Started</span></button> -->\r\n        </div>\r\n    </div>\r\n\r\n\r\n\r\n    <div class=\"py-5\" style=\"background-color: #f6f6f8; font-family: DM Sans;\">\r\n\r\n        <!-- <div class=\"titleContent mt-2 pb-5 mb-5 text-center\">\r\n            <button class=\"startButton\" mat-flat-button color=\"accent\" style=\"border-radius: 70px; width: 350px; height: 90px\"><span style=\"font-size: 36px; font-weight: 500; color: rgb(243, 243, 243);\">Get Started</span></button>\r\n        </div> -->\r\n\r\n        <div class=\"container my-5\">\r\n            <div class=\"row pt-5\">\r\n                <div class=\"col-lg-6 col-sm-12 my-auto text-right pr-5\" id=\"homePageRow1Text\">\r\n                    <h1 style=\"font-size: 40px; line-height: 50px; font-weight: 600;\">Perfect for beginners</h1>\r\n                    <p style=\"font-size: 20px; line-height: 30px; font-weight: 300;\">With a simple, intuitive interface, learn how the Gale-Shapley and Extended Gale-Shapley matching algorithms work in different problems with step-by-step playback.</p>\r\n                </div>\r\n                <div class=\"col-lg-6 col-sm-12 mx-auto text-center\">\r\n                    <video #descriptionVid id=\"homePageRow1Content\" class=\"video\" id=\"descriptionVideo\" autoplay muted loop src=\"assets/animations/descriptions.mp4\" type=\"video/mp4\" width=80% style=\"border: 1px solid rgb(180, 180, 180); height: auto; border-radius: 30px;\"></video>\r\n                </div>\r\n            </div>\r\n\r\n            <div class=\"\" style=\"height: 150px\"></div>\r\n\r\n            <div class=\"row mt-5\">\r\n                <div class=\"col-lg-6 col-sm-12 mt-5 my-auto\">\r\n                    <div style=\"width: 300px; height: 300px; overflow: hidden; border-radius: 50%; background: white; border: 1px solid rgb(180, 180, 180);\" class=\"mx-auto\">\r\n                        <img src=\"assets/images/codeDisplayWhite.PNG\" style=\"margin: 0 auto; margin-left: 5%; margin-top: 5%;height: 100%; width: auto;\" id=\"homePageRow2Content\">\r\n                    </div>\r\n                </div>\r\n                <!-- <div class=\"col-sm-none\"></div> -->\r\n                <div class=\"col-lg-6 col-sm-12 my-auto pl-5\" id=\"homePageRow2Text\">\r\n                    <h1 style=\"font-size: 40px; line-height: 50px; font-weight: 600;\">Learn visually</h1>\r\n                    <p style=\"font-size: 20px; line-height: 30px; font-weight: 300;\">Decide to play each algorithm with pseudocode shown or not in conjunction with a visual representation of matching.</p>\r\n                </div>\r\n            </div>\r\n\r\n            <div class=\"\" style=\"height: 150px\"></div>\r\n\r\n            <div class=\"row pb-5\">\r\n                <div class=\"col-lg-6 col-sm-12 my-auto text-right pr-5\" id=\"homePageRow3Text\">\r\n                    <h1 style=\"font-size: 40px; line-height: 50px; font-weight: 600;\">Control your learning</h1>\r\n                    <p style=\"font-size: 20px; line-height: 30px; font-weight: 300;\">Use the playback controls for each algorithm to control the speed you learn.</p>\r\n                </div>\r\n                <div class=\"col-lg-6 col-sm-12 pl-5\">\r\n                    <div style=\"width: 300px; height: 300px; overflow: hidden; border-radius: 50%; background: white; border: 1px solid rgb(180, 180, 180);\" class=\"mx-auto\">\r\n                        <img src=\"assets/images/playbackControlUnchanged.PNG\" id=\"homePageRow3Content\" style=\"margin: 0 auto; margin-left: -15.2%; margin-top: 17%;height: 60%; width: auto;\">\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n        </div>\r\n    </div>\r\n\r\n</div>","<navbar></navbar>\r\n\r\n<div class=\"main-page\">\r\n    <router-outlet #outlet=\"outlet\"></router-outlet>\r\n\r\n    <feedback-banner *ngIf=\"!(router.url === '/feedback')\"></feedback-banner>\r\n\r\n    <icon-banner></icon-banner>\r\n</div>","import { animate, state, style, transition, trigger } from '@angular/animations';\r\nimport { Component, ElementRef, OnInit, ViewChild } from '@angular/core';\r\nimport { Router, RouterOutlet } from '@angular/router';\r\n\r\ndeclare var anime: any;\r\n\r\n@Component({\r\n  selector: 'app-home-page',\r\n  templateUrl: './home-page.component.html',\r\n  styleUrls: ['./home-page.component.scss'],\r\n})\r\nexport class HomePageComponent implements OnInit {\r\n\r\n  \r\n\r\n  constructor(public router: Router) { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n  async ngAfterViewInit(): Promise<void> {\r\n\r\n    anime({\r\n      targets: '.navbar',\r\n      easing: 'easeInOutQuint',\r\n      translateY: [-150, 0],\r\n      opacity: [0, 1],\r\n      delay: 100,\r\n      duration: 1000\r\n    })\r\n\r\n    anime({\r\n      targets: '.main-page',\r\n      easing: 'easeInOutQuint',\r\n      opacity: [0, 1],\r\n      // translateY: [-100, 0],\r\n      delay: 550,\r\n      duration: 900\r\n    })\r\n\r\n\r\n  }\r\n\r\n\r\n}\r\n","import { Component, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'icon-banner',\r\n  templateUrl: './icon-banner.component.html',\r\n  styleUrls: ['./icon-banner.component.scss']\r\n})\r\nexport class IconBannerComponent implements OnInit {\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n}\r\n","<div class=\"py-5 text-center\">\r\n    <a style=\"margin: 0 1em;\" href=\"https://github.com/liamlau/individual-project\" target=\"#blank\">\r\n        <svg height=\"50px\" id=\"github-icon\" aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fab\" data-icon=\"github\" class=\"svg-inline--fa fa-github fa-w-16 fa-2x \" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 496 512\"><path class=\"github-icon\" fill=\"currentColor\" d=\"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z\"></path></svg>\r\n    </a>\r\n    <!-- <a style=\"margin: 0 1em;\" href=\"https://www.facebook.com/liam.lau3/\" target=\"#blank\">\r\n        <svg height=\"50px\" id=\"facebook-icon\" aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fab\" data-icon=\"facebook\" class=\"svg-inline--fa fa-facebook fa-w-16 fa-2x \" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path class=\"facebook-icon\" fill=\"currentColor\" d=\"M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z\"></path></svg>\r\n    </a> -->\r\n    <a style=\"margin: 0 1em;\" href=\"https://www.linkedin.com/in/liam-lau-01b2b31b0/\" target=\"#blank\">\r\n        <svg height=\"50px\" id=\"linkedin-icon\" aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fab\" data-icon=\"linkedin\" class=\"svg-inline--fa fa-linkedin fa-w-14 fa-2x \" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\"><path class=\"linkedin-icon\" fill=\"currentColor\" d=\"M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z\"></path></svg>\r\n    </a>\r\n</div>","import { Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\n\r\ndeclare var anime: any;\r\n\r\n@Component({\r\n  selector: 'navbar',\r\n  templateUrl: './navbar.component.html',\r\n  styleUrls: ['./navbar.component.scss']\r\n})\r\nexport class NavbarComponent implements OnInit {\r\n\r\n  componentMap: Object = {\r\n    \"/\": \".homeContent\",\r\n    \"/about\": \".aboutContent\",\r\n    \"/algorithms\": \".algorithmContent\",\r\n    \"/feedback\": \".feedbackContent\"\r\n  };\r\n\r\n  constructor(public router: Router) { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n  fadeCurrentPage(): void {\r\n    anime({\r\n      targets: [this.componentMap[this.router.url]],\r\n      easing: 'easeInOutQuint',\r\n      opacity: [1, 0],\r\n      duration: 400\r\n    })\r\n  }\r\n\r\n  async goToPage(page: string): Promise<void> {\r\n    if (!(this.router.url == page)) {\r\n      this.fadeCurrentPage();\r\n      await this.delay(400);\r\n      this.router.navigateByUrl(page, { skipLocationChange: true });\r\n    }\r\n  }\r\n\r\n  delay(ms: number) {\r\n    return new Promise( resolve => setTimeout(resolve, ms) );\r\n  }\r\n\r\n}\r\n","<nav class=\"navbar sticky-top navbar-expand-lg navbar-light\" style=\"background-color: white; font-family: 'DM Sans'\">\r\n    <a class=\"navbar-brand pl-5 mt-5 mb-4\" style=\"cursor: pointer;\" (click)=\"this.goToPage('/')\"><span class=\"display-1\" style=\"font-size: 40px;\"><span id=\"alg\">alg</span><span id=\"match\">match</span></span></a>\r\n    <button class=\"navbar-toggler mt-4 mr-5\" type=\"button\" data-toggle=\"collapse\" data-target=\"#navbarNavAltMarkup\" aria-controls=\"navbarNavAltMarkup\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\r\n        <span class=\"navbar-toggler-icon\"></span>\r\n    </button>\r\n    <div class=\"collapse navbar-collapse ml-5\" id=\"navbarNavAltMarkup\">\r\n        <div class=\"navbar-nav ml-auto pt-5 pb-3 pr-5\">\r\n        <a class=\"nav-item nav-link mr-5\" id=\"homeLink\" style=\"font-size: 23px; font-weight: 600; cursor: pointer\" (click)=\"this.goToPage('/')\" [ngClass]=\"{'active' : !['/about', '/algorithms', '/feedback'].includes(this.router.url)}\">Home</a>\r\n        <a class=\"nav-item nav-link mr-5\" id=\"aboutLink\" style=\"font-size: 23px; font-weight: 600; cursor: pointer\" (click)=\"this.goToPage('/about')\" [ngClass]=\"{'active' : this.router.url == '/about'}\">About</a>\r\n        <a class=\"nav-item nav-link mr-4 pr-3\" id=\"algorithmsLink\" style=\"font-size: 23px; font-weight: 600; cursor: pointer\" (click)=\"this.goToPage('/algorithms')\" [ngClass]=\"{'active' : this.router.url == '/algorithms'}\">Algorithms</a>\r\n        <a class=\"nav-item nav-link mr-4\" id=\"feedbackLink\" style=\"font-size: 23px; font-weight: 600; cursor: pointer\" (click)=\"this.goToPage('/feedback')\" [ngClass]=\"{'active' : this.router.url == '/feedback'}\">Feedback</a>\r\n        </div>\r\n    </div>\r\n</nav>","import { Injectable } from '@angular/core';\r\nimport { CanActivate, ActivatedRouteSnapshot, RouterStateSnapshot, UrlTree, Router } from '@angular/router';\r\nimport { Observable } from 'rxjs';\r\nimport { AlgorithmRetrievalService } from '../algorithm-retrieval.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class AlgorithmGuard implements CanActivate {\r\n\r\n  constructor(public algorithmService: AlgorithmRetrievalService, private _router: Router) {}\r\n\r\n  canActivate(\r\n    next: ActivatedRouteSnapshot,\r\n    state: RouterStateSnapshot): Observable<boolean | UrlTree> | Promise<boolean | UrlTree> | boolean | UrlTree {\r\n    if (this.algorithmService.currentAlgorithm) {\r\n      return true; \r\n    }\r\n\r\n    this._router.navigate(['/']);\r\n    return false;\r\n\r\n  }\r\n  \r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\nimport { AlgorithmGuard } from './algorithm-guard';\r\nimport { AlgorithmPageComponent } from '../algorithm-page/algorithm-page.component';\r\nimport { AboutContentComponent } from '../home-page/about-content/about-content.component';\r\nimport { AlgorithmContentComponent } from '../home-page/algorithm-content/algorithm-content.component';\r\nimport { FeedbackContentComponent } from '../home-page/feedback-content/feedback-content.component';\r\nimport { HomeContentComponent } from '../home-page/home-content/home-content.component';\r\nimport { HomePageComponent } from '../home-page/home-page.component';\r\n\r\n\r\nconst routes: Routes = [\r\n  { path: '', component: HomePageComponent, children: [\r\n    {\r\n      path: '',\r\n      component: HomeContentComponent,\r\n      data: {animation: 'HomePage'}\r\n    },\r\n    {\r\n      path: 'about',\r\n      component: AboutContentComponent,\r\n      data: {animation: 'AboutPage'}\r\n    },\r\n    {\r\n      path: 'algorithms',\r\n      component: AlgorithmContentComponent\r\n    },\r\n    {\r\n      path: 'feedback',\r\n      component: FeedbackContentComponent\r\n    },\r\n  ]},\r\n  { path: 'animation', component: AlgorithmPageComponent, canActivate: [AlgorithmGuard] },\r\n  { path: '**', redirectTo: '' },  // Wildcard route\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forRoot(routes, {scrollPositionRestoration: 'enabled'})],\r\n  exports: [RouterModule]\r\n})\r\nexport class AppRoutingModule { }\r\n","import { Injectable } from '@angular/core';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class UtilsService {\r\n\r\n  constructor() { }\r\n\r\n  delay(ms: number) {\r\n    return new Promise( resolve => setTimeout(resolve, ms) );\r\n  }\r\n\r\n}\r\n","// This file can be replaced during build by using the `fileReplacements` array.\r\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\r\n// The list of file replacements can be found in `angular.json`.\r\n\r\nexport const environment = {\r\n  production: false\r\n};\r\n\r\n/*\r\n * For easier debugging in development mode, you can import the following file\r\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\r\n *\r\n * This import should be commented out in production mode because it will have a negative impact\r\n * on performance if an error is thrown.\r\n */\r\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\r\n","import { enableProdMode } from '@angular/core';\r\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\r\n\r\nimport { AppModule } from './app/app.module';\r\nimport { environment } from './environments/environment';\r\n\r\nif (environment.production) {\r\n  enableProdMode();\r\n}\r\n\r\nplatformBrowserDynamic().bootstrapModule(AppModule)\r\n  .catch(err => console.error(err));\r\n"]}